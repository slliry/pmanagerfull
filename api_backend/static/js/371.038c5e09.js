"use strict";(self["webpackChunkweb_pm"]=self["webpackChunkweb_pm"]||[]).push([[371],{2371:function(o,e,s){s.r(e),s.d(e,{default:function(){return b}});var i=s(6768),t=s(5130),a=s(4232);const l={class:"mobile-landing"},r={class:"login-section"},n={class:"login-container"},m={class:"email-input-group"},c={class:"email-domain-select"},d={key:0,class:"domain-list"},p=["onClick"],u={class:"register-prompt"};function g(o,e,s,g,h,k){const L=(0,i.g2)("CustomModal");return(0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("section",r,[(0,i.Lk)("div",n,[e[9]||(e[9]=(0,i.Lk)("h1",{class:"form-title"},"Project Manager",-1)),(0,i.Lk)("form",{onSubmit:e[4]||(e[4]=(0,t.D$)(((...o)=>k.submitLoginForm&&k.submitLoginForm(...o)),["prevent"]))},[(0,i.Lk)("div",m,[(0,i.bo)((0,i.Lk)("input",{type:"text",placeholder:"Введите email","onUpdate:modelValue":e[0]||(e[0]=o=>h.loginFormData.emailPrefix=o),required:"",class:"email-prefix"},null,512),[[t.Jo,h.loginFormData.emailPrefix]]),(0,i.Lk)("div",c,[(0,i.Lk)("div",{class:"selected-domain",onClick:e[1]||(e[1]=(...o)=>k.toggleDomainList&&k.toggleDomainList(...o))},[(0,i.eW)((0,a.v_)(h.loginFormData.selectedDomain)+" ",1),e[6]||(e[6]=(0,i.Lk)("span",{class:"arrow-down"},"▼",-1))]),h.showDomainList?((0,i.uX)(),(0,i.CE)("div",d,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(h.emailDomains,(o=>((0,i.uX)(),(0,i.CE)("div",{key:o,class:"domain-option",onClick:e=>k.selectDomain(o)},(0,a.v_)(o),9,p)))),128))])):(0,i.Q3)("",!0)])]),(0,i.bo)((0,i.Lk)("input",{type:"password",placeholder:"Пароль","onUpdate:modelValue":e[2]||(e[2]=o=>h.loginFormData.password=o),required:"",class:"form-input"},null,512),[[t.Jo,h.loginFormData.password]]),e[8]||(e[8]=(0,i.Lk)("button",{type:"submit",class:"login-button"}," Войти ",-1)),(0,i.Lk)("div",u,[e[7]||(e[7]=(0,i.Lk)("p",null,"Нет аккаунта?",-1)),(0,i.Lk)("button",{onClick:e[3]||(e[3]=o=>k.toggleModal("register")),class:"register-link"}," Зарегистрироваться ")])],32)])]),(0,i.bF)(L,{isVisible:h.showRegisterModal,onClose:e[5]||(e[5]=o=>h.showRegisterModal=!1),type:"register"},null,8,["isVisible"]),e[10]||(e[10]=(0,i.Lk)("footer",{class:"mobile-footer"},[(0,i.Lk)("div",{class:"mobile-footer-content"},[(0,i.Lk)("p",null,"Copyright © 2024 Project Manager")])],-1))])}s(4114);var h=s(4373),k=s(7798),L={name:"MobileLanding",components:{CustomModal:k.A},data(){return{showDomainList:!1,loginFormData:{emailPrefix:"",selectedDomain:"@gmail.com",password:""},emailDomains:["@gmail.com","@mail.ru","@yandex.ru","@outlook.com","@yahoo.com","@icloud.com"],errors:[],showRegisterModal:!1}},methods:{toggleDomainList(){this.showDomainList=!this.showDomainList},selectDomain(o){this.loginFormData.selectedDomain=o,this.showDomainList=!1},async submitLoginForm(){this.errors=[];const o=this.loginFormData.emailPrefix+this.loginFormData.selectedDomain;if(this.loginFormData.emailPrefix)try{const e=await h.A.post("api/accounts/login/",{email:o,password:this.loginFormData.password}),{access:s,refresh:i,profile_type:t,profile_complete:a}=e.data;s&&i&&(localStorage.setItem("accessToken",s),localStorage.setItem("refreshToken",i),localStorage.setItem("profileType",t),localStorage.setItem("profileComplete",a),!0===a?this.$router.push("/dashboard"):this.$router.push("/authentication"))}catch(e){console.error("Ошибка входа:",e),e.response?401===e.response.status?this.errors.push("Неверный email или пароль"):e.response.data?.detail&&this.errors.push(e.response.data.detail):e.request?this.errors.push("Сервер недоступен. Попробуйте позже."):this.errors.push(`Ошибка: ${e.message}`)}else this.errors.push("Введите email.")},toggleModal(o){"register"===o&&(this.showRegisterModal=!this.showRegisterModal)}}},D=s(1241);const f=(0,D.A)(L,[["render",g],["__scopeId","data-v-360a2bee"]]);var b=f}}]);
//# sourceMappingURL=371.038c5e09.js.map