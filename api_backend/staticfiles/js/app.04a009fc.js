(function(){var e={2258:function(e,t,s){s(4114);const a=s(6425),o=s(1577).A;function l(){const e=24e4;console.log(`Планирование обновления токена через ${e/1e3} секунд`),setTimeout((()=>{i(),l()}),e)}function i(){const e=localStorage.getItem("refreshToken");e?(console.log("Попытка обновления токена доступа..."),a.post("api/accounts/token/refresh/",{refresh:e}).then((e=>{const t=e.data.access;if(!t)throw new Error("Новый accessToken отсутствует в ответе");localStorage.setItem("accessToken",t),console.log("Токен доступа обновлён")})).catch((e=>{console.error("Ошибка при обновлении токена доступа:",e),r()}))):(console.error("Refresh Token отсутствует"),r())}function r(){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user_id"),o.push("/landing")}function n(){l()}e.exports={initializeTokenRefresh:n},window.refreshAccessToken=i,window.scheduleTokenRefresh=l,console.log("parseJwt:",typeof parseJwt),console.log("axios:",typeof a)},16:function(e,t,s){"use strict";var a=s(5130),o=s(657),l=s(6768);const i={id:"app"};function r(e,t,s,a,o,r){const n=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.bF)(n)])}var n={name:"App"},c=s(1241);const d=(0,c.A)(n,[["render",r]]);var u=d,p=s(4458);(0,p.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var h=s(1577),m=s(2258);(0,m.initializeTokenRefresh)();const v=(0,a.Ef)(u),k=(0,o.Ey)();v.use(k),v.use(h.A),v.mount("#app")},1577:function(e,t,s){"use strict";s.d(t,{A:function(){return fy}});var a=s(1387),o=(s(4233),s(8992),s(2577),s(6768)),l=s(4232),i=s(5130);const r={class:"page-container"},n={class:"right-content"},c={class:"form-container"},d={class:"form-content"},u={class:"section-card"},p={key:0},h={key:1},m={class:"photo-upload"},v=["src"],k={key:1,class:"upload-icon error"},g={key:2,class:"upload-icon"},f={class:"input-group"},y={key:0},L={key:0,class:"field-error"},b=["placeholder"],C={key:1},_={key:0,class:"field-error"},w=["placeholder","onUpdate:modelValue"],E={key:2},D={key:0,class:"field-error"},j=["placeholder"],S={key:3},F={key:0,class:"field-error"},X=["placeholder"],I={key:4},P={key:0,class:"field-error"},M=["placeholder"],T={key:5},A={key:0,class:"field-error"},N={key:0,class:"field-error"},x=["onClick"],U={key:1,class:"dropdown"},$=["onClick"],K={key:0,class:"document-upload"},R={class:"file-upload-container"},W={class:"file-upload-text"},Q={class:"file-upload-container"},B={class:"file-upload-text"},O={key:0,class:"section-card"},V={class:"input-group"},z={class:"input-wrapper"},q=["onClick"],J={class:"dropdown-wrapper"},G={key:0,class:"dropdown"},H=["onClick"],Y={key:0,class:"field-error"},Z={key:0,class:"dropdown"},ee=["onClick"],te={key:1,class:"section-card"},se={class:"document-upload"},ae={class:"file-upload-container"},oe={class:"file-upload-text"},le={class:"file-upload-container"},ie={class:"file-upload-text"},re={class:"file-upload-container"},ne={class:"file-upload-text"},ce={class:"file-upload-container"},de={class:"file-upload-text"},ue={class:"file-upload-container"},pe={class:"file-upload-text"},he={class:"file-upload-container"},me={class:"file-upload-text"},ve=["disabled"];function ke(e,t,s,a,ke,ge){const fe=(0,o.g2)("MobileAuthentication");return(0,o.uX)(),(0,o.CE)("div",r,[a.isMobile?((0,o.uX)(),(0,o.Wv)(fe,{key:0})):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[t[26]||(t[26]=(0,o.Lk)("div",{class:"left-panel"},[(0,o.Lk)("h1",{class:"panel-title"},"PROJECT MANAGER")],-1)),(0,o.Lk)("div",n,[(0,o.Lk)("div",c,[(0,o.Lk)("div",d,[(0,o.Lk)("div",u,[ke.isLegalEntity?((0,o.uX)(),(0,o.CE)("h2",h,"Информация о компании")):((0,o.uX)(),(0,o.CE)("h2",p,"Персональная информация")),(0,o.Lk)("div",m,[(0,o.Lk)("label",{class:(0,l.C4)(["circle",{"has-photo":ke.photoPreview,"has-error":ke.errors.photo}])},[(0,o.Lk)("input",{type:"file",class:"file-upload-input",onChange:t[0]||(t[0]=(...e)=>ge.handleFileUpload&&ge.handleFileUpload(...e)),accept:".jpg,.jpeg,.png",style:{display:"none"}},null,32),ke.photoPreview?((0,o.uX)(),(0,o.CE)("img",{key:0,src:ke.photoPreview,alt:"Preview",class:"preview-image"},null,8,v)):ke.errors.photo?((0,o.uX)(),(0,o.CE)("span",k,(0,l.v_)(ke.errors.photo),1)):((0,o.uX)(),(0,o.CE)("span",g,"Загрузите фото"))],2),t[15]||(t[15]=(0,o.Lk)("span",{class:"photo-info"},"Максимальный размер: 5 Мб, допустимые форматы: jpg, jpeg, png",-1))]),(0,o.Lk)("div",f,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(ge.formFields,((e,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s},["phone"===e.key?((0,o.uX)(),(0,o.CE)("div",y,[ke.errors.phone?((0,o.uX)(),(0,o.CE)("div",L,(0,l.v_)(ke.errors.phone),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",class:(0,l.C4)({"has-error":ke.errors.phone}),placeholder:`Введите Ваш ${e.label}`,"onUpdate:modelValue":t[1]||(t[1]=e=>ke.formData.phone=e)},null,10,b),[[i.Jo,ke.formData.phone]])])):"lastName"===e.key||"firstName"===e.key||"middleName"===e.key?((0,o.uX)(),(0,o.CE)("div",C,[ke.errors[e.key]?((0,o.uX)(),(0,o.CE)("div",_,(0,l.v_)(ke.errors[e.key]),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",class:(0,l.C4)({"has-error":ke.errors[e.key]}),placeholder:`Введите Ваше ${e.label}`,"onUpdate:modelValue":t=>ke.formData[e.key]=t},null,10,w),[[i.Jo,ke.formData[e.key]]])])):"iin"===e.key?((0,o.uX)(),(0,o.CE)("div",E,[ke.errors.iin?((0,o.uX)(),(0,o.CE)("div",D,(0,l.v_)(ke.errors.iin),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",class:(0,l.C4)({"has-error":ke.errors.iin}),placeholder:`Введите Ваш ${e.label}`,"onUpdate:modelValue":t[2]||(t[2]=e=>ke.formData.iin=e)},null,10,j),[[i.Jo,ke.formData.iin]])])):"company_name"===e.key?((0,o.uX)(),(0,o.CE)("div",S,[ke.errors.company_name?((0,o.uX)(),(0,o.CE)("div",F,(0,l.v_)(ke.errors.company_name),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",class:(0,l.C4)({"has-error":ke.errors.company_name}),placeholder:`Введите ${e.label}`,"onUpdate:modelValue":t[3]||(t[3]=e=>ke.formData.company_name=e)},null,10,X),[[i.Jo,ke.formData.company_name]])])):"bin"===e.key?((0,o.uX)(),(0,o.CE)("div",I,[ke.errors.bin?((0,o.uX)(),(0,o.CE)("div",P,(0,l.v_)(ke.errors.bin),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",class:(0,l.C4)({"has-error":ke.errors.bin}),placeholder:`Введите ${e.label}`,"onUpdate:modelValue":t[4]||(t[4]=e=>ke.formData.bin=e)},null,10,M),[[i.Jo,ke.formData.bin]])])):"legal_entity_type"===e.key?((0,o.uX)(),(0,o.CE)("div",T,[ke.errors.legal_entity_type?((0,o.uX)(),(0,o.CE)("div",A,(0,l.v_)(ke.errors.legal_entity_type),1)):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(ke.legalSelects,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:`legal-${t}`,class:"multiselect-container",style:{marginBottom:"24px"}},[ke.errors[e.key]?((0,o.uX)(),(0,o.CE)("div",N,(0,l.v_)(ke.errors[e.key]),1)):(0,o.Q3)("",!0),(0,o.Lk)("div",{class:(0,l.C4)(["selected",{valid:ke.selected[e.key]}]),onClick:e=>ge.toggleDropdown(`legal-${t}`)},(0,l.v_)(ke.selected[e.key]?e.options.find((t=>t.id===ke.selected[e.key]))?.name:e.placeholder),11,x),ke.showDropdownIndex===`legal-${t}`?((0,o.uX)(),(0,o.CE)("div",U,[(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.options,(t=>((0,o.uX)(),(0,o.CE)("li",{key:t.id,onClick:(0,i.D$)((s=>ge.selectOption(e.key,t.id)),["stop"]),class:(0,l.C4)({selected:ke.selected[e.key]===t.id})},(0,l.v_)(t.name),11,$)))),128))])])):(0,o.Q3)("",!0)])))),128))])):(0,o.Q3)("",!0)])))),128)),ke.isLegalEntity?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",K,[(0,o.Lk)("div",R,[(0,o.Lk)("label",{class:(0,l.C4)(["file-upload-label",{"has-error":ke.errors.scan_of_ID}])},[(0,o.Lk)("span",W,[(0,o.eW)((0,l.v_)(ke.errors.scan_of_ID||ke.uploadedFiles.scan_of_ID||"Загрузите скан Вашего удостоверения личности")+" ",1),t[16]||(t[16]=(0,o.Lk)("span",{class:"file-info"}," Максимальный размер: 5 Мб, допустимые форматы: jpg, jpeg, png, pdf ",-1))]),(0,o.Lk)("input",{type:"file",class:"file-upload-input",onChange:t[5]||(t[5]=e=>ge.handleDocumentUpload(e,"scan_of_ID")),accept:".jpg,.jpeg,.png,.pdf",style:{display:"none"}},null,32)],2)]),(0,o.Lk)("div",Q,[(0,o.Lk)("label",{class:(0,l.C4)(["file-upload-label",{"has-error":ke.errors.person_with_ID}])},[(0,o.Lk)("span",B,[(0,o.eW)((0,l.v_)(ke.errors.person_with_ID||ke.uploadedFiles.person_with_ID||"Загрузите Ваше фото с удостоверением личности")+" ",1),t[17]||(t[17]=(0,o.Lk)("span",{class:"file-info"}," Максимальный размер: 5 Мб, допустимые форматы: jpg, jpeg, png ",-1))]),(0,o.Lk)("input",{type:"file",class:"file-upload-input",onChange:t[6]||(t[6]=e=>ge.handleDocumentUpload(e,"person_with_ID")),accept:".jpg,.jpeg,.png",style:{display:"none"}},null,32)],2)])]))])]),ke.isLegalEntity?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",O,[t[18]||(t[18]=(0,o.Lk)("h2",null,"Профессиональная информация",-1)),(0,o.Lk)("div",V,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(ke.physicalSelects,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:"multiselect-container"},[(0,o.Lk)("div",z,[(0,o.Lk)("div",{class:(0,l.C4)(["selected",{valid:ke.selected[e.key],"has-error":ke.errors[e.key]}]),onClick:e=>ge.toggleDropdown(t)},(0,l.v_)(ke.selected[e.key]?e.options.find((t=>t.id===ke.selected[e.key]))?.name:e.placeholder),11,q),(0,o.Lk)("div",J,[ke.showDropdownIndex===t?((0,o.uX)(),(0,o.CE)("div",G,[(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.options,(t=>((0,o.uX)(),(0,o.CE)("li",{key:t.id,onClick:(0,i.D$)((()=>ge.selectOption(e.key,t.id)),["stop"]),class:(0,l.C4)({selected:ke.selected[e.key]===t.id})},(0,l.v_)(t.name),11,H)))),128))])])):(0,o.Q3)("",!0)]),ke.errors[e.key]?((0,o.uX)(),(0,o.CE)("div",Y,(0,l.v_)(ke.errors[e.key]),1)):(0,o.Q3)("",!0)])])))),128)),(0,o.Lk)("div",{class:"multiselect-container",onClick:t[7]||(t[7]=(...e)=>ge.toggleProgramDropdown&&ge.toggleProgramDropdown(...e))},[(0,o.Lk)("div",{class:(0,l.C4)(["selected",{valid:ke.selected.programs.length>0}])},(0,l.v_)(ge.selectedProgramsNames.length?ge.selectedProgramsNames:"Выберите программы, которыми Вы владеете"),3),ke.showProgramDropdown?((0,o.uX)(),(0,o.CE)("div",Z,[(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(ke.programs,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id,onClick:(0,i.D$)((t=>ge.toggleProgram(e.id)),["stop"]),class:(0,l.C4)({selected:ke.selected.programs.includes(e.id)})},(0,l.v_)(e.name),11,ee)))),128))])])):(0,o.Q3)("",!0)])])])),ke.isLegalEntity?((0,o.uX)(),(0,o.CE)("div",te,[t[25]||(t[25]=(0,o.Lk)("h2",null,"Лицензионная информация",-1)),(0,o.Lk)("div",se,[(0,o.Lk)("div",ae,[(0,o.Lk)("label",{class:(0,l.C4)(["file-upload-label",{"has-error":ke.errors.license}])},[(0,o.Lk)("span",oe,[(0,o.eW)((0,l.v_)(ke.errors.license||ke.uploadedFiles.license||"Загрузите лицензию")+" ",1),t[19]||(t[19]=(0,o.Lk)("span",{class:"file-info"}," Максимальный размер: 5 Мб, допустимый формат: pdf ",-1))]),(0,o.Lk)("input",{type:"file",class:"file-upload-input",onChange:t[8]||(t[8]=(...e)=>ge.handleLicenseUpload&&ge.handleLicenseUpload(...e)),accept:".pdf",style:{display:"none"}},null,32)],2)]),(0,o.Lk)("div",le,[(0,o.Lk)("label",{class:(0,l.C4)(["file-upload-label",{"has-error":ke.errors.accreditation}])},[(0,o.Lk)("span",ie,[(0,o.eW)((0,l.v_)(ke.errors.accreditation||ke.uploadedFiles.accreditation||"Загрузите аккредитацию")+" ",1),t[20]||(t[20]=(0,o.Lk)("span",{class:"file-info"}," Максимальный размер: 5 Мб, допустимый формат: pdf ",-1))]),(0,o.Lk)("input",{type:"file",class:"file-upload-input",onChange:t[9]||(t[9]=(...e)=>ge.handleAccreditationUpload&&ge.handleAccreditationUpload(...e)),accept:".pdf",style:{display:"none"}},null,32)],2)]),(0,o.Lk)("div",re,[(0,o.Lk)("label",{class:(0,l.C4)(["file-upload-label",{"has-error":ke.errors.project}])},[(0,o.Lk)("span",ne,[(0,o.eW)((0,l.v_)(ke.errors.project||ke.uploadedFiles.project||"Загрузите проект")+" ",1),t[21]||(t[21]=(0,o.Lk)("span",{class:"file-info"}," Максимальный размер: 5 Мб, допустимые форматы: pdf, doc, docx ",-1))]),(0,o.Lk)("input",{type:"file",class:"file-upload-input",onChange:t[10]||(t[10]=(...e)=>ge.handleProjectUpload&&ge.handleProjectUpload(...e)),accept:".pdf,.doc,.docx",style:{display:"none"}},null,32)],2)]),(0,o.Lk)("div",ce,[(0,o.Lk)("label",{class:(0,l.C4)(["file-upload-label",{"has-error":ke.errors.portfolio}])},[(0,o.Lk)("span",de,[(0,o.eW)((0,l.v_)(ke.errors.portfolio||ke.uploadedFiles.portfolio||"Загрузите портфолио работ")+" ",1),t[22]||(t[22]=(0,o.Lk)("span",{class:"file-info"}," Максимальный размер: 5 Мб, допустимые форматы: jpg, jpeg, png, pdf ",-1))]),(0,o.Lk)("input",{type:"file",class:"file-upload-input",onChange:t[11]||(t[11]=(...e)=>ge.handlePortfolioUpload&&ge.handlePortfolioUpload(...e)),accept:".jpg,.jpeg,.png,.pdf",style:{display:"none"}},null,32)],2)]),(0,o.Lk)("div",ue,[(0,o.Lk)("label",{class:(0,l.C4)(["file-upload-label",{"has-error":ke.errors.completion_acts}])},[(0,o.Lk)("span",pe,[(0,o.eW)((0,l.v_)(ke.errors.completion_acts||ke.uploadedFiles.completion_acts||"Загрузите акты выполненных работ")+" ",1),t[23]||(t[23]=(0,o.Lk)("span",{class:"file-info"}," Максимальный размер: 5 Мб, допустимый формат: pdf ",-1))]),(0,o.Lk)("input",{type:"file",class:"file-upload-input",onChange:t[12]||(t[12]=(...e)=>ge.handleActsUpload&&ge.handleActsUpload(...e)),accept:".pdf",style:{display:"none"}},null,32)],2)]),(0,o.Lk)("div",he,[(0,o.Lk)("label",{class:(0,l.C4)(["file-upload-label",{"has-error":ke.errors.expertise_confirmation}])},[(0,o.Lk)("span",me,[(0,o.eW)((0,l.v_)(ke.errors.expertise_confirmation||ke.uploadedFiles.expertise_confirmation||"Загрузите подтверждение экспертизы")+" ",1),t[24]||(t[24]=(0,o.Lk)("span",{class:"file-info"}," Максимальный размер: 5 Мб, допустимый формат: pdf ",-1))]),(0,o.Lk)("input",{type:"file",class:"file-upload-input",onChange:t[13]||(t[13]=(...e)=>ge.handleExpertiseConfirmationUpload&&ge.handleExpertiseConfirmationUpload(...e)),accept:".pdf",style:{display:"none"}},null,32)],2)])])])):(0,o.Q3)("",!0),(0,o.Lk)("button",{class:"btn",onClick:t[14]||(t[14]=(...e)=>ge.updateProfile&&ge.updateProfile(...e)),disabled:ke.isLoading},(0,l.v_)(ke.isLoading?"Загрузка...":"Зарегистрироваться"),9,ve)])])])],64))])}s(4114),s(4520),s(3949),s(1454),s(7550);var ge=s(4373),fe=s(144),ye=s.p+"img/left.e2e01def.svg",Le=s.p+"img/cross.dbbc632d.svg";const be={class:"mobile-auth"},Ce={class:"auth-form"},_e={class:"form-section"},we={class:"photo-upload"},Ee=["src"],De={key:1,class:"upload-icon error"},je={key:2,class:"upload-icon"},Se={class:"form-fields"},Fe={key:0},Xe={key:0,class:"field-error"},Ie=["placeholder"],Pe={key:1},Me={key:0,class:"field-error"},Te=["placeholder","onUpdate:modelValue"],Ae={key:2},Ne={key:0,class:"field-error"},xe=["placeholder","onUpdate:modelValue"],Ue={key:3},$e={key:0,class:"field-error"},Ke={key:0,class:"document-upload"},Re={class:"upload-item"},We={class:"upload-text"},Qe={class:"upload-item"},Be={class:"upload-text"},Oe={key:0,class:"form-section"},Ve={class:"select-fields"},ze=["onClick"],qe={class:"select-text"},Je={class:"modal-header"},Ge={class:"modal-body"},He={class:"options-list"},Ye=["onClick"],Ze={key:2,class:"form-section"},et={class:"programs-list"},tt=["onClick"],st=["disabled"];function at(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",be,[(0,o.Lk)("div",{class:"back-button",onClick:t[0]||(t[0]=(...e)=>n.goBack&&n.goBack(...e))},t[10]||(t[10]=[(0,o.Lk)("img",{src:ye,alt:"Назад"},null,-1)])),t[15]||(t[15]=(0,o.Lk)("div",{class:"auth-header"},[(0,o.Lk)("h1",null,"PROJECT MANAGER"),(0,o.Lk)("div",{class:"header-line"}),(0,o.Lk)("p",null,"Альфа-версия")],-1)),(0,o.Lk)("div",Ce,[(0,o.Lk)("div",_e,[(0,o.Lk)("h2",null,(0,l.v_)(r.isLegalEntity?"Информация о компании":"Персональная информация"),1),(0,o.Lk)("div",we,[(0,o.Lk)("label",{class:(0,l.C4)(["circle",{"has-photo":r.photoPreview,"has-error":r.errors.photo}])},[(0,o.Lk)("input",{type:"file",onChange:t[1]||(t[1]=(...e)=>n.handleFileUpload&&n.handleFileUpload(...e)),accept:".jpg,.jpeg,.png",style:{display:"none"}},null,32),r.photoPreview?((0,o.uX)(),(0,o.CE)("img",{key:0,src:r.photoPreview,alt:"Preview",class:"preview-image"},null,8,Ee)):r.errors.photo?((0,o.uX)(),(0,o.CE)("span",De,(0,l.v_)(r.errors.photo),1)):((0,o.uX)(),(0,o.CE)("span",je,"Загрузите фото"))],2),t[11]||(t[11]=(0,o.Lk)("span",{class:"photo-info"}," Максимальный размер: 5 Мб, допустимые форматы: jpg, jpeg, png ",-1))]),(0,o.Lk)("div",Se,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.formFields,((e,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s,class:"form-field"},["phone"===e.key?((0,o.uX)(),(0,o.CE)("div",Fe,[r.errors.phone?((0,o.uX)(),(0,o.CE)("div",Xe,(0,l.v_)(r.errors.phone),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",class:(0,l.C4)({"has-error":r.errors.phone}),placeholder:`Введите Ваш ${e.label}`,"onUpdate:modelValue":t[2]||(t[2]=e=>r.formData.phone=e)},null,10,Ie),[[i.Jo,r.formData.phone]])])):["lastName","firstName","middleName"].includes(e.key)?((0,o.uX)(),(0,o.CE)("div",Pe,[r.errors[e.key]?((0,o.uX)(),(0,o.CE)("div",Me,(0,l.v_)(r.errors[e.key]),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",class:(0,l.C4)({"has-error":r.errors[e.key]}),placeholder:`Введите Ваше ${e.label}`,"onUpdate:modelValue":t=>r.formData[e.key]=t},null,10,Te),[[i.Jo,r.formData[e.key]]])])):(0,o.Q3)("",!0),"iin"===e.key||"bin"===e.key?((0,o.uX)(),(0,o.CE)("div",Ae,[r.errors[e.key]?((0,o.uX)(),(0,o.CE)("div",Ne,(0,l.v_)(r.errors[e.key]),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",class:(0,l.C4)({"has-error":r.errors[e.key]}),placeholder:"Введите "+(r.isLegalEntity?"БИН":"ИИН"),"onUpdate:modelValue":t=>r.formData[e.key]=t},null,10,xe),[[i.Jo,r.formData[e.key]]])])):(0,o.Q3)("",!0),"company_name"===e.key?((0,o.uX)(),(0,o.CE)("div",Ue,[r.errors.company_name?((0,o.uX)(),(0,o.CE)("div",$e,(0,l.v_)(r.errors.company_name),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",class:(0,l.C4)({"has-error":r.errors.company_name}),placeholder:"Введите название компании","onUpdate:modelValue":t[3]||(t[3]=e=>r.formData.company_name=e)},null,2),[[i.Jo,r.formData.company_name]])])):(0,o.Q3)("",!0)])))),128))]),r.isLegalEntity?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Ke,[(0,o.Lk)("div",Re,[(0,o.Lk)("label",{class:(0,l.C4)(["upload-label",{"has-error":r.errors.scan_of_ID}])},[(0,o.Lk)("span",We,(0,l.v_)(r.errors.scan_of_ID||r.uploadedFiles.scan_of_ID||"Загрузите скан удостоверения"),1),(0,o.Lk)("input",{type:"file",onChange:t[4]||(t[4]=e=>n.handleDocumentUpload(e,"scan_of_ID")),accept:".jpg,.jpeg,.png,.pdf",style:{display:"none"}},null,32)],2)]),(0,o.Lk)("div",Qe,[(0,o.Lk)("label",{class:(0,l.C4)(["upload-label",{"has-error":r.errors.person_with_ID}])},[(0,o.Lk)("span",Be,(0,l.v_)(r.errors.person_with_ID||r.uploadedFiles.person_with_ID||"Загрузите фото с удостоверением"),1),(0,o.Lk)("input",{type:"file",onChange:t[5]||(t[5]=e=>n.handleDocumentUpload(e,"person_with_ID")),accept:".jpg,.jpeg,.png",style:{display:"none"}},null,32)],2)])]))]),r.isLegalEntity?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Oe,[t[12]||(t[12]=(0,o.Lk)("h2",null,"Профессиональная информация",-1)),(0,o.Lk)("div",Ve,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.physicalSelects,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:"select-field"},[(0,o.Lk)("div",{class:(0,l.C4)(["select-button",{"has-error":r.errors[e.key]}]),onClick:t=>n.openSelectModal(e)},[(0,o.Lk)("span",qe,(0,l.v_)(n.getSelectedValue(e)),1)],10,ze)])))),128))])])),r.showModal?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"modal-overlay",onClick:t[8]||(t[8]=(...e)=>n.closeModal&&n.closeModal(...e))},[(0,o.Lk)("div",{class:"modal-content",onClick:t[7]||(t[7]=(0,i.D$)((()=>{}),["stop"]))},[(0,o.Lk)("div",Je,[(0,o.Lk)("h3",null,(0,l.v_)(r.currentSelect?.placeholder),1),(0,o.Lk)("button",{class:"close-button",onClick:t[6]||(t[6]=(...e)=>n.closeModal&&n.closeModal(...e))},t[13]||(t[13]=[(0,o.Lk)("img",{src:Le,alt:"Закрыть"},null,-1)]))]),(0,o.Lk)("div",Ge,[(0,o.Lk)("div",He,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.currentSelect?.options,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,l.C4)(["option-item",{selected:r.selected[r.currentSelect?.key]===e.id}]),onClick:t=>n.selectOption(r.currentSelect?.key,e.id)},(0,l.v_)(e.name),11,Ye)))),128))])])])])):(0,o.Q3)("",!0),r.isLegalEntity?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Ze,[t[14]||(t[14]=(0,o.Lk)("h2",null,"Программы",-1)),(0,o.Lk)("div",et,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.programs,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,l.C4)(["program-item",{selected:r.selected.programs.includes(e.id)}]),onClick:t=>n.toggleProgram(e.id)},(0,l.v_)(e.name),11,tt)))),128))])])),(0,o.Lk)("button",{class:"submit-button",onClick:t[9]||(t[9]=(...e)=>n.updateProfile&&n.updateProfile(...e)),disabled:r.isLoading},(0,l.v_)(r.isLoading?"Обработка...":"Зарегистрироваться"),9,st)])])}const ot=5242880;var lt={name:"MobileAuthentication",data(){return{isLegalEntity:!1,registrationType:"physical",showDropdown:!1,showProgramDropdown:!1,programs:[],accessToken:"",selected:{specialty:null,education:null,experience:null,programs:[],legalType:null,category:null},physicalSelects:[{key:"specialty",placeholder:"Выберите вашу специальность",options:[]},{key:"education",placeholder:"Выберите ваше образование",options:[]},{key:"experience",placeholder:"Выберите ваш опыт работы",options:[]}],legalSelects:[{key:"legalType",placeholder:"Выберите тип юридического лица",options:[]},{key:"category",placeholder:"Выберите категорию",options:[]}],errors:{},formData:{photo:null,firstName:"",lastName:"",middleName:"",iin:"",phone:"",documents:{scan_of_ID:null,person_with_ID:null},company_name:"",bin:""},photoPreview:null,showDropdownIndex:null,isLoading:!1,errorMessage:"",uploadedFiles:{scan_of_ID:"",person_with_ID:""},showModal:!1,currentSelect:null}},computed:{formFields(){return this.isLegalEntity?[{key:"company_name",label:"Название компании"},{key:"bin",label:"БИН"},{key:"legal_entity_type",label:"Тип юридического лица"}]:[{key:"lastName",label:"Фамилия"},{key:"firstName",label:"Имя"},{key:"middleName",label:"Отчество"},{key:"iin",label:"ИИН"},{key:"phone",label:"Номер телефона"}]}},methods:{handleFileUpload(e){const t=e.target.files[0];if(!t)return;if(t.size>ot)return void(this.errors.photo="Размер файла не должен превышать 5 МБ");const s=new FileReader;s.onload=()=>{this.photoPreview=s.result,this.formData.photo=t},s.onerror=()=>{this.errors.photo="Не удалось прочитать файл"},s.readAsDataURL(t)},handleDocumentUpload(e,t){const s=e.target.files[0];s&&(s.size>ot?this.errors[t]="Размер файла не должен превышать 5 МБ":(this.formData.documents[t]=s,this.uploadedFiles[t]=s.name))},toggleDropdown(e){this.showDropdownIndex=this.showDropdownIndex===e?null:e},selectOption(e,t){e&&t&&(this.selected[e]=t,this.closeModal())},getSelectedValue(e){return this.selected[e.key]?e.options.find((t=>t.id===this.selected[e.key]))?.name:e.placeholder},async fetchOptions(e,t){try{const s=await ge.A.get(`api/accounts/${e}/`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),a=this.physicalSelects.find((e=>e.key===t));a&&(a.options=s.data.map((e=>({id:e.id,name:e.name}))))}catch{this.errorMessage="Ошибка при загрузке данных."}},async loadDropdownData(){this.isLegalEntity?(await this.fetchLegalTypes(),await this.fetchCategories()):await Promise.all([this.fetchOptions("specialties","specialty"),this.fetchOptions("educations","education"),this.fetchOptions("experiences","experience"),this.fetchPrograms()])},async fetchLegalTypes(){try{const e=await ge.A.get("api/accounts/legal-entity-types/",{headers:{Authorization:`Bearer ${this.accessToken}`}});Array.isArray(e.data)&&(this.legalSelects.find((e=>"legalType"===e.key)).options=e.data.map((e=>({id:e.id,name:e.name}))))}catch(e){console.error("Ошибка при загрузке типов юридических лиц:",e),this.errorMessage="Ошибка при загрузке типов юридических лиц"}},async fetchPrograms(){try{const e=await ge.A.get("api/accounts/programs/",{headers:{Authorization:`Bearer ${this.accessToken}`}});this.programs=e.data.map((e=>({id:e.id,name:e.name})))}catch{this.errorMessage="Ошибка при загрузке списка программ."}},async fetchCategories(){try{const e=await ge.A.get("api/accounts/categories/",{headers:{Authorization:`Bearer ${this.accessToken}`}});Array.isArray(e.data)&&(this.legalSelects.find((e=>"category"===e.key)).options=e.data.map((e=>({id:e.id,name:e.name}))))}catch(e){console.error("Ошибка при загрузке категорий:",e),this.errorMessage="Ошибка при загрузке категорий"}},async updateProfile(){const e=localStorage.getItem("accessToken");if(!e)return this.errors.general="Ошибка: Пользователь не авторизован.",void this.$router.push("/landing");this.errors={};const t=this.isLegalEntity?["company_name","bin"]:["firstName","lastName","phone","iin"];if(t.forEach((e=>{this.formData[e]?.trim()||(this.errors[e]="Это поле обязательно для заполнения.")})),this.isLegalEntity||this.selected.specialty||(this.errors.specialty="Выберите вашу специальность."),this.isLegalEntity&&!this.selected.legalType&&(this.errors.legalType="Выберите тип юридического лица."),this.isLegalEntity&&!this.selected.category&&(this.errors.category="Выберите категорию."),Object.keys(this.errors).length>0)return;const s={phone:this.formData.phone.trim(),[this.isLegalEntity?"photo_company":"photo"]:this.formData.photo,documents:this.formData.documents};this.isLegalEntity?(s.company_name=this.formData.company_name.trim(),s.bin=this.formData.bin.trim(),s.legal_entity_type=this.selected.legalType,s.category=this.selected.category):(s.first_name=this.formData.firstName.trim(),s.last_name=this.formData.lastName.trim(),s.middle_name=this.formData.middleName.trim(),s.iin=this.formData.iin.trim(),s.specialty=this.selected.specialty,s.education=this.selected.education,s.experience=this.selected.experience,s.programs=this.selected.programs);try{this.isLoading=!0,await this.updateProfileData(s),localStorage.setItem("profileComplete","true"),localStorage.setItem("profileType",this.isLegalEntity?"legal":"physical"),await this.$router.push("/dashboard")}catch(a){console.error("Ошибка при обновлении профиля:",a),this.errors.general?this.errorMessage=this.errors.general:this.handleUpdateErrors(a)}finally{this.isLoading=!1}},async updateProfileData(e){const t=new FormData;e.documents&&"object"===typeof e.documents&&Object.entries(e.documents).forEach((([e,s])=>{s&&t.append(e,s)})),Object.entries(e).forEach((([e,s])=>{"documents"!==e&&""!==s&&null!==s&&void 0!==s&&(Array.isArray(s)?s.forEach((s=>t.append(e,s))):t.append(e,s))}));const s=await ge.A.put("api/accounts/profile/edit/",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${this.accessToken}`}});return s.data},handleUpdateErrors(e){if(this.errors={},e.response&&e.response.data)for(const[t,s]of Object.entries(e.response.data))Array.isArray(s)?this.errors[t]=s.some((e=>e.toLowerCase().includes("required")))?"Это поле обязательно для заполнения.":s.join(", "):this.errors[t]=s;else this.errors.general="Произошла ошибка при обновлении профиля."},openSelectModal(e){this.currentSelect=e,this.showModal=!0,document.body.style.overflow="hidden"},closeModal(){this.showModal=!1,this.currentSelect=null,document.body.style.overflow=""},goBack(){this.$router.push("/landing")},toggleProgram(e){this.selected.programs||(this.selected.programs=[]);const t=this.selected.programs.indexOf(e);-1===t?this.selected.programs.push(e):this.selected.programs.splice(t,1)}},async created(){this.isLegalEntity="legal"===localStorage.getItem("profileType"),this.accessToken=localStorage.getItem("accessToken"),this.accessToken&&await this.loadDropdownData()},mounted(){this.accessToken||this.$router.push("/landing")},beforeDestroy(){document.body.style.overflow=""}},it=s(1241);const rt=(0,it.A)(lt,[["render",at],["__scopeId","data-v-79b839b2"]]);var nt=rt;const ct=5242880;var dt={name:"IndividualReg",components:{MobileAuthentication:nt},data(){return{isLegalEntity:!1,registrationType:"physical",showDropdown:!1,showProgramDropdown:!1,programs:[],accessToken:"",selected:{specialty:null,education:null,experience:null,programs:[],legalType:null,category:null},physicalSelects:[{key:"specialty",placeholder:"Выберите вашу специальность",options:[]},{key:"education",placeholder:"Выберите ваше образование",options:[]},{key:"experience",placeholder:"Выберите ваш опыт работы",options:[]}],legalSelects:[{key:"legalType",placeholder:"Выберите тип юридического лица",options:[]},{key:"category",placeholder:"Выберите категорию",options:[]}],errors:{},formData:{photo:null,firstName:"",lastName:"",middleName:"",iin:"",phone:"",documents:{scan_of_ID:null,person_with_ID:null},company_name:"",bin:"",license:null,accreditation:null,project:null,portfolio:null,completion_acts:null,expertise_confirmation:null},photoPreview:null,showDropdownIndex:null,isLoading:!1,errorMessage:"",uploadedFiles:{scan_of_ID:"",person_with_ID:"",license:"",accreditation:"",project:"",portfolio:"",completion_acts:"",expertise_confirmation:""}}},computed:{selectedProgramsNames(){return this.programs?this.programs.filter((e=>this.selected.programs.includes(e.id))).map((e=>e.name)).join(", "):""},formFields(){return this.isLegalEntity?[{key:"company_name",label:"Название компании"},{key:"bin",label:"БИН"},{key:"legal_entity_type",label:"Тип юридического лица"}]:[{key:"lastName",label:"Фамилия"},{key:"firstName",label:"Имя"},{key:"middleName",label:"Отчество"},{key:"iin",label:"ИИН"},{key:"phone",label:"Номер телефона"}]}},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}},created(){this.isLegalEntity="legal"===localStorage.getItem("profileType"),this.fetchUserProfile().catch((e=>{console.error("Error during component initialization:",e),this.errorMessage="Ошибка при инициализации компонента"}))},methods:{camelToSnake(e){return e.replace(/[A-Z]/g,(e=>`_${e.toLowerCase()}`))},removeErrorByField(e){e in this.errors&&(delete this.errors[e],this.errors={...this.errors})},checkFileFormatAndSize(e,t){if(!e)return{valid:!1,error:"Файл не предоставлен"};const s="."+e.name.split(".").pop().toLowerCase();return t.includes(s)?e.size>ct?{valid:!1,error:"Размер файла не должен превышать 5 МБ"}:{valid:!0}:{valid:!1,error:`Неверный формат файла. Допустимые форматы: ${t.join(", ")}`}},handleFileChange(e,t,s){const a=e.target.files[0];if(!a)return;const{valid:o,error:l}=this.checkFileFormatAndSize(a,s);if(!o)return this.errors[t]=l,this.uploadedFiles[t]="",void(e.target.value="");if(this.removeErrorByField(t),"photo"===t){const e=new FileReader;e.onload=()=>{this.photoPreview=e.result,this.formData[t]=a,this.uploadedFiles[t]=a.name},e.onerror=()=>{this.errors[t]="Не удалось прочитать файл",this.uploadedFiles[t]=""},e.readAsDataURL(a)}else t in this.formData.documents?this.formData.documents[t]=a:this.formData[t]=a,this.uploadedFiles[t]=a.name},handleFileUpload(e){this.handleFileChange(e,"photo",[".jpg",".jpeg",".png"])},handleDocumentUpload(e,t){"scan_of_ID"===t?this.handleFileChange(e,t,[".jpg",".jpeg",".png",".pdf"]):"person_with_ID"===t&&this.handleFileChange(e,t,[".jpg",".jpeg",".png"])},handleLicenseUpload(e){this.handleFileChange(e,"license",[".pdf"])},handleAccreditationUpload(e){this.handleFileChange(e,"accreditation",[".pdf"])},handleProjectUpload(e){this.handleFileChange(e,"project",[".pdf",".doc",".docx"])},handlePortfolioUpload(e){this.handleFileChange(e,"portfolio",[".jpg",".jpeg",".png",".pdf"])},handleActsUpload(e){this.handleFileChange(e,"completion_acts",[".pdf"])},handleExpertiseConfirmationUpload(e){this.handleFileChange(e,"expertise_confirmation",[".pdf"])},toggleDropdown(e){this.showDropdownIndex=this.showDropdownIndex===e?null:e,null!==this.showDropdownIndex&&(this.showProgramDropdown=!1)},toggleProgramDropdown(){this.showProgramDropdown=!this.showProgramDropdown,this.showProgramDropdown&&(this.showDropdownIndex=null)},selectOption(e,t){this.selected[e]=t,this.showDropdownIndex=null,this.removeErrorByField(e)},toggleProgram(e){const t=this.selected.programs.indexOf(e);-1===t?this.selected.programs.push(e):this.selected.programs.splice(t,1)},async fetchOptions(e,t){try{const s=await ge.A.get(`api/accounts/${e}/`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),a=this.physicalSelects.find((e=>e.key===t));a&&(a.options=s.data.map((e=>({id:e.id,name:e.name}))))}catch{this.errorMessage="Ошибка при загрузке данных."}},async loadDropdownData(){this.isLegalEntity?(await this.fetchLegalTypes(),await this.fetchCategories()):await Promise.all([this.fetchOptions("specialties","specialty"),this.fetchOptions("educations","education"),this.fetchOptions("experiences","experience"),this.fetchPrograms()])},async fetchLegalTypes(){try{const e=await ge.A.get("api/accounts/legal-entity-types/",{headers:{Authorization:`Bearer ${this.accessToken}`}});Array.isArray(e.data)&&(this.legalSelects.find((e=>"legalType"===e.key)).options=e.data.map((e=>({id:e.id,name:e.name}))))}catch(e){console.error("Ошибка при загрузке типов юридических лиц:",e),this.errorMessage="Ошибка при загрузке типов юридических лиц"}},async fetchPrograms(){try{const e=await ge.A.get("api/accounts/programs/",{headers:{Authorization:`Bearer ${this.accessToken}`}});this.programs=e.data.map((e=>({id:e.id,name:e.name})))}catch{this.errorMessage="Ошибка при загрузке списка программ."}},async fetchUserProfile(){const e=await ge.A.get("api/accounts/profile/",{headers:{Authorization:`Bearer ${this.accessToken}`}});e.data.legal_type?this.$router.push("/dashboard"):this.populateFormData(e.data)},populateFormData(e){const t=["firstName","lastName","middleName","iin","phone"],s=["company_name","bin","legal_entity_type"];this.formData.phone=e.phone||"",this.isLegalEntity?s.forEach((t=>{this.formData[t]=e[this.camelToSnake(t)]||""})):(t.forEach((t=>{"phone"!==t&&(this.formData[t]=e[this.camelToSnake(t)]||"")})),this.selected.specialty=e.specialty?Number(e.specialty):null,this.selected.education=e.education?Number(e.education):null,this.selected.experience=e.experience?Number(e.experience):null,this.selected.programs=e.programs?e.programs.map(Number):[],e.photo_url&&(this.photoPreview=e.photo_url),e.documents&&(this.formData.documents.scan_of_ID=e.documents.scan_of_ID||null,this.formData.documents.person_with_ID=e.documents.person_with_ID||null))},async updateProfileData(e){const t=new FormData;e.documents&&"object"===typeof e.documents&&Object.entries(e.documents).forEach((([e,s])=>{s&&t.append(e,s)})),Object.entries(e).forEach((([e,s])=>{"documents"!==e&&""!==s&&null!==s&&void 0!==s&&(Array.isArray(s)?s.forEach((s=>t.append(e,s))):t.append(e,s))}));const s=await ge.A.put("api/accounts/profile/edit/",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${this.accessToken}`}});return s.data},handleUpdateErrors(e){if(this.errors={},e.response&&e.response.data)for(const[t,s]of Object.entries(e.response.data))Array.isArray(s)?this.errors[t]=s.some((e=>e.toLowerCase().includes("required")))?"Это поле обязательно для заполнения.":s.join(", "):this.errors[t]=s;else this.errors.general="Произошла ошибка при обновлении профиля."},async updateProfile(){const e=localStorage.getItem("accessToken");if(!e)return this.errors.general="Ошибка: Пользователь не авторизован.",void this.$router.push("/landing");this.errors={};const t=this.isLegalEntity?["company_name","bin"]:["firstName","lastName","phone","iin"];if(t.forEach((e=>{this.formData[e]?.trim()||(this.errors[e]="Это поле обязательно для заполнения.")})),this.isLegalEntity||this.selected.specialty||(this.errors.specialty="Выберите вашу специальность."),this.isLegalEntity&&!this.selected.legalType&&(this.errors.legalType="Выберите тип юридического лица."),this.isLegalEntity&&!this.selected.category&&(this.errors.category="Выберите категорию."),Object.keys(this.errors).length>0)return;const s={phone:this.formData.phone.trim(),[this.isLegalEntity?"photo_company":"photo"]:this.formData.photo,documents:this.formData.documents};this.isLegalEntity?(s.company_name=this.formData.company_name.trim(),s.bin=this.formData.bin.trim(),s.legal_entity_type=this.selected.legalType,s.category=this.selected.category):(s.first_name=this.formData.firstName.trim(),s.last_name=this.formData.lastName.trim(),s.middle_name=this.formData.middleName.trim(),s.iin=this.formData.iin.trim(),s.specialty=this.selected.specialty,s.education=this.selected.education,s.experience=this.selected.experience,s.programs=this.selected.programs),s.license=this.formData.license,s.accreditation=this.formData.accreditation,s.project=this.formData.project,s.portfolio=this.formData.portfolio,s.completion_acts=this.formData.completion_acts,s.expertise_confirmation=this.formData.expertise_confirmation;try{this.isLoading=!0,await this.updateProfileData(s),localStorage.setItem("profileComplete","true"),localStorage.setItem("profileType",this.isLegalEntity?"legal":"physical"),await this.$router.push("/dashboard")}catch(a){console.error("Ошибка при обновлении профиля:",a),this.errors.general?this.errorMessage=this.errors.general:this.handleUpdateErrors(a)}finally{this.isLoading=!1}},async fetchCategories(){try{const e=await ge.A.get("api/accounts/categories/",{headers:{Authorization:`Bearer ${this.accessToken}`}});Array.isArray(e.data)&&(this.legalSelects.find((e=>"category"===e.key)).options=e.data.map((e=>({id:e.id,name:e.name}))))}catch(e){console.error("Ошибка при загрузке категорий:",e),this.errorMessage="Ошибка при загрузке категорий"}}}};const ut=(0,it.A)(dt,[["render",ke],["__scopeId","data-v-61c45c14"]]);var pt=ut;const ht={class:"dashboard-layout"},mt={class:"main-content"};function vt(e,t,s,a,l,i){const r=(0,o.g2)("Sidebar"),n=(0,o.g2)("Header"),c=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)("div",ht,[(0,o.bF)(r),(0,o.Lk)("div",mt,[(0,o.bF)(n),(0,o.bF)(c)])])}var kt=s.p+"img/home.614fa8d6.svg",gt=s.p+"img/plus.77ee164f.svg",ft=s.p+"img/auction.8951017a.svg",yt=s.p+"img/chats.74953193.svg",Lt=s.p+"img/wallet.8c4b6807.svg",bt=s.p+"img/folder.bba1668e.svg",Ct=s.p+"img/calendar.58b0a8c9.svg",_t=s.p+"img/bag.2900aa38.svg",wt=s.p+"img/news.293e1d79.svg",Et=s.p+"img/paper.05a51bac.svg";const Dt={class:"sidebar-header"},jt={class:"menu"},St={key:0},Ft={class:"menu-title-container"},Xt={key:0,class:"menu-title"},It={key:1,class:"menu-line"},Pt={key:0},Mt={key:0},Tt={key:0},At={key:0},Nt={key:0},xt={key:0},Ut={key:0},$t={class:"menu-title-container"},Kt={key:0,class:"menu-title"},Rt={key:1,class:"menu-line"},Wt={key:0},Qt={key:0},Bt={key:0};function Ot(e,t,s,a,i,r){const n=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("aside",{class:(0,l.C4)(["sidebar",{collapsed:i.isSidebarCollapsed}]),onMouseenter:t[0]||(t[0]=e=>i.isSidebarCollapsed=!1),onMouseleave:t[1]||(t[1]=e=>i.isSidebarCollapsed=!0)},[(0,o.Lk)("div",Dt,[(0,o.Lk)("h2",null,(0,l.v_)(i.isSidebarCollapsed?"PM":"PROJECT MANAGER"),1)]),(0,o.Lk)("nav",jt,[(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,[(0,o.bF)(n,{to:"/dashboard"},{default:(0,o.k6)((()=>[t[2]||(t[2]=(0,o.Lk)("img",{src:kt,alt:"Главная",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",St,"Главная страница"))])),_:1})])]),(0,o.Lk)("div",Ft,[i.isSidebarCollapsed?((0,o.uX)(),(0,o.CE)("div",It)):((0,o.uX)(),(0,o.CE)("p",Xt,"Проекты"))]),(0,o.Lk)("ul",null,[r.isCreateProjectVisible?((0,o.uX)(),(0,o.CE)("li",Pt,[(0,o.bF)(n,{to:"/projects"},{default:(0,o.k6)((()=>[t[3]||(t[3]=(0,o.Lk)("img",{src:gt,alt:"Создать проект",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",Mt,"Создать проект"))])),_:1})])):(0,o.Q3)("",!0),(0,o.Lk)("li",null,[(0,o.bF)(n,{to:"/auction"},{default:(0,o.k6)((()=>[t[4]||(t[4]=(0,o.Lk)("img",{src:ft,alt:"Аукцион",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",Tt,"Аукцион"))])),_:1})]),(0,o.Lk)("li",null,[(0,o.bF)(n,{to:"/chats"},{default:(0,o.k6)((()=>[t[5]||(t[5]=(0,o.Lk)("img",{src:yt,alt:"Чаты",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",At,"Чаты"))])),_:1})]),(0,o.Lk)("li",null,[(0,o.bF)(n,{to:"/finance"},{default:(0,o.k6)((()=>[t[6]||(t[6]=(0,o.Lk)("img",{src:Lt,alt:"Финансы",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",Nt,"Финансы"))])),_:1})]),(0,o.Lk)("li",null,[(0,o.bF)(n,{to:"/investments"},{default:(0,o.k6)((()=>[t[7]||(t[7]=(0,o.Lk)("img",{src:bt,alt:"Вложения",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",xt,"Вложения"))])),_:1})]),(0,o.Lk)("li",null,[(0,o.bF)(n,{to:"/calendar"},{default:(0,o.k6)((()=>[t[8]||(t[8]=(0,o.Lk)("img",{src:Ct,alt:"Календарь",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",Ut,"Календарь"))])),_:1})])]),(0,o.Lk)("div",$t,[i.isSidebarCollapsed?((0,o.uX)(),(0,o.CE)("div",Rt)):((0,o.uX)(),(0,o.CE)("p",Kt,"Прочее"))]),(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,[(0,o.bF)(n,{to:"/shop"},{default:(0,o.k6)((()=>[t[9]||(t[9]=(0,o.Lk)("img",{src:_t,alt:"Магазин",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",Wt,"Магазин"))])),_:1})]),(0,o.Lk)("li",null,[(0,o.bF)(n,{to:"/news"},{default:(0,o.k6)((()=>[t[10]||(t[10]=(0,o.Lk)("img",{src:wt,alt:"Новости",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",Qt,"Новости"))])),_:1})]),(0,o.Lk)("li",null,[(0,o.bF)(n,{to:"/documents"},{default:(0,o.k6)((()=>[t[11]||(t[11]=(0,o.Lk)("img",{src:Et,alt:"Нормативные документы",class:"icon"},null,-1)),i.isSidebarCollapsed?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",Bt,"Нормативные акты"))])),_:1})])])])],34)}var Vt=s(657);s(4603),s(7566),s(8721);const zt=(0,Vt.nY)("profile",{state:()=>({profileType:null,profileData:{physical_profile:{},legal_profile:{}},accessToken:"",programs:[],specialties:[],educations:[],experiences:[],legalEntityTypes:[],categories:[],showConfirmModal:!1,baseDownloadUrl:"api/accounts/",apiClient:null}),getters:{getSpecialtyName(e){if(!0===e.profileData.physical_profile?.is_gip)return"ГИП";const t=e.specialties.find((t=>t.id===e.profileData.physical_profile?.specialty));return t?t.name:"Не указано"},getEducationName(e){const t=e.educations.find((t=>t.id===e.profileData.physical_profile.education));return t?t.name:"Не указано"},getExperienceName(e){const t=e.experiences.find((t=>t.id===e.profileData.physical_profile.experience));return t?t.name:"Не указано"},getCompanyName(e){return e.profileData.legal_profile.company_name||"Не указано"},getBin(e){return e.profileData.legal_profile.bin||"Не указано"},getLegalEntityTypeName(e){const t=e.legalEntityTypes.find((t=>t.id===e.profileData.legal_profile.legal_entity_type));return t?t.name:"Не указано"},getCategoryName(e){const t=e.categories.find((t=>t.id===e.profileData.legal_profile.category));return t?t.name:"Не указано"},selectedProgramsNames(e){const t=e.programs.filter((t=>e.profileData.physical_profile.programs.includes(t.id))).map((e=>e.name)).join(", ");return t}},actions:{setupAxios(){this.apiClient=ge.A.create({baseURL:this.baseDownloadUrl,headers:{"Content-Type":"application/json"}}),this.apiClient.interceptors.request.use((e=>(this.accessToken&&(e.headers.Authorization=`Bearer ${this.accessToken}`),e)),(e=>Promise.reject(e)))},async fetchUserProfile(){try{this.apiClient||this.setupAxios();const e=await this.apiClient.get("profile/");this.profileData=e.data,this.profileType=e.data.profile_type,await this.loadDropdownData()}catch(e){const t=(0,a.rd)();t.push("/landing")}},async loadDropdownData(){this.apiClient||this.setupAxios();const e={educations:"educations/",specialties:"specialties/",experiences:"experiences/",programs:"programs/",legalEntityTypes:"legal-entity-types/",categories:"categories/"};try{const t=Object.entries(e).map((([e,t])=>this.fetchData(t,e).catch((e=>[]))));await Promise.all(t)}catch(t){}},async fetchData(e,t){try{const s=await this.apiClient.get(e);this[t]=s.data}catch(s){}},confirmSwitchProfile(){this.showConfirmModal=!0},cancelSwitch(){this.showConfirmModal=!1},async switchProfile(){this.showConfirmModal=!1;try{await this.apiClient.patch("profile/switch-type/",{profile_type:"legal"}),await this.fetchUserProfile();const e=(0,a.rd)();e.push("/cauth")}catch(e){alert("Не удалось переключить тип профиля. Попробуйте снова.")}},async downloadFile(e){try{const t=`download/${e}/`,s=await this.apiClient.get(t,{responseType:"blob"}),a=s.headers["content-disposition"];let o="downloaded_file";if(a&&a.includes("attachment")){const e=a.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);null!=e&&e[1]&&(o=e[1].replace(/['"]/g,""))}a||(o=`${e}.${this.getFileExtension(e)}`);const l=window.URL.createObjectURL(new Blob([s.data])),i=document.createElement("a");i.href=l,i.setAttribute("download",o),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(l)}catch(t){alert("Не удалось скачать файл. Попробуйте снова.")}},getFileExtension(e){const t={photo:"jpg",scan_of_ID:"pdf",person_with_ID:"jpg",photo_company:"jpg",license:"pdf",accreditation:"pdf",project:"pdf",portfolio:"pdf",completion_acts:"pdf",expertise_confirmation:"pdf"};return t[e]||"dat"}}});var qt={name:"Sidebar",data(){return{isSidebarCollapsed:"true"===localStorage.getItem("isSidebarCollapsed")}},computed:{...(0,Vt.aH)(zt,["profileData"]),isCreateProjectVisible(){return!0===this.profileData?.physical_profile?.is_gip}},watch:{isSidebarCollapsed(e){localStorage.setItem("isSidebarCollapsed",e)}},async created(){this.isSidebarCollapsed="true"===localStorage.getItem("isSidebarCollapsed");const e=zt(),t=localStorage.getItem("accessToken");t&&(e.accessToken=t,e.setupAxios(),await e.fetchUserProfile())}};const Jt=(0,it.A)(qt,[["render",Ot],["__scopeId","data-v-547e724e"]]);var Gt=Jt,Ht=s.p+"img/notification.efd72fbf.svg",Yt=s.p+"img/profile.e2d38cb8.svg",Zt=s.p+"img/settings.43349b7e.svg",es=s.p+"img/support.581fbcdb.svg",ts=s.p+"img/logout.20218905.svg";const ss={class:"header"},as={key:0,class:"profile"},os={key:0,class:"notification-indicator"},ls={class:"user-info no-pointer"},is={class:"user-name"},rs={class:"user-role"},ns=["src"],cs=["src"],ds={class:"menu-section"},us={class:"menu-section"};function ps(e,t,a,r,n,c){const d=(0,o.g2)("Notifications"),u=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("header",ss,[r.userStore.isDataLoaded?((0,o.uX)(),(0,o.CE)("div",as,[(0,o.Lk)("div",{class:"icon notification-icon",onClick:t[0]||(t[0]=(0,i.D$)(((...e)=>r.toggleNotifications&&r.toggleNotifications(...e)),["stop"]))},[t[5]||(t[5]=(0,o.Lk)("img",{src:Ht,alt:"Уведомления"},null,-1)),r.hasUnread?((0,o.uX)(),(0,o.CE)("span",os)):(0,o.Q3)("",!0)]),(0,o.bF)(d,{show:r.showNotifications,onClose:r.closeNotifications},null,8,["show","onClose"]),(0,o.Lk)("div",ls,[(0,o.Lk)("p",is,(0,l.v_)(r.userStore.fullName),1),(0,o.Lk)("p",rs,(0,l.v_)(r.userStore.displayRole),1)]),(0,o.Lk)("img",{src:r.userStore.userAvatar,alt:"User Avatar",class:"avatar",onClick:t[1]||(t[1]=(...e)=>r.userStore.toggleDropdown&&r.userStore.toggleDropdown(...e))},null,8,ns),(0,o.Lk)("img",{src:r.userStore.isDropdownOpen?s(6519):s(8988),alt:"Dropdown Arrow",class:"dropdown-icon",onClick:t[2]||(t[2]=(...e)=>r.userStore.toggleDropdown&&r.userStore.toggleDropdown(...e))},null,8,cs)])):(0,o.Q3)("",!0),r.userStore.isDropdownOpen?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"dropdown-menu",onClick:t[4]||(t[4]=(0,i.D$)((()=>{}),["stop"]))},[(0,o.Lk)("div",ds,[t[9]||(t[9]=(0,o.Lk)("p",{class:"section-title"},"АККАУНТ",-1)),(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,[(0,o.bF)(u,{to:"/profile"},{default:(0,o.k6)((()=>t[6]||(t[6]=[(0,o.Lk)("img",{src:Yt,alt:"Профиль",class:"menu-icon"},null,-1),(0,o.eW)(" Профиль ")]))),_:1})]),t[7]||(t[7]=(0,o.Lk)("li",null,[(0,o.Lk)("a",{href:"#"},[(0,o.Lk)("img",{src:Zt,alt:"Настройки",class:"menu-icon"}),(0,o.eW)(" Настройки ")])],-1)),t[8]||(t[8]=(0,o.Lk)("hr",{class:"separator"},null,-1))])]),t[11]||(t[11]=(0,o.Fv)('<div class="menu-section" data-v-410d9c3d><p class="section-title" data-v-410d9c3d>ПРОЧЕЕ</p><ul data-v-410d9c3d><li data-v-410d9c3d><a href="#" data-v-410d9c3d><img src="'+es+'" alt="Тех.поддержка" class="menu-icon" data-v-410d9c3d> Тех.поддержка </a></li><hr class="separator" data-v-410d9c3d></ul></div>',1)),(0,o.Lk)("div",us,[(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,[(0,o.Lk)("a",{href:"#",onClick:t[3]||(t[3]=e=>r.userStore.logout(r.router))},t[10]||(t[10]=[(0,o.Lk)("img",{src:ts,alt:"Выйти",class:"menu-icon"},null,-1),(0,o.eW)(" Выйти ")]))])])])])):(0,o.Q3)("",!0)])}const hs=(0,Vt.nY)("user",{state:()=>({isDropdownOpen:!1,showNotifications:!1,searchQuery:"",profileData:null,profileType:null,accessToken:"",specialties:[],legalEntityTypes:[],isProfileLoaded:!1,isSpecialtiesLoaded:!1,isLegalEntityTypesLoaded:!1,cachedData:{specialties:null,legalEntityTypes:null,profile:null,cacheTimestamp:null}}),getters:{isDataLoaded(e){return e.isProfileLoaded&&e.isSpecialtiesLoaded&&e.isLegalEntityTypesLoaded},firstName(e){return"physical"===e.profileType&&e.profileData?.physical_profile?.first_name||""},fullName(e){if("physical"===e.profileType){const t=e.firstName,s=e.profileData?.physical_profile?.last_name||"";return`${t} ${s}`.trim()||"Пользователь"}return"legal"===e.profileType?e.profileData?.legal_profile?.company_name||"Неизвестная компания":"Пользователь"},displayRole(e){return e.profileData?"legal"===e.profileType?this.getLegalEntityType():this.getSpecialtyName():"Загрузка..."},userAvatar(e){return"legal"===e.profileType?e.profileData?.legal_profile?.photo_company||s(4211):e.profileData?.physical_profile?.photo||s(4211)},isGip:e=>!0===e.profileData?.physical_profile?.is_gip},actions:{isCacheValid(){const e=Date.now(),t=e-(this.cachedData.cacheTimestamp||0);return t<864e5},async initialize(){if(this.accessToken=localStorage.getItem("accessToken"),!this.accessToken)return!1;try{const e=localStorage.getItem("userStoreCache");if(e){const t=JSON.parse(e);if(t.cacheTimestamp&&this.isCacheValid())return this.cachedData=t,this.profileData=t.profile,this.profileType=t.profile?.profile_type,this.specialties=t.specialties,this.legalEntityTypes=t.legalEntityTypes,this.isProfileLoaded=!0,this.isSpecialtiesLoaded=!0,this.isLegalEntityTypesLoaded=!0,!0}const t=await this.fetchUserProfile();return localStorage.setItem("user_id",t.id),await Promise.all([this.fetchSpecialties(),this.fetchLegalEntityTypes()]),this.cachedData={profile:this.profileData,specialties:this.specialties,legalEntityTypes:this.legalEntityTypes,cacheTimestamp:Date.now()},localStorage.setItem("userStoreCache",JSON.stringify(this.cachedData)),!0}catch(e){return localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("userStoreCache"),!1}},async fetchUserProfile(){try{const e=await ge.A.get("api/accounts/profile/",{headers:{Authorization:`Bearer ${this.accessToken}`}});return this.profileData=e.data,this.profileType=e.data.profile_type,this.isProfileLoaded=!0,e.data}catch(e){throw 401===e.response?.status&&(this.accessToken=null,localStorage.removeItem("accessToken")),e}},async fetchSpecialties(){try{const e=await ge.A.get("api/accounts/specialties/",{headers:{Authorization:`Bearer ${this.accessToken}`}});this.specialties=Array.isArray(e.data)?e.data:e.data.results||[],this.isSpecialtiesLoaded=!0}catch(e){throw e}},async fetchLegalEntityTypes(){try{const e=await ge.A.get("api/accounts/legal-entity-types/",{headers:{Authorization:`Bearer ${this.accessToken}`}});this.legalEntityTypes=Array.isArray(e.data)?e.data:e.data.results||[],this.isLegalEntityTypesLoaded=!0}catch(e){throw e}},toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen},toggleNotifications(){this.showNotifications=!this.showNotifications},performSearch(){},logout(e){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("profileComplete"),localStorage.removeItem("profileType"),localStorage.removeItem("userStoreCache"),e.push("/landing")},getLegalEntityType(){const e=this.profileData?.legal_profile?.legal_entity_type;if(!e)return"Неизвестный тип";const t=this.legalEntityTypes.find((t=>t.id===e));if(!t)return"Неизвестный тип";const s={1:"ООО",2:"АО",3:"ЗАО",4:"ИП",5:"СРО",6:"ГУП или МУП"};return s[t.id]||t.name},getSpecialtyName(){if(!0===this.profileData?.physical_profile?.is_gip)return"ГИП";const e=this.profileData?.physical_profile?.specialty;if(!e||!Array.isArray(this.specialties))return"Не указано";const t=this.specialties.find((t=>t.id===e));return t?t.name:"Не указано"}}}),ms={key:0,class:"notifications-sidebar"},vs={class:"notifications-header"},ks={class:"notifications-list"},gs={key:0,class:"empty-notifications"},fs={key:1},ys={class:"scroll-container"},Ls={class:"messages-list"},bs={class:"message-text"},Cs={class:"message-meta"},_s={class:"timestamp"},ws={class:"chat-id"};function Es(e,t,s,a,i,r){return s.show?((0,o.uX)(),(0,o.CE)("div",ms,[(0,o.Lk)("div",vs,[t[2]||(t[2]=(0,o.Lk)("h3",null,"Уведомления",-1)),(0,o.Lk)("button",{class:"close-button",onClick:t[0]||(t[0]=t=>e.$emit("close"))},t[1]||(t[1]=[(0,o.Lk)("img",{src:Le,alt:"Закрыть"},null,-1)]))]),(0,o.Lk)("div",ks,[0===i.unreadMessages.length?((0,o.uX)(),(0,o.CE)("div",gs,t[3]||(t[3]=[(0,o.Lk)("img",{src:Ht,alt:"Нет уведомлений"},null,-1),(0,o.Lk)("p",null,"Нет новых уведомлений",-1)]))):((0,o.uX)(),(0,o.CE)("div",fs,[(0,o.Lk)("p",null,"У вас "+(0,l.v_)(i.unreadMessages.length)+" новых уведомлений",1),(0,o.Lk)("div",ys,[(0,o.Lk)("ul",Ls,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.unreadMessages,((e,t)=>((0,o.uX)(),(0,o.CE)("li",{key:t,class:"message-item"},[(0,o.Lk)("div",bs,(0,l.v_)(e.message),1),(0,o.Lk)("div",Cs,[(0,o.Lk)("span",_s,(0,l.v_)(r.formatTimestamp(e.timestamp)),1),(0,o.Lk)("span",ws,"Чат #"+(0,l.v_)(e.chat_id),1)])])))),128))])])]))])])):(0,o.Q3)("",!0)}var Ds={name:"Notifications",props:{show:{type:Boolean,default:!1}},emits:["close"],data(){return{unreadMessages:[],intervalId:null,userStore:hs()}},methods:{async fetchUnreadCount(){try{const e=localStorage.getItem("accessToken"),t=await ge.A.get("api/chat/unread/",{headers:{Authorization:`Bearer ${e}`}});this.unreadMessages=t.data.unread_messages||[],this.userStore.unreadCount=this.unreadMessages.length}catch(e){}},formatTimestamp(e){try{const t=new Date(e);return t.toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e}}},mounted(){this.fetchUnreadCount(),this.intervalId=setInterval((()=>{this.fetchUnreadCount()}),3e4)},beforeUnmount(){this.intervalId&&clearInterval(this.intervalId)}};const js=(0,it.A)(Ds,[["render",Es],["__scopeId","data-v-0c6e4670"]]);var Ss=js,Fs={name:"Header",components:{Notifications:Ss},setup(){const e=hs(),t=(0,a.rd)(),s=(0,fe.KR)(!1),l=t=>{t.target.closest(".dropdown-menu")||t.target.closest(".avatar")||t.target.closest(".dropdown-icon")||(e.isDropdownOpen=!1)};t.beforeEach(((t,s,a)=>{e.isDropdownOpen=!1,a()}));const i=()=>{s.value=!s.value,s.value&&(e.isDropdownOpen=!1)},r=()=>{s.value=!1};(0,o.sV)((()=>{e.isDataLoaded||e.initialize(),document.addEventListener("click",l)})),(0,o.xo)((()=>{document.removeEventListener("click",l)}));const n=(0,o.EW)((()=>e.unreadCount&&e.unreadCount>0));return{userStore:e,router:t,showNotifications:s,toggleNotifications:i,closeNotifications:r,hasUnread:n}}};const Xs=(0,it.A)(Fs,[["render",ps],["__scopeId","data-v-410d9c3d"]]);var Is=Xs,Ps={name:"Wrapper",components:{Sidebar:Gt,Header:Is}};const Ms=(0,it.A)(Ps,[["render",vt],["__scopeId","data-v-1ea3f668"]]);var Ts=Ms,As=s.p+"img/category.38aa4348.svg";const Ns={class:"mobile-dashboard-layout"},xs={class:"mobile-header"},Us={class:"header-actions"},$s={key:0,class:"notification-badge"},Ks={class:"notifications-header"},Rs={class:"notifications-content"},Ws={key:0,class:"empty-notifications"},Qs={key:1,class:"notifications-list"},Bs={class:"notification-text"},Os={class:"notification-meta"},Vs={class:"timestamp"},zs={class:"chat-id"},qs={class:"mobile-main-content"},Js={key:0,class:"bottom-nav"},Gs={class:"nav-container"},Hs={class:"more-menu-header"},Ys={class:"more-menu-content"};function Zs(e,t,s,a,i,r){const n=(0,o.g2)("router-view"),c=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",Ns,[(0,o.Lk)("header",xs,[t[5]||(t[5]=(0,o.Lk)("h1",null,"PM",-1)),(0,o.Lk)("div",Us,[(0,o.Lk)("div",{class:"notification-icon",onClick:t[0]||(t[0]=(...e)=>a.toggleNotifications&&a.toggleNotifications(...e))},[t[4]||(t[4]=(0,o.Lk)("img",{src:Ht,alt:"Notifications"},null,-1)),a.hasUnreadNotifications?((0,o.uX)(),(0,o.CE)("span",$s)):(0,o.Q3)("",!0)])])]),(0,o.Lk)("div",{class:(0,l.C4)(["mobile-notifications",{"is-open":a.isNotificationsOpen}])},[(0,o.Lk)("div",Ks,[t[7]||(t[7]=(0,o.Lk)("h2",null,"Уведомления",-1)),(0,o.Lk)("button",{class:"close-btn",onClick:t[1]||(t[1]=(...e)=>a.toggleNotifications&&a.toggleNotifications(...e))},t[6]||(t[6]=[(0,o.Lk)("img",{src:Le,alt:"Close"},null,-1)]))]),(0,o.Lk)("div",Rs,[0===a.unreadMessages.length?((0,o.uX)(),(0,o.CE)("div",Ws,t[8]||(t[8]=[(0,o.Lk)("img",{src:Ht,alt:"No notifications"},null,-1),(0,o.Lk)("p",null,"Нет новых уведомлений",-1)]))):((0,o.uX)(),(0,o.CE)("div",Qs,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.unreadMessages,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:"notification-item"},[(0,o.Lk)("div",Bs,(0,l.v_)(e.message),1),(0,o.Lk)("div",Os,[(0,o.Lk)("span",Vs,(0,l.v_)(a.formatTimestamp(e.timestamp)),1),(0,o.Lk)("span",zs,"Чат #"+(0,l.v_)(e.chat_id),1)])])))),128))]))])],2),(0,o.Lk)("main",qs,[(0,o.bF)(n)]),a.isInChat?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("nav",Js,[(0,o.Lk)("div",Gs,[(0,o.bF)(c,{to:"/dashboard"},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.Lk)("img",{src:kt,alt:"Home"},null,-1),(0,o.Lk)("span",null,"Главная",-1)]))),_:1}),(0,o.bF)(c,{to:"/chats"},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.Lk)("img",{src:yt,alt:"Chats"},null,-1),(0,o.Lk)("span",null,"Чаты",-1)]))),_:1}),(0,o.bF)(c,{to:"/auction"},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.Lk)("img",{src:ft,alt:"Auction"},null,-1),(0,o.Lk)("span",null,"Аукцион",-1)]))),_:1}),(0,o.bF)(c,{to:"/profile"},{default:(0,o.k6)((()=>t[12]||(t[12]=[(0,o.Lk)("img",{src:Yt,alt:"Profile"},null,-1),(0,o.Lk)("span",null,"Профиль",-1)]))),_:1}),(0,o.Lk)("button",{class:"more-btn",onClick:t[2]||(t[2]=(...e)=>a.toggleMoreMenu&&a.toggleMoreMenu(...e))},t[13]||(t[13]=[(0,o.Lk)("img",{src:As,alt:"More"},null,-1),(0,o.Lk)("span",null,"Ещё",-1)]))])])),(0,o.Lk)("div",{class:(0,l.C4)(["more-menu",{"is-open":a.isMoreMenuOpen}])},[(0,o.Lk)("div",Hs,[t[15]||(t[15]=(0,o.Lk)("h2",null,"Меню",-1)),(0,o.Lk)("button",{class:"close-btn",onClick:t[3]||(t[3]=(...e)=>a.toggleMoreMenu&&a.toggleMoreMenu(...e))},t[14]||(t[14]=[(0,o.Lk)("img",{src:Le,alt:"Close"},null,-1)]))]),(0,o.Lk)("div",Ys,[a.isCreateProjectVisible?((0,o.uX)(),(0,o.Wv)(c,{key:0,to:"/projects",class:"more-menu-item",onClick:a.toggleMoreMenu},{default:(0,o.k6)((()=>t[16]||(t[16]=[(0,o.Lk)("img",{src:gt,alt:"Создать проект"},null,-1),(0,o.Lk)("span",null,"Создать проект",-1)]))),_:1},8,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(c,{to:"/finance",class:"more-menu-item",onClick:a.toggleMoreMenu},{default:(0,o.k6)((()=>t[17]||(t[17]=[(0,o.Lk)("img",{src:Lt,alt:"Финансы"},null,-1),(0,o.Lk)("span",null,"Финансы",-1)]))),_:1},8,["onClick"]),(0,o.bF)(c,{to:"/investments",class:"more-menu-item",onClick:a.toggleMoreMenu},{default:(0,o.k6)((()=>t[18]||(t[18]=[(0,o.Lk)("img",{src:bt,alt:"Вложения"},null,-1),(0,o.Lk)("span",null,"Вложения",-1)]))),_:1},8,["onClick"]),(0,o.bF)(c,{to:"/calendar",class:"more-menu-item",onClick:a.toggleMoreMenu},{default:(0,o.k6)((()=>t[19]||(t[19]=[(0,o.Lk)("img",{src:Ct,alt:"Календарь"},null,-1),(0,o.Lk)("span",null,"Календарь",-1)]))),_:1},8,["onClick"]),(0,o.bF)(c,{to:"/news",class:"more-menu-item",onClick:a.toggleMoreMenu},{default:(0,o.k6)((()=>t[20]||(t[20]=[(0,o.Lk)("img",{src:wt,alt:"Новости"},null,-1),(0,o.Lk)("span",null,"Новости",-1)]))),_:1},8,["onClick"]),(0,o.bF)(c,{to:"/documents",class:"more-menu-item",onClick:a.toggleMoreMenu},{default:(0,o.k6)((()=>t[21]||(t[21]=[(0,o.Lk)("img",{src:Et,alt:"Нормативные документы"},null,-1),(0,o.Lk)("span",null,"Нормативные акты",-1)]))),_:1},8,["onClick"])])],2)])}var ea=s(7666);const ta={async fetchChats(e){const t=await fetch("api/chat/chats/",{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Ошибка при получении чатов: ${t.status}`);return t.json()},async fetchChatHistory(e,t,s=1){if(!t)return null;const a=await fetch(`api/chat/chats/${t}/messages/?page=${s}`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error(`Ошибка при получении истории чата: ${a.status}`);return a.json()},async fetchChatParticipants(e,t){const s=await fetch(`api/chat/chats/${t}/participants/`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json",Accept:"application/json"}});return s.ok?s.json():null}},sa=(0,Vt.nY)("chat",{state:()=>({selectedTab:"contacts",searchQuery:"",chatsList:[],filteredChats:[],accessToken:null,selectedChat:null,message:"",messages:{},currentUserId:null,websocket:null,currentChatId:null,currentPage:1,hasMoreMessages:!0,picker:null,emojiButtonRef:null,chatParticipants:{}}),getters:{getMessagesForCurrentChat(e){return e.selectedChat&&e.messages[e.selectedChat.id]?e.messages[e.selectedChat.id]:[]},privateChats(){return this.filteredChatsComputed.filter((e=>"private"===e.chat_type))},groupChats(){return this.filteredChatsComputed.filter((e=>"group"===e.chat_type))},filteredChatsComputed(e){const t=e.searchQuery.toLowerCase().trim();return t?e.chatsList.filter((e=>{const s=e?.participants?.[0]?.user?.company_name?.toLowerCase()||"",a=e?.position?.toLowerCase()||"";return s.includes(t)||a.includes(t)})):e.chatsList},getCompanyName:()=>e=>"group"===e.chat_type?e.name||"Без названия":e?.participants?.[0]?.user?.company_name||"Без названия"},actions:{async fetchChats(){try{const e=await ta.fetchChats(this.accessToken);this.chatsList=e,this.filteredChats=e}catch(e){console.error("Ошибка fetchChats:",e)}},async connectToChat(e){if(this.selectedChat&&this.selectedChat.id===e.id)return;this.messages[e.id]=[],this.selectedChat=e,this.currentChatId=e.id,this.currentPage=1,this.hasMoreMessages=!0,await this.loadChatHistory(e.id),(0,o.dY)((()=>{const e=document.querySelector(".messages");this.scrollToBottom(e)}));const t=`ws/chat/${e.id}/?token=${this.accessToken}`,s=()=>{setTimeout((()=>{this.currentChatId===e.id&&a()}),5e3)},a=()=>{try{this.websocket=new WebSocket(t),this.websocket.onopen=()=>{},this.websocket.onmessage=t=>{try{const s=JSON.parse(t.data);if(this.currentChatId===e.id){this.messages[this.currentChatId]||(this.messages[this.currentChatId]=[]);const e=this.messages[this.currentChatId].some((e=>e.created_at===s.created_at&&e.message===s.message));if(!e){const e={id:s.id||`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,message:s.message,sender_id:s.sender_id,created_at:s.created_at,is_own:s.is_own,status:s.status};this.messages[this.currentChatId].push(e)}}}catch(s){}},this.websocket.onerror=e=>{s()},this.websocket.onclose=t=>{this.currentChatId!==e.id||t.wasClean||s()}}catch(a){s()}};a(),"group"===e.chat_type&&await this.loadChatParticipants(e.id)},sendMessage(){this.message.trim()&&this.websocket&&(this.websocket.send(JSON.stringify({type:"chat_message",message:this.message,chat_id:this.selectedChat.id,chat_type:this.selectedChat.chat_type})),this.message="")},async loadChatHistory(e,t=1){try{const s=await ta.fetchChatHistory(this.accessToken,e,t);if(!s||!s.results)return;this.messages[e]||(this.messages[e]=[]);const a=s.results.map(((e,t)=>({id:e.id||`msg-${t}-${Date.now()}`,message:e.message,sender_id:e.sender_id,created_at:e.created_at,is_own:e.is_own??String(e.sender_id)===this.currentUserId,status:e.status}))),o=a.reverse();this.messages[e]=1===t?o:[...o,...this.messages[e]],this.currentPage=t,this.hasMoreMessages=s.results.length>=50}catch(s){console.error("Ошибка при загрузке истории чата:",s)}},handleScroll(){this.hasMoreMessages&&this.selectedChat&&(this.currentPage+=1,this.loadChatHistory(this.currentChatId,this.currentPage))},formatTime(e){if(!e)return"";const t=new Date(e);return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},formatDateHeader(e){const t=new Date(e),s=new Date,a=new Date(s);return a.setDate(a.getDate()-1),t.toDateString()===s.toDateString()?"Сегодня":t.toDateString()===a.toDateString()?"Вчера":t.toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})},groupMessagesByDate(e){const t={};return e.forEach((e=>{const s=new Date(e.timestamp||e.created_at).toDateString();t[s]||(t[s]=[]),t[s].push(e)})),Object.entries(t).map((([e,t])=>({date:new Date(e),messages:t})))},initEmojiPicker(){this.picker=new ea.h({position:"top-start",theme:"light",autoHide:!1,emojisPerRow:8,rows:6,showPreview:!1,showSearch:!0,showCategoryButtons:!0,i18n:{search:"Поиск",categories:{recents:"Недавние",smileys:"Смайлики",people:"Люди",animals:"Животные",food:"Еда",activities:"Активности",travel:"Путешествия",objects:"Объекты",symbols:"Символы",flags:"Флаги"},notFound:"Эмодзи не найдены"}}),this.picker.on("emoji",(e=>{this.message+=e.emoji}))},toggleEmojiPicker(){this.picker&&this.emojiButtonRef&&this.picker.togglePicker(this.emojiButtonRef)},setAccessToken(e){this.accessToken=e},setCurrentUserId(e){this.currentUserId=String(e)},scrollToBottom(e){e&&(e.scrollTop=e.scrollHeight)},searchMessages(e){if(!e.trim()||!this.selectedChat||!this.messages[this.selectedChat.id])return[];const t=this.messages[this.selectedChat.id];return t.filter((t=>t.message?.toLowerCase().includes(e.toLowerCase()))).map(((e,t)=>({id:e.id||`msg-${t}-${Date.now()}`,message:e.message,timestamp:e.timestamp||e.created_at,created_at:e.created_at,sender_id:e.sender_id,is_own:e.is_own})))},getMessageById(e){return this.selectedChat&&this.messages[this.selectedChat.id]?this.messages[this.selectedChat.id].find((t=>String(t.id)===String(e))):null},async loadChatParticipants(e){try{const t=await ta.fetchChatParticipants(this.accessToken,e);if(!t||t.error)this.chatParticipants[e]=this.selectedChat.participants;else{const s=Array.isArray(t)?t:t.participants||[];this.chatParticipants[e]=s}}catch(t){this.chatParticipants[e]=this.selectedChat.participants}},getSenderName(e){if(!this.selectedChat)return"Неизвестный пользователь";if(this.chatParticipants[this.selectedChat.id]){const t=this.chatParticipants[this.selectedChat.id].find((t=>String(t.user.user_id)===String(e)));if(t){const e=t.user;return"physical"===e.profile_type?`${e.first_name} ${e.last_name}`:e.company_name||"Компания"}}const t=this.selectedChat.participants.find((t=>String(t.user.user_id)===String(e)));if(t){const e=t.user;return"physical"===e.profile_type?`${e.first_name} ${e.last_name}`:e.company_name||"Компания"}return"Неизвестный пользователь"}}});var aa={name:"MobileWrapper",setup(){const e=(0,a.lq)(),t=sa(),s=(0,fe.KR)(!1),l=(0,fe.KR)([]),i=hs(),r=(0,fe.KR)(!1);let n=null;const c=(0,fe.KR)(!1),d=zt(),u=(0,o.EW)((()=>!0===d.profileData?.physical_profile?.is_gip)),p=()=>{s.value=!s.value,s.value?document.body.style.overflow="hidden":document.body.style.overflow=""},h=e=>new Date(e).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),m=async()=>{try{const e=localStorage.getItem("accessToken"),t=await ge.A.get("api/chat/unread/",{headers:{Authorization:`Bearer ${e}`}});l.value=t.data.unread_messages||[],r.value=l.value.length>0}catch(e){console.error("Error fetching notifications:",e)}},v=()=>{c.value=!c.value,c.value?document.body.style.overflow="hidden":document.body.style.overflow=""};(0,o.sV)((async()=>{m(),n=setInterval(m,3e4);const e=localStorage.getItem("accessToken");e&&(d.accessToken=e,d.setupAxios(),await d.fetchUserProfile())})),(0,o.xo)((()=>{n&&clearInterval(n),document.body.style.overflow=""}));const k=(0,o.EW)((()=>"/chats"===e.path&&null!==t.selectedChat));return{isNotificationsOpen:s,unreadMessages:l,hasUnreadNotifications:r,toggleNotifications:p,formatTimestamp:h,userStore:i,isInChat:k,isMoreMenuOpen:c,toggleMoreMenu:v,isCreateProjectVisible:u}}};const oa=(0,it.A)(aa,[["render",Zs],["__scopeId","data-v-9470f2b2"]]);var la=oa;const ia={class:"main-page"};function ra(e,t,s,a,l,i){const r=(0,o.g2)("MobileChats"),n=(0,o.g2)("Chats",!0);return(0,o.uX)(),(0,o.CE)("div",ia,[a.isMobile?((0,o.uX)(),(0,o.Wv)(r,{key:0})):((0,o.uX)(),(0,o.Wv)(n,{key:1}))])}var na=s(5537),ca=s.p+"img/calling.b97ec994.svg",da=s.p+"img/filter.d17ed2ce.svg",ua=s.p+"img/smile.59ff2cd4.svg",pa=s.p+"img/vector.44127458.svg";const ha={class:"container"},ma={class:"chats-page"},va={class:"chat-container"},ka={class:"chat-main"},ga={key:0,class:"chat-header"},fa={class:"chat-info"},ya=["src"],La={class:"chat-header-text"},ba={class:"chat-name"},Ca={class:"chat-meta"},_a={class:"header-actions"},wa={key:0,class:"search-input-wrapper"},Ea={key:0,class:"search-results"},Da={class:"results-count"},ja={key:0,class:"results-list"},Sa=["onClick"],Fa={key:1,class:"no-results"},Xa={class:"chat-actions"},Ia=["src","alt"],Pa={key:1,class:"messages",ref:"messagesContainer"},Ma={class:"date-header"},Ta=["id"],Aa={class:"message-bubble"},Na={key:0,class:"sender-name"},xa={class:"debug-info",style:{display:"none"}},Ua={class:"message-content"},$a={key:2,class:"message-input-container"},Ka={class:"message-input-wrapper"},Ra={class:"emoji-container",ref:"emojiButton"},Wa=["src","alt"],Qa={class:"chat-sidebar"},Ba={class:"sidebar-header"},Oa={class:"tabs"},Va={class:"chat-list"},za={key:0},qa=["onClick"],Ja={class:"chat-info"},Ga=["src"],Ha={class:"chat-text"},Ya={key:0},Za={class:"message-time"},eo={key:1},to={key:0,class:"unread-count"},so={key:1},ao=["onClick"],oo={class:"chat-info"},lo=["src"],io={class:"chat-text"},ro={class:"participants-count"},no={key:0},co={class:"message-time"},uo={key:1},po={key:0,class:"unread-count"};function ho(e,t,a,r,n,c){return(0,o.uX)(),(0,o.CE)("div",ha,[(0,o.Lk)("div",ma,[(0,o.Lk)("div",va,[(0,o.Lk)("div",ka,[r.chatStore.selectedChat?((0,o.uX)(),(0,o.CE)("div",ga,[(0,o.Lk)("div",fa,[(0,o.Lk)("img",{src:r.chatStore.selectedChat?.companion?.photo||r.chatStore.selectedChat?.participants[0]?.user?.photo||s(4211),alt:"Chat Photo",class:"chat-avatar"},null,8,ya),(0,o.Lk)("div",La,[(0,o.Lk)("h4",ba,(0,l.v_)(r.participantName),1),(0,o.Lk)("p",Ca,(0,l.v_)(r.chatStore.selectedChat.participants[0].user.email),1)])]),(0,o.Lk)("div",_a,[r.isSearchOpen?((0,o.uX)(),(0,o.CE)("div",wa,[t[9]||(t[9]=(0,o.Lk)("img",{src:na,alt:"Search",class:"search-icon"},null,-1)),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e),placeholder:"Поиск сообщений...",class:"search-input",onInput:t[1]||(t[1]=(...e)=>r.handleSearch&&r.handleSearch(...e)),ref:"searchInput"},null,544),[[i.Jo,r.searchQuery]]),r.isSearchOpen&&r.searchQuery?((0,o.uX)(),(0,o.CE)("div",Ea,[(0,o.Lk)("div",Da," Найдено результатов: "+(0,l.v_)(r.filteredMessages.length),1),r.filteredMessages.length?((0,o.uX)(),(0,o.CE)("div",ja,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.filteredMessages,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"search-result-item",onClick:t=>r.scrollToMessage(e.id)},[(0,o.Lk)("p",null,(0,l.v_)(e.message),1),(0,o.Lk)("small",null,(0,l.v_)(r.chatStore.formatTime(e.timestamp||e.created_at)),1)],8,Sa)))),128))])):((0,o.uX)(),(0,o.CE)("div",Fa,"Сообщений не найдено"))])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0),(0,o.Lk)("div",Xa,[(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.toggleSearch&&r.toggleSearch(...e)),class:(0,l.C4)({active:r.isSearchOpen})},[(0,o.Lk)("img",{src:r.isSearchOpen?s(1131):s(5537),alt:r.isSearchOpen?"Close":"Search"},null,8,Ia)],2),t[10]||(t[10]=(0,o.Lk)("button",null,[(0,o.Lk)("img",{src:ca,alt:"Call"})],-1)),t[11]||(t[11]=(0,o.Lk)("button",null,[(0,o.Lk)("img",{src:da,alt:"More"})],-1))])])])):(0,o.Q3)("",!0),r.chatStore.selectedChat?((0,o.uX)(),(0,o.CE)("div",Pa,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.chatStore.groupMessagesByDate(r.chatStore.getMessagesForCurrentChat),(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.date},[(0,o.Lk)("div",Ma,(0,l.v_)(r.chatStore.formatDateHeader(e.date)),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.messages,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,id:"message-"+e.id,class:(0,l.C4)({"message-wrapper":!0,"my-message":e.is_own,"their-message":!e.is_own})},[(0,o.Lk)("div",Aa,["group"!==r.chatStore.selectedChat?.chat_type||e.is_own?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Na,[(0,o.Lk)("span",xa," SenderID: "+(0,l.v_)(e.sender_id),1),(0,o.eW)(" "+(0,l.v_)(r.chatStore.getSenderName(e.sender_id||e.sender)),1)])),(0,o.Lk)("div",Ua,[(0,o.Lk)("p",null,(0,l.v_)(e.message),1),(0,o.Lk)("small",null,(0,l.v_)(r.chatStore.formatTime(e.timestamp||e.created_at)),1)])])],10,Ta)))),128))])))),128))],512)):(0,o.Q3)("",!0),r.chatStore.selectedChat?((0,o.uX)(),(0,o.CE)("div",$a,[(0,o.Lk)("div",Ka,[(0,o.Lk)("div",Ra,[(0,o.Lk)("img",{src:ua,alt:"Emoji",class:"input-icon",onClick:t[3]||(t[3]=(...e)=>r.toggleEmojiPicker&&r.toggleEmojiPicker(...e))})],512),(0,o.bo)((0,o.Lk)("input",{type:"text",placeholder:"Введите сообщение","onUpdate:modelValue":t[4]||(t[4]=e=>r.chatStore.message=e),onKeyup:t[5]||(t[5]=(0,i.jR)(((...e)=>r.chatStore.sendMessage&&r.chatStore.sendMessage(...e)),["enter"])),class:"styled-input"},null,544),[[i.Jo,r.chatStore.message]]),t[12]||(t[12]=(0,o.Lk)("img",{src:pa,alt:"Attachment",class:"input-icon"},null,-1))]),(0,o.Lk)("button",{class:"send-button",onClick:t[6]||(t[6]=(...e)=>r.chatStore.sendMessage&&r.chatStore.sendMessage(...e))},[(0,o.Lk)("img",{src:r.chatStore.message?s(3863):s(5325),alt:r.chatStore.message?"Send":"Voice"},null,8,Wa)])])):(0,o.Q3)("",!0)]),(0,o.Lk)("aside",Qa,[(0,o.Lk)("div",Ba,[(0,o.Lk)("div",Oa,[(0,o.Lk)("button",{class:(0,l.C4)({active:"contacts"===r.chatStore.selectedTab}),onClick:t[7]||(t[7]=e=>r.chatStore.selectedTab="contacts")}," Чаты ",2),(0,o.Lk)("button",{class:(0,l.C4)({active:"groups"===r.chatStore.selectedTab}),onClick:t[8]||(t[8]=e=>r.chatStore.selectedTab="groups")}," Группы ",2)])]),(0,o.Lk)("div",Va,["contacts"===r.chatStore.selectedTab?((0,o.uX)(),(0,o.CE)("div",za,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.chatStore.privateChats,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,l.C4)(["chat-item",{active:r.chatStore.selectedChat&&r.chatStore.selectedChat.id===e.id}]),key:e.id,onClick:t=>r.chatStore.connectToChat(e)},[(0,o.Lk)("div",Ja,[(0,o.Lk)("img",{src:e.companion?.photo||e.participants[0]?.user?.photo||s(4211),alt:"Chat Photo",class:"chat-avatar"},null,8,Ga),(0,o.Lk)("div",Ha,[(0,o.Lk)("h4",null,(0,l.v_)(r.sidebarParticipantName[t]),1),e.last_message?((0,o.uX)(),(0,o.CE)("p",Ya,[(0,o.eW)((0,l.v_)(e.last_message.content)+" ",1),(0,o.Lk)("span",Za,(0,l.v_)(r.chatStore.formatTime(e.last_message.created_at)),1)])):((0,o.uX)(),(0,o.CE)("p",eo,"Нет сообщений"))])]),e.unread?((0,o.uX)(),(0,o.CE)("span",to,(0,l.v_)(e.unread),1)):(0,o.Q3)("",!0)],10,qa)))),128))])):(0,o.Q3)("",!0),"groups"===r.chatStore.selectedTab?((0,o.uX)(),(0,o.CE)("div",so,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.chatStore.groupChats,(e=>((0,o.uX)(),(0,o.CE)("div",{class:(0,l.C4)(["chat-item",{active:r.chatStore.selectedChat&&r.chatStore.selectedChat.id===e.id}]),key:e.id,onClick:t=>r.chatStore.connectToChat(e)},[(0,o.Lk)("div",oo,[(0,o.Lk)("img",{src:e.photo||s(4211),alt:"Group Photo",class:"chat-avatar"},null,8,lo),(0,o.Lk)("div",io,[(0,o.Lk)("h4",null,(0,l.v_)(e.name),1),(0,o.Lk)("p",ro,(0,l.v_)(e.participants?.length||0)+" участников ",1),e.last_message?((0,o.uX)(),(0,o.CE)("p",no,[(0,o.eW)((0,l.v_)(e.last_message.content)+" ",1),(0,o.Lk)("span",co,(0,l.v_)(r.chatStore.formatTime(e.last_message.created_at)),1)])):((0,o.uX)(),(0,o.CE)("p",uo,"Нет сообщений"))])]),e.unread?((0,o.uX)(),(0,o.CE)("span",po,(0,l.v_)(e.unread),1)):(0,o.Q3)("",!0)],10,ao)))),128))])):(0,o.Q3)("",!0)])])])])])}var mo={setup(){const e=sa(),t=(0,fe.KR)(null),s=(0,fe.KR)(null),a=(0,fe.KR)(!1),l=(0,fe.KR)(""),i=(0,fe.KR)([]),r=(0,fe.KR)(null),n=(0,o.EW)((()=>e.selectedChat?"group"===e.selectedChat.chat_type?e.selectedChat.name:e.selectedChat.companion?e.selectedChat.companion.full_name:"physical"===e.selectedChat.participants[0].user.profile_type?`${e.selectedChat.participants[0].user.first_name} ${e.selectedChat.participants[0].user.last_name}`:e.selectedChat.participants[0].user.company_name:"")),c=(0,o.EW)((()=>e.privateChats.map((e=>e.companion?e.companion.full_name:"physical"===e.participants[0].user.profile_type?`${e.participants[0].user.first_name} ${e.participants[0].user.last_name}`:e.participants[0].user.company_name)))),d=()=>{e.picker||e.initEmojiPicker(),e.emojiButtonRef=document.querySelector(".emoji-container"),e.toggleEmojiPicker()},u=()=>{a.value=!a.value,a.value?(0,o.dY)((()=>{r.value?.focus()})):(l.value="",i.value=[])},p=()=>{a.value=!1,l.value="",i.value=[]},h=()=>{l.value.trim()?i.value=e.searchMessages(l.value):i.value=[]},m=t=>{const s=e.getMessageById(t);if(!s)return;const a=document.getElementById(`message-${t}`);if(a){const e=document.querySelector(".message-bubble.highlighted");e&&e.classList.remove("highlighted"),p(),a.scrollIntoView({behavior:"smooth",block:"center"});const t=a.querySelector(".message-bubble");t&&(t.classList.add("highlighted"),setTimeout((()=>{t.classList.remove("highlighted")}),2e3))}};return(0,o.sV)((()=>{const s=localStorage.getItem("accessToken");if(s){e.setAccessToken(s);const t=localStorage.getItem("userId");e.setCurrentUserId(t),e.fetchChats()}t.value&&t.value.addEventListener("scroll",e.handleScroll)})),(0,o.xo)((()=>{s.value&&s.value.destroy()})),{chatStore:e,messagesContainer:t,toggleEmojiPicker:d,participantName:n,sidebarParticipantName:c,isSearchOpen:a,searchQuery:l,filteredMessages:i,toggleSearch:u,closeSearch:p,handleSearch:h,scrollToMessage:m,searchInput:r}}};const vo=(0,it.A)(mo,[["render",ho],["__scopeId","data-v-28464851"]]);var ko=vo;const go={class:"mobile-chats"},fo={key:0,class:"chats-list"},yo={class:"tabs"},Lo={key:0,class:"chat-items"},bo=["onClick"],Co={class:"chat-info"},_o=["src"],wo={class:"chat-text"},Eo={key:0},Do={class:"message-time"},jo={key:1},So={key:0,class:"unread-count"},Fo={key:1,class:"chat-items"},Xo=["onClick"],Io={class:"chat-info"},Po=["src"],Mo={class:"chat-text"},To={class:"participants-count"},Ao={key:0},No={class:"message-time"},xo={key:1},Uo={key:0,class:"unread-count"},$o={key:1,class:"chat-view"},Ko={class:"chat-header"},Ro={class:"chat-info"},Wo=["src"],Qo={class:"chat-header-text"},Bo={key:0},Oo={class:"messages",ref:"messagesContainer"},Vo={class:"date-header"},zo={class:"message-bubble"},qo={key:0,class:"sender-name"},Jo={class:"message-content"},Go={class:"message-time"},Ho={class:"message-input-container"},Yo={class:"message-input-wrapper"},Zo={class:"emoji-container",ref:"emojiButton"},el=["src","alt"];function tl(e,t,a,r,n,c){return(0,o.uX)(),(0,o.CE)("div",go,[r.chatStore.selectedChat?((0,o.uX)(),(0,o.CE)("div",$o,[(0,o.Lk)("div",Ko,[(0,o.Lk)("button",{class:"back-button",onClick:t[2]||(t[2]=(...e)=>r.closeChat&&r.closeChat(...e))},t[7]||(t[7]=[(0,o.Lk)("img",{src:ye,alt:"Back"},null,-1)])),(0,o.Lk)("div",Ro,[(0,o.Lk)("img",{src:r.getCurrentChatPhoto,alt:"Chat Photo",class:"chat-avatar"},null,8,Wo),(0,o.Lk)("div",Qo,[(0,o.Lk)("h4",null,(0,l.v_)(r.getCurrentChatName),1),r.isGroupChat?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("p",Bo,(0,l.v_)(r.getCurrentChatEmail),1))])])]),(0,o.Lk)("div",Oo,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.chatStore.groupMessagesByDate(r.chatStore.getMessagesForCurrentChat),(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.date},[(0,o.Lk)("div",Vo,(0,l.v_)(r.chatStore.formatDateHeader(e.date)),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.messages,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,l.C4)({"message-wrapper":!0,"my-message":e.is_own,"their-message":!e.is_own})},[(0,o.Lk)("div",zo,[r.isGroupChat&&!e.is_own?((0,o.uX)(),(0,o.CE)("div",qo,(0,l.v_)(r.chatStore.getSenderName(e.sender_id||e.sender)),1)):(0,o.Q3)("",!0),(0,o.Lk)("div",Jo,[(0,o.Lk)("p",null,(0,l.v_)(e.message),1),(0,o.Lk)("span",Go,(0,l.v_)(r.chatStore.formatTime(e.timestamp||e.created_at)),1)])])],2)))),128))])))),128))],512),(0,o.Lk)("div",Ho,[(0,o.Lk)("div",Yo,[(0,o.Lk)("div",Zo,[(0,o.Lk)("img",{src:ua,alt:"Emoji",onClick:t[3]||(t[3]=(...e)=>r.toggleEmojiPicker&&r.toggleEmojiPicker(...e))})],512),(0,o.bo)((0,o.Lk)("input",{type:"text",placeholder:"Введите сообщение","onUpdate:modelValue":t[4]||(t[4]=e=>r.chatStore.message=e),onKeyup:t[5]||(t[5]=(0,i.jR)(((...e)=>r.chatStore.sendMessage&&r.chatStore.sendMessage(...e)),["enter"]))},null,544),[[i.Jo,r.chatStore.message]]),t[8]||(t[8]=(0,o.Lk)("img",{src:pa,alt:"Attachment"},null,-1))]),(0,o.Lk)("button",{class:"send-button",onClick:t[6]||(t[6]=(...e)=>r.chatStore.sendMessage&&r.chatStore.sendMessage(...e))},[(0,o.Lk)("img",{src:r.chatStore.message?s(3863):s(5325),alt:r.chatStore.message?"Send":"Voice"},null,8,el)])])])):((0,o.uX)(),(0,o.CE)("div",fo,[(0,o.Lk)("div",yo,[(0,o.Lk)("button",{class:(0,l.C4)({active:"contacts"===r.chatStore.selectedTab}),onClick:t[0]||(t[0]=e=>r.chatStore.selectedTab="contacts")}," Чаты ",2),(0,o.Lk)("button",{class:(0,l.C4)({active:"groups"===r.chatStore.selectedTab}),onClick:t[1]||(t[1]=e=>r.chatStore.selectedTab="groups")}," Группы ",2)]),"contacts"===r.chatStore.selectedTab?((0,o.uX)(),(0,o.CE)("div",Lo,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.chatStore.privateChats,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"chat-item",onClick:t=>r.selectChat(e)},[(0,o.Lk)("div",Co,[(0,o.Lk)("img",{src:e.companion?.photo||e.participants[0]?.user?.photo||s(4211),alt:"Chat Photo",class:"chat-avatar"},null,8,_o),(0,o.Lk)("div",wo,[(0,o.Lk)("h4",null,(0,l.v_)(r.getParticipantName(e)),1),e.last_message?((0,o.uX)(),(0,o.CE)("p",Eo,[(0,o.eW)((0,l.v_)(e.last_message.content)+" ",1),(0,o.Lk)("span",Do,(0,l.v_)(r.chatStore.formatTime(e.last_message.created_at)),1)])):((0,o.uX)(),(0,o.CE)("p",jo,"Нет сообщений"))])]),e.unread?((0,o.uX)(),(0,o.CE)("span",So,(0,l.v_)(e.unread),1)):(0,o.Q3)("",!0)],8,bo)))),128))])):((0,o.uX)(),(0,o.CE)("div",Fo,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.chatStore.groupChats,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"chat-item",onClick:t=>r.selectChat(e)},[(0,o.Lk)("div",Io,[(0,o.Lk)("img",{src:e.photo||s(4211),alt:"Group Photo",class:"chat-avatar"},null,8,Po),(0,o.Lk)("div",Mo,[(0,o.Lk)("h4",null,(0,l.v_)(e.name),1),(0,o.Lk)("p",To,(0,l.v_)(e.participants?.length||0)+" участников ",1),e.last_message?((0,o.uX)(),(0,o.CE)("p",Ao,[(0,o.eW)((0,l.v_)(e.last_message.content)+" ",1),(0,o.Lk)("span",No,(0,l.v_)(r.chatStore.formatTime(e.last_message.created_at)),1)])):((0,o.uX)(),(0,o.CE)("p",xo,"Нет сообщений"))])]),e.unread?((0,o.uX)(),(0,o.CE)("span",Uo,(0,l.v_)(e.unread),1)):(0,o.Q3)("",!0)],8,Xo)))),128))]))]))])}var sl={name:"MobileChats",setup(){const e=sa(),t=(0,fe.KR)(null);(0,o.sV)((()=>{window.scrollTo(0,0);const t=localStorage.getItem("accessToken");if(t){e.setAccessToken(t);const s=localStorage.getItem("userId");e.setCurrentUserId(s),e.fetchChats()}}));const a=(0,o.EW)((()=>e.selectedChat?"group"===e.selectedChat.chat_type?e.selectedChat.photo||s(4211):e.selectedChat.companion?.photo||e.selectedChat.participants[0]?.user?.photo||s(4211):s(4211))),l=(0,o.EW)((()=>e.selectedChat?"group"===e.selectedChat.chat_type?e.selectedChat.name:n(e.selectedChat):"")),i=(0,o.EW)((()=>e.selectedChat&&"group"!==e.selectedChat.chat_type?e.selectedChat.participants[0].user.email:"")),r=(0,o.EW)((()=>"group"===e.selectedChat?.chat_type)),n=e=>e.companion?e.companion.full_name:"physical"===e.participants[0].user.profile_type?`${e.participants[0].user.first_name} ${e.participants[0].user.last_name}`:e.participants[0].user.company_name,c=t=>{e.connectToChat(t),window.scrollTo(0,0)},d=()=>{e.selectedChat=null},u=()=>{e.picker||e.initEmojiPicker(),e.emojiButtonRef=document.querySelector(".emoji-container"),e.toggleEmojiPicker()};return{chatStore:e,messagesContainer:t,getCurrentChatPhoto:a,getCurrentChatName:l,getCurrentChatEmail:i,isGroupChat:r,getParticipantName:n,selectChat:c,closeChat:d,toggleEmojiPicker:u}}};const al=(0,it.A)(sl,[["render",tl],["__scopeId","data-v-069e1e61"]]);var ol=al,ll={components:{Chats:ko,MobileChats:ol},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}}};const il=(0,it.A)(ll,[["render",ra],["__scopeId","data-v-630ea899"]]);var rl=il;const nl={key:1,class:"main-page"};function cl(e,t,s,a,l,i){const r=(0,o.g2)("MobileAuction"),n=(0,o.g2)("ContentAuction");return(0,o.uX)(),(0,o.CE)("div",null,[a.isMobile?((0,o.uX)(),(0,o.Wv)(r,{key:0})):((0,o.uX)(),(0,o.CE)("div",nl,[t[0]||(t[0]=(0,o.Lk)("h2",null,"Аукцион",-1)),(0,o.bF)(n)]))])}const dl={class:"content-auction"},ul={key:0,class:"projects-list"},pl={class:"header"},hl={class:"title-section"},ml={class:"project-title"},vl={class:"project-subtitle"},kl={class:"category"},gl={class:"meta-info"},fl={class:"info-item"},yl={class:"info-item"},Ll={class:"client"},bl={class:"content-section"},Cl={class:"description"},_l={class:"proposal"},wl={class:"budget-section"},El={class:"specialty-budgets"},Dl={class:"specialty-name"},jl={class:"budget"},Sl={class:"position-section"},Fl={class:"position"},Xl=["onClick"],Il={class:"footer"},Pl={key:1,class:"no-projects"},Ml={key:0,class:"modal-overlay"},Tl={class:"modal-content"},Al={class:"modal-title"},Nl={class:"modal-body"},xl={key:0,class:"confirmation-message"},Ul={key:1,class:"error-container"},$l={class:"error-message"},Kl={class:"modal-buttons"},Rl=["disabled"],Wl={key:0,class:"fas fa-spinner fa-spin"},Ql={key:1,class:"fas fa-check"};function Bl(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",dl,[n.allProjects&&n.allProjects.length>0?((0,o.uX)(),(0,o.CE)("div",ul,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.allProjects,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.uuid,class:"project-container"},[(0,o.Lk)("div",pl,[(0,o.Lk)("div",hl,[(0,o.Lk)("h1",ml,(0,l.v_)(e.name),1),(0,o.Lk)("span",vl,(0,l.v_)(e.subtitle),1),(0,o.Lk)("span",kl,(0,l.v_)(e.complexity.name),1)]),(0,o.Lk)("div",gl,[(0,o.Lk)("div",fl,[t[2]||(t[2]=(0,o.Lk)("i",{class:"icon-clock"},null,-1)),(0,o.Lk)("span",null,"Срок: "+(0,l.v_)(e.estimated_duration)+" мес.",1)]),(0,o.Lk)("div",yl,[(0,o.Lk)("span",Ll,"Организация: "+(0,l.v_)(e.client_name),1)])])]),(0,o.Lk)("div",bl,[(0,o.Lk)("div",Cl,[t[3]||(t[3]=(0,o.Lk)("h3",null,"Описание проекта",-1)),(0,o.Lk)("p",null,(0,l.v_)(e.description),1)]),(0,o.Lk)("div",_l,[(0,o.Lk)("div",wl,[t[4]||(t[4]=(0,o.Lk)("h3",null,"Бюджет",-1)),(0,o.Lk)("div",El,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.filteredBudgets(e.specialty_budgets),(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.specialty,class:"specialty-budget"},[(0,o.Lk)("span",Dl,(0,l.v_)(n.getSpecialtyName(e.specialty))+": ",1),(0,o.Lk)("span",jl,(0,l.v_)(n.formatBudget(e.budget))+" тг.",1)])))),128))])]),(0,o.Lk)("div",Sl,[t[5]||(t[5]=(0,o.Lk)("h3",null,"Должность",-1)),(0,o.Lk)("span",Fl,(0,l.v_)(n.getCurrentSpecialty),1)]),(0,o.Lk)("button",{class:"btn-submit",onClick:(0,i.D$)((t=>n.selectProject(e.uuid)),["stop"])}," Оставить заявку ",8,Xl)])]),(0,o.Lk)("div",Il,[(0,o.Lk)("span",null,"Опубликовано: "+(0,l.v_)(n.formatDate(e.created_at)),1)])])))),128))])):((0,o.uX)(),(0,o.CE)("div",Pl," Нет доступных проектов на аукционе по вашей специальности "))]),t[9]||(t[9]=(0,o.Lk)("div",{class:"buttons"},null,-1)),r.showModal?((0,o.uX)(),(0,o.CE)("div",Ml,[(0,o.Lk)("div",Tl,[(0,o.Lk)("h3",Al,(0,l.v_)(r.errorMessage?"Ошибка":"Подтверждение заявки"),1),(0,o.Lk)("div",Nl,[r.errorMessage?((0,o.uX)(),(0,o.CE)("div",Ul,[t[7]||(t[7]=(0,o.Lk)("i",{class:"fas fa-exclamation-circle error-icon"},null,-1)),(0,o.Lk)("p",$l,(0,l.v_)(r.errorMessage),1)])):((0,o.uX)(),(0,o.CE)("div",xl,t[6]||(t[6]=[(0,o.Lk)("i",{class:"fas fa-question-circle message-icon"},null,-1),(0,o.Lk)("p",null,"Вы уверены, что хотите оставить заявку на этот проект?",-1)])))]),(0,o.Lk)("div",Kl,[r.errorMessage?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:0,class:"btn-confirm",onClick:t[0]||(t[0]=(...e)=>n.submitResponse&&n.submitResponse(...e)),disabled:r.isLoading},[r.isLoading?((0,o.uX)(),(0,o.CE)("i",Wl)):((0,o.uX)(),(0,o.CE)("i",Ql)),(0,o.eW)(" "+(0,l.v_)(r.isLoading?"Отправка...":"Подтвердить"),1)],8,Rl)),(0,o.Lk)("button",{class:"btn-cancel",onClick:t[1]||(t[1]=(...e)=>n.closeModal&&n.closeModal(...e))},[t[8]||(t[8]=(0,o.Lk)("i",{class:"fas fa-times"},null,-1)),(0,o.eW)(" "+(0,l.v_)(r.errorMessage?"Закрыть":"Отмена"),1)])])])])):(0,o.Q3)("",!0)],64)}const Ol=(0,Vt.nY)("projects",{state:()=>({projects:[],isLoading:!1,error:null}),getters:{getProjects:e=>e.projects,inProgressProjects:e=>e.projects.filter((e=>"in_progress"===e.status))},actions:{async fetchProjects(){this.isLoading=!0,this.error=null;try{const e=localStorage.getItem("accessToken"),t=await ge.A.get("/api/projects/",{headers:{Authorization:`Bearer ${e}`}});this.projects=t.data}catch(e){console.error("Error fetching projects:",e),this.error=e.message}finally{this.isLoading=!1}}}});var Vl={setup(){const e=zt(),t=hs(),s=Ol();return{profileStore:e,userStore:t,projectStore:s}},data(){return{showModal:!1,selectedProjectUuid:null,errorMessage:null,isLoading:!1}},computed:{allProjects(){return this.projectStore.getProjects.filter((e=>"auction"===e.status))},isGip(){return this.userStore.isGip},userSpecialty(){return this.profileStore.profileData.physical_profile?.specialty},getCurrentSpecialty(){if(this.userStore.isGip)return"ГИП";const e=this.profileStore.profileData.physical_profile?.specialty,t=this.profileStore.specialties.find((t=>t.id===e));return t?t.name:"Не указано"}},methods:{formatDate(e){try{const t=new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"});return t}catch(t){return console.error("Date formatting error:",t),e}},async submitResponse(){this.isLoading=!0;try{const e=localStorage.getItem("accessToken");if(!e)throw new Error("Не авторизован");await ge.A.post(`api/projects/responses/?project_uuid=${this.selectedProjectUuid}`,{message:"Хочу принять участие в проекте"},{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),this.closeModal()}catch(e){console.error("Ошибка при отправке отклика:",e);let t="Произошла ошибка при отправке заявки";e.response?.data?.detail?t=e.response.data.detail:e.response?.data?.error&&(t=e.response.data.error),this.errorMessage=t}finally{this.isLoading=!1}},closeModal(){this.showModal=!1,this.errorMessage=null},selectProject(e){this.selectedProjectUuid=e,localStorage.getItem("accessToken")?this.showModal=!0:this.$router.push("/login")},getSpecialtyName(e){const t={1:"Архитектор",2:"Инженер-конструктор",3:"Проектировщик ОВиК",4:"Проектировщик ВК",5:"Проектировщик электрических сетей",6:"Проектировщик слаботочных систем",7:"Проектировщик газоснабжения"};return t[e]||`Специальность ${e}`},formatBudget(e){return Number(e).toLocaleString("ru-RU")},filteredBudgets(e){return this.isGip?e:e.filter((e=>e.specialty===this.userSpecialty))}},async created(){console.log("AuctionContent: Component created"),await this.projectStore.fetchProjects(),console.log("AuctionContent: Projects loaded:",this.allProjects)}};const zl=(0,it.A)(Vl,[["render",Bl],["__scopeId","data-v-777fd181"]]);var ql=zl;const Jl={class:"mobile-auction"},Gl={key:0,class:"projects-list"},Hl={class:"project-header"},Yl={class:"category"},Zl={class:"project-info"},ei={class:"subtitle"},ti={class:"meta"},si={class:"duration"},ai={class:"client"},oi={class:"project-budget"},li={class:"specialty"},ii={class:"amount"},ri=["onClick"],ni={key:1,class:"no-projects"},ci={key:2,class:"modal-overlay"},di={class:"modal-content"},ui={class:"modal-buttons"},pi=["disabled"];function hi(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",Jl,[r.allProjects&&r.allProjects.length>0?((0,o.uX)(),(0,o.CE)("div",Gl,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.allProjects,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.uuid,class:"project-card"},[(0,o.Lk)("div",Hl,[(0,o.Lk)("h3",null,(0,l.v_)(e.name),1),(0,o.Lk)("span",Yl,(0,l.v_)(e.complexity.name),1)]),(0,o.Lk)("div",Zl,[(0,o.Lk)("p",ei,(0,l.v_)(e.subtitle),1),(0,o.Lk)("div",ti,[(0,o.Lk)("span",si,[t[2]||(t[2]=(0,o.Lk)("img",{src:Ct,alt:"Duration"},null,-1)),(0,o.eW)(" "+(0,l.v_)(e.estimated_duration)+" мес. ",1)]),(0,o.Lk)("span",ai,(0,l.v_)(e.client_name),1)])]),(0,o.Lk)("div",oi,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.filteredBudgets(e.specialty_budgets),(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.specialty,class:"budget-item"},[(0,o.Lk)("span",li,(0,l.v_)(r.getSpecialtyName(e.specialty)),1),(0,o.Lk)("span",ii,(0,l.v_)(r.formatBudget(e.budget))+" тг",1)])))),128))]),(0,o.Lk)("button",{class:"apply-button",onClick:t=>r.selectProject(e.uuid)}," Оставить заявку ",8,ri)])))),128))])):((0,o.uX)(),(0,o.CE)("div",ni," Нет доступных проектов ")),i.showModal?((0,o.uX)(),(0,o.CE)("div",ci,[(0,o.Lk)("div",di,[(0,o.Lk)("h3",null,(0,l.v_)(i.errorMessage?"Ошибка":"Подтверждение заявки"),1),(0,o.Lk)("p",null,(0,l.v_)(i.errorMessage||"Вы уверены, что хотите оставить заявку на этот проект?"),1),(0,o.Lk)("div",ui,[i.errorMessage?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:0,class:"confirm-button",onClick:t[0]||(t[0]=(...e)=>r.submitResponse&&r.submitResponse(...e)),disabled:i.isLoading},(0,l.v_)(i.isLoading?"Отправка...":"Подтвердить"),9,pi)),(0,o.Lk)("button",{class:"cancel-button",onClick:t[1]||(t[1]=(...e)=>r.closeModal&&r.closeModal(...e))},(0,l.v_)(i.errorMessage?"Закрыть":"Отмена"),1)])])])):(0,o.Q3)("",!0)])}var mi={name:"MobileAuction",setup(){const e=zt(),t=hs(),s=Ol();return{profileStore:e,userStore:t,projectStore:s}},data(){return{showModal:!1,selectedProjectUuid:null,errorMessage:null,isLoading:!1}},computed:{allProjects(){return this.projectStore.getProjects.filter((e=>"auction"===e.status))},isGip(){return this.userStore.isGip},userSpecialty(){return this.profileStore.profileData.physical_profile?.specialty}},methods:{getSpecialtyName(e){const t={1:"Архитектор",2:"Инженер-конструктор",3:"Проектировщик ОВиК",4:"Проектировщик ВК",5:"Проектировщик электрических сетей",6:"Проектировщик слаботочных систем",7:"Проектировщик газоснабжения"};return t[e]||`Специальность ${e}`},formatBudget(e){return Number(e).toLocaleString("ru-RU")},filteredBudgets(e){return this.isGip?e:e.filter((e=>e.specialty===this.userSpecialty))},selectProject(e){this.selectedProjectUuid=e,localStorage.getItem("accessToken")?this.showModal=!0:this.$router.push("/login")},async submitResponse(){this.isLoading=!0;try{const e=localStorage.getItem("accessToken");if(!e)throw new Error("Не авторизован");await ge.A.post(`api/projects/responses/?project_uuid=${this.selectedProjectUuid}`,{message:"Хочу принять участие в проекте"},{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),this.closeModal()}catch(e){let t="Произошла ошибка при отправке заявки";e.response?.data?.detail?t=e.response.data.detail:e.response?.data?.error&&(t=e.response.data.error),this.errorMessage=t}finally{this.isLoading=!1}},closeModal(){this.showModal=!1,this.errorMessage=null}},async created(){await this.projectStore.fetchProjects()}};const vi=(0,it.A)(mi,[["render",hi],["__scopeId","data-v-77f9db78"]]);var ki=vi,gi={components:{ContentAuction:ql,MobileAuction:ki},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}}};const fi=(0,it.A)(gi,[["render",cl],["__scopeId","data-v-3f279d6d"]]);var yi=fi;const Li={key:1,class:"main-page"};function bi(e,t,s,a,l,i){const r=(0,o.g2)("MobileNews"),n=(0,o.g2)("NewsContent");return(0,o.uX)(),(0,o.CE)("div",null,[a.isMobile?((0,o.uX)(),(0,o.Wv)(r,{key:0})):((0,o.uX)(),(0,o.CE)("div",Li,[(0,o.bF)(n)]))])}var Ci=s.p+"img/star.5e6c8991.svg";const _i={class:"news-container"},wi={class:"header"},Ei={class:"search-container"},Di={class:"search-box"},ji={class:"header-buttons"},Si={class:"filter-container"},Fi={class:"sources-list"},Xi=["onClick"],Ii={class:"news-content"},Pi={key:0,class:"loading-indicator"},Mi={class:"news-details"},Ti={class:"title-row"},Ai={class:"news-title"},Ni=["href"],xi=["onClick"],Ui={class:"news-description"},$i={class:"news-footer"},Ki={class:"news-source"},Ri={class:"news-date"},Wi={key:2,class:"no-news"};function Qi(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",_i,[(0,o.Lk)("header",wi,[(0,o.Lk)("div",Ei,[(0,o.Lk)("div",Di,[t[6]||(t[6]=(0,o.Lk)("img",{src:na,alt:"Search",class:"search-icon"},null,-1)),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.searchQuery=e),placeholder:"Поиск новостей...",class:"search-input"},null,512),[[i.Jo,a.searchQuery]])])]),(0,o.Lk)("div",ji,[(0,o.Lk)("button",{class:(0,l.C4)(["header-button",{active:a.showFavorites}]),onClick:t[1]||(t[1]=(...e)=>a.toggleFavoriteFilter&&a.toggleFavoriteFilter(...e)),"aria-label":"favorite"},t[7]||(t[7]=[(0,o.Lk)("img",{src:Ci,alt:"Star Icon"},null,-1)]),2),(0,o.Lk)("button",{class:"header-button",onClick:t[2]||(t[2]=(...e)=>a.toggleGridView&&a.toggleGridView(...e)),"aria-label":"grid view"},t[8]||(t[8]=[(0,o.Lk)("img",{src:As,alt:"Grid Icon"},null,-1)])),(0,o.Lk)("div",Si,[(0,o.Lk)("button",{class:(0,l.C4)(["header-button",{active:a.isSourcesMenuOpen}]),onClick:t[3]||(t[3]=(0,i.D$)(((...e)=>a.toggleSourcesMenu&&a.toggleSourcesMenu(...e)),["stop"])),"aria-label":"menu"},t[9]||(t[9]=[(0,o.Lk)("img",{src:da,alt:"Menu Icon"},null,-1)]),2),a.isSourcesMenuOpen?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"sources-dropdown",onClick:t[5]||(t[5]=(0,i.D$)((()=>{}),["stop"]))},[(0,o.Lk)("div",Fi,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.uniqueSources,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:(0,l.C4)(["source-item",{"source-active":a.selectedSources.includes(e)}]),onClick:t=>a.selectSource(e)},(0,l.v_)(e),11,Xi)))),128)),(0,o.Lk)("div",{class:"source-item",onClick:t[4]||(t[4]=(...e)=>a.selectAllSources&&a.selectAllSources(...e))}," Показать все ")])])):(0,o.Q3)("",!0)])])]),(0,o.Lk)("div",Ii,[a.isLoading?((0,o.uX)(),(0,o.CE)("div",Pi,t[10]||(t[10]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("span",null,"Загрузка новостей...",-1)]))):a.filteredNewsList.length>0?((0,o.uX)(),(0,o.CE)("div",{key:1,class:(0,l.C4)(["news-grid",{"single-column":!a.isDefaultGridView}])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.filteredNewsList,((e,s)=>((0,o.uX)(),(0,o.CE)("div",{class:"news-card",key:s},[(0,o.Lk)("div",{class:"news-image",style:(0,l.Tr)({backgroundImage:`url(${a.getImageUrl(e)})`})},null,4),(0,o.Lk)("div",Mi,[(0,o.Lk)("div",Ti,[(0,o.Lk)("h3",Ai,[(0,o.Lk)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer"},(0,l.v_)(e.title),9,Ni)]),(0,o.Lk)("button",{class:(0,l.C4)(["favorite-button",{"favorite-active":a.isNewsFavorite(e)}]),onClick:t=>a.toggleFavorite(e),"aria-label":"favorite"},t[11]||(t[11]=[(0,o.Lk)("img",{src:Ci,alt:"Star Icon"},null,-1)]),10,xi)]),(0,o.Lk)("p",Ui,(0,l.v_)(e.content),1),(0,o.Lk)("div",$i,[(0,o.Lk)("span",Ki,"Источник: "+(0,l.v_)(e.source),1),(0,o.Lk)("span",Ri,[t[12]||(t[12]=(0,o.Lk)("img",{src:Ct,alt:"Calendar Icon",class:"date-icon"},null,-1)),(0,o.eW)(" "+(0,l.v_)(a.formatDate("dzen"===e.source.toLowerCase()?e.created_at:e.published_date)),1)])])])])))),128))],2)):((0,o.uX)(),(0,o.CE)("div",Wi,t[13]||(t[13]=[(0,o.Lk)("p",null,"Новости не найдены",-1)])))])])}s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);const Bi=(0,Vt.nY)("news",{state:()=>({newsList:[],favoriteNews:[]}),getters:{uniqueSources:e=>[...new Set(e.newsList.map((e=>e.source)))],isNewsFavorite:e=>t=>e.favoriteNews.some((e=>e.id===t.id))},actions:{async fetchAndGetNews(){try{await ge.A.post("api/news/fetch/");const e=await ge.A.get("api/news/");this.newsList=e.data}catch(e){}},toggleFavorite(e){this.favoriteNews.some((t=>t.id===e.id))?this.favoriteNews=this.favoriteNews.filter((t=>t.id!==e.id)):this.favoriteNews.push(e)}}});var Oi={name:"NewsContent",setup(){const e=Bi(),t=(0,fe.KR)(""),a=(0,fe.KR)(!0),l=(0,fe.KR)(!1),i=(0,fe.KR)([]),r=(0,fe.KR)(!1),n=(0,fe.KR)(!0);e.newsList.length>0&&(n.value=!1),(0,o.sV)((async()=>{if(0===e.newsList.length)try{await e.fetchAndGetNews()}finally{n.value=!1}window.addEventListener("click",C)}));const c=(0,o.EW)((()=>e.uniqueSources)),d=(0,o.EW)((()=>{let s=[...e.newsList];if(s=s.sort(((e,t)=>{if("dzen"===e.source.toLowerCase()&&"archdaily"===t.source.toLowerCase())return 1;if("archdaily"===e.source.toLowerCase()&&"dzen"===t.source.toLowerCase())return-1;const s=new Date("dzen"===e.source.toLowerCase()?e.created_at:e.published_date),a=new Date("dzen"===t.source.toLowerCase()?t.created_at:t.published_date);return a-s})),r.value&&(s=s.filter((t=>e.isNewsFavorite(t)))),i.value.length>0&&(s=s.filter((e=>i.value.includes(e.source)))),t.value){const e=t.value.toLowerCase();s=s.filter((t=>{let s=t.title,a=t.content;return"archdaily"===t.source.toLowerCase()&&(s=p(t.title),a=p(t.content)),s.toLowerCase().includes(e)||a.toLowerCase().includes(e)||t.source.toLowerCase().includes(e)}))}return s.map((e=>"archdaily"===e.source.toLowerCase()?{...e,title:p(e.title),content:p(e.content)}:e))})),u=s(9771);function p(e){return e?e.replace(/\./g,""):e}function h(e){const t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString("ru-RU",t)}function m(e){if("archdaily"===e.source.toLowerCase()){if(e.image_url){const t=encodeURI(e.image_url);return t}return u}return e.image||u}function v(){a.value=!a.value}function k(e){e.stopPropagation(),l.value=!l.value}function g(e){i.value.includes(e)?i.value=i.value.filter((t=>t!==e)):i.value=[e]}function f(){i.value=[]}function y(t){return e.isNewsFavorite(t)}function L(t){e.toggleFavorite(t)}function b(){r.value=!r.value}function C(e){const t=document.querySelector(".filter-container");t&&!t.contains(e.target)&&l.value&&(l.value=!1)}function _(e){g(e),l.value=!1}function w(){f(),l.value=!1}return{searchQuery:t,isDefaultGridView:a,isSourcesMenuOpen:l,selectedSources:i,showFavorites:r,uniqueSources:c,filteredNewsList:d,removeDots:p,formatDate:h,getImageUrl:m,toggleGridView:v,toggleSourcesMenu:k,toggleSource:g,clearSourceFilter:f,isNewsFavorite:y,toggleFavorite:L,toggleFavoriteFilter:b,handleGlobalClick:C,selectSource:_,selectAllSources:w,isLoading:n}}};const Vi=(0,it.A)(Oi,[["render",Qi],["__scopeId","data-v-144ba2f4"]]);var zi=Vi;const qi={class:"mobile-news"},Ji={class:"search-section"},Gi={class:"search-box"},Hi={class:"filters"},Yi={key:0,class:"sources-menu"},Zi=["onClick"],er={class:"news-list"},tr={key:0,class:"loading-state"},sr={key:1,class:"news-items"},ar={class:"news-content"},or={class:"news-header"},lr={class:"news-title"},ir=["href"],rr=["onClick"],nr={class:"news-description"},cr={class:"news-footer"},dr={class:"news-source"},ur={class:"news-date"},pr={key:2,class:"empty-state"};function hr(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",qi,[(0,o.Lk)("div",Ji,[(0,o.Lk)("div",Gi,[t[4]||(t[4]=(0,o.Lk)("img",{src:na,alt:"Search",class:"search-icon"},null,-1)),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.searchQuery=e),placeholder:"Поиск новостей...",class:"search-input"},null,512),[[i.Jo,a.searchQuery]])]),(0,o.Lk)("div",Hi,[(0,o.Lk)("button",{class:(0,l.C4)(["filter-btn",{active:a.showFavorites}]),onClick:t[1]||(t[1]=(...e)=>a.toggleFavoriteFilter&&a.toggleFavoriteFilter(...e))},t[5]||(t[5]=[(0,o.Lk)("img",{src:Ci,alt:"Star"},null,-1)]),2),(0,o.Lk)("button",{class:(0,l.C4)(["filter-btn",{active:a.isSourcesMenuOpen}]),onClick:t[2]||(t[2]=(...e)=>a.toggleSourcesMenu&&a.toggleSourcesMenu(...e))},t[6]||(t[6]=[(0,o.Lk)("img",{src:da,alt:"Filter"},null,-1)]),2)])]),a.isSourcesMenuOpen?((0,o.uX)(),(0,o.CE)("div",Yi,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.uniqueSources,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:(0,l.C4)(["source-item",{active:a.selectedSources.includes(e)}]),onClick:t=>a.selectSource(e)},(0,l.v_)(e),11,Zi)))),128)),(0,o.Lk)("div",{class:"source-item",onClick:t[3]||(t[3]=(...e)=>a.selectAllSources&&a.selectAllSources(...e))}," Показать все ")])):(0,o.Q3)("",!0),(0,o.Lk)("div",er,[a.isLoading?((0,o.uX)(),(0,o.CE)("div",tr,t[7]||(t[7]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("span",null,"Загрузка новостей...",-1)]))):a.filteredNewsList.length>0?((0,o.uX)(),(0,o.CE)("div",sr,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.filteredNewsList,((e,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s,class:"news-card"},[(0,o.Lk)("div",{class:"news-image",style:(0,l.Tr)({backgroundImage:`url(${a.getImageUrl(e)})`})},null,4),(0,o.Lk)("div",ar,[(0,o.Lk)("div",or,[(0,o.Lk)("h3",lr,[(0,o.Lk)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer"},(0,l.v_)(e.title),9,ir)]),(0,o.Lk)("button",{class:(0,l.C4)(["favorite-btn",{active:a.isNewsFavorite(e)}]),onClick:t=>a.toggleFavorite(e)},t[8]||(t[8]=[(0,o.Lk)("img",{src:Ci,alt:"Star"},null,-1)]),10,rr)]),(0,o.Lk)("p",nr,(0,l.v_)(e.content),1),(0,o.Lk)("div",cr,[(0,o.Lk)("span",dr,(0,l.v_)(e.source),1),(0,o.Lk)("span",ur,[t[9]||(t[9]=(0,o.Lk)("img",{src:Ct,alt:"Calendar"},null,-1)),(0,o.eW)(" "+(0,l.v_)(a.formatDate("dzen"===e.source.toLowerCase()?e.created_at:e.published_date)),1)])])])])))),128))])):((0,o.uX)(),(0,o.CE)("div",pr,t[10]||(t[10]=[(0,o.Lk)("p",null,"Новости не найдены",-1)])))])])}var mr={name:"MobileNews",setup(){const e=Bi(),t=(0,fe.KR)(""),a=(0,fe.KR)(!1),l=(0,fe.KR)([]),i=(0,fe.KR)(!1),r=(0,fe.KR)(!0);e.newsList.length>0&&(r.value=!1),(0,o.sV)((async()=>{if(0===e.newsList.length)try{await e.fetchAndGetNews()}finally{r.value=!1}window.addEventListener("click",u)}));const n=(0,o.EW)((()=>e.uniqueSources)),c=e=>e?e.replace(/\./g,""):e,d=(0,o.EW)((()=>{let s=[...e.newsList];if(l.value.length>0&&(s=s.filter((e=>l.value.includes(e.source)))),t.value){const e=t.value.toLowerCase();s=s.filter((t=>{let s=t.title,a=t.content;return"archdaily"===t.source.toLowerCase()&&(s=c(t.title),a=c(t.content)),s.toLowerCase().includes(e)||a.toLowerCase().includes(e)}))}return i.value&&(s=s.filter((t=>e.isNewsFavorite(t)))),s.map((e=>"archdaily"===e.source.toLowerCase()?{...e,title:c(e.title),content:c(e.content)}:e))})),u=()=>{a.value=!1},p=e=>{e.stopPropagation(),a.value=!a.value},h=e=>{const t=l.value.indexOf(e);-1===t?l.value.push(e):l.value.splice(t,1)},m=()=>{l.value=[]},v=()=>{i.value=!i.value},k=t=>e.isNewsFavorite(t),g=t=>{e.toggleFavorite(t)},f=e=>new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long"}),y=e=>"dzen"===e.source.toLowerCase()?s(9771):"archdaily"===e.source.toLowerCase()?e.image_url?encodeURI(e.image_url):s(9771):e.image;return{searchQuery:t,isSourcesMenuOpen:a,selectedSources:l,showFavorites:i,isLoading:r,uniqueSources:n,filteredNewsList:d,toggleSourcesMenu:p,selectSource:h,selectAllSources:m,toggleFavoriteFilter:v,isNewsFavorite:k,toggleFavorite:g,formatDate:f,getImageUrl:y,removeDots:c}}};const vr=(0,it.A)(mr,[["render",hr],["__scopeId","data-v-23168372"]]);var kr=vr,gr={components:{NewsContent:zi,MobileNews:kr},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}}};const fr=(0,it.A)(gr,[["render",bi]]);var yr=fr;const Lr={key:1,class:"main-page"};function br(e,t,s,a,l,i){const r=(0,o.g2)("MobileDocuments"),n=(0,o.g2)("DocumentsContent");return(0,o.uX)(),(0,o.CE)("div",null,[a.isMobile?((0,o.uX)(),(0,o.Wv)(r,{key:0})):((0,o.uX)(),(0,o.CE)("div",Lr,[(0,o.bF)(n)]))])}var Cr=s.p+"img/time.89e48d11.svg";function _r(e,t,s,a,l,i){return(0,o.uX)(),(0,o.CE)("div",null,[t[1]||(t[1]=(0,o.Fv)('<header class="header" data-v-190134c4><div class="search-bar" data-v-190134c4><input type="text" placeholder="найти" data-v-190134c4><img src="'+na+'" alt="Search Icon" class="search-icon" data-v-190134c4><button class="search-button" aria-label="search" data-v-190134c4></button></div><div class="header-controls" data-v-190134c4><div class="period-selector" data-v-190134c4><div class="period-icon" data-v-190134c4><img src="'+Cr+'" alt="Clock Icon" data-v-190134c4></div><button class="period-button" data-v-190134c4>за день</button><button class="period-button active" data-v-190134c4>за неделю</button><button class="period-button" data-v-190134c4>за месяц</button></div></div><button class="header-button" aria-label="favorite" data-v-190134c4><img src="'+Ci+'" alt="Star Icon" data-v-190134c4></button></header>',1)),(0,o.Lk)("div",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.blocks,((e,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s,class:"main-block"},t[0]||(t[0]=[(0,o.Fv)('<div class="icon-container" data-v-190134c4><img src="'+Ci+'" alt="Star Icon" class="star-icon" data-v-190134c4></div><h3 class="title" data-v-190134c4> Перечень нормативных правовых актов и нормативных технических документов в области архитектуры, градостроительства и строительства, действующих на территории Республики Казахстан </h3><div class="content-footer" data-v-190134c4><div class="info-container" data-v-190134c4><p class="publisher" data-v-190134c4>Издатель: TengriNews</p></div><div class="date-container" data-v-190134c4><p class="date-info" data-v-190134c4>Дата публикации: 24 окт. 2023, 12:12</p><p class="date-info" data-v-190134c4>Дата обновления: 24 окт. 2023, 12:12</p></div></div>',3)]))))),128))])])}var wr={name:"DocumentsContent",data(){return{blocks:new Array(5).fill(null)}}};const Er=(0,it.A)(wr,[["render",_r],["__scopeId","data-v-190134c4"]]);var Dr=Er;const jr={class:"mobile-documents"},Sr={class:"search-section"},Fr={class:"search-box"},Xr={class:"filters"},Ir={key:0,class:"periods-menu"},Pr=["onClick"],Mr={class:"documents-list"},Tr={key:0,class:"loading-state"},Ar={key:1,class:"document-items"},Nr={class:"document-content"},xr={class:"document-header"},Ur={class:"document-title"},$r=["onClick"],Kr={class:"document-footer"},Rr={class:"document-publisher"},Wr={class:"dates"},Qr={class:"document-date"},Br={class:"document-date"},Or={key:2,class:"empty-state"};function Vr(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",jr,[(0,o.Lk)("div",Sr,[(0,o.Lk)("div",Fr,[t[3]||(t[3]=(0,o.Lk)("img",{src:na,alt:"Search",class:"search-icon"},null,-1)),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.searchQuery=e),placeholder:"Поиск документов...",class:"search-input"},null,512),[[i.Jo,a.searchQuery]])]),(0,o.Lk)("div",Xr,[(0,o.Lk)("button",{class:(0,l.C4)(["filter-btn",{active:a.showFavorites}]),onClick:t[1]||(t[1]=(...e)=>a.toggleFavoriteFilter&&a.toggleFavoriteFilter(...e))},t[4]||(t[4]=[(0,o.Lk)("img",{src:Ci,alt:"Star"},null,-1)]),2),(0,o.Lk)("button",{class:(0,l.C4)(["filter-btn",{active:a.isPeriodsMenuOpen}]),onClick:t[2]||(t[2]=(...e)=>a.togglePeriodsMenu&&a.togglePeriodsMenu(...e))},t[5]||(t[5]=[(0,o.Lk)("img",{src:Cr,alt:"Time"},null,-1)]),2)])]),a.isPeriodsMenuOpen?((0,o.uX)(),(0,o.CE)("div",Ir,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.periods,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:(0,l.C4)(["period-item",{active:a.selectedPeriod===e}]),onClick:t=>a.selectPeriod(e)},(0,l.v_)(e),11,Pr)))),128))])):(0,o.Q3)("",!0),(0,o.Lk)("div",Mr,[a.isLoading?((0,o.uX)(),(0,o.CE)("div",Tr,t[6]||(t[6]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("span",null,"Загрузка документов...",-1)]))):a.documents.length>0?((0,o.uX)(),(0,o.CE)("div",Ar,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.documents,((e,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s,class:"document-card"},[(0,o.Lk)("div",Nr,[(0,o.Lk)("div",xr,[(0,o.Lk)("h3",Ur,(0,l.v_)(e.title),1),(0,o.Lk)("button",{class:(0,l.C4)(["favorite-btn",{active:e.isFavorite}]),onClick:t=>a.toggleFavorite(e)},t[7]||(t[7]=[(0,o.Lk)("img",{src:Ci,alt:"Star"},null,-1)]),10,$r)]),(0,o.Lk)("div",Kr,[(0,o.Lk)("span",Rr,"Издатель: "+(0,l.v_)(e.publisher),1),(0,o.Lk)("div",Wr,[(0,o.Lk)("span",Qr,[t[8]||(t[8]=(0,o.Lk)("img",{src:Ct,alt:"Calendar"},null,-1)),(0,o.eW)(" Опубликовано: "+(0,l.v_)(a.formatDate(e.publishDate)),1)]),(0,o.Lk)("span",Br,[t[9]||(t[9]=(0,o.Lk)("img",{src:Ct,alt:"Calendar"},null,-1)),(0,o.eW)(" Обновлено: "+(0,l.v_)(a.formatDate(e.updateDate)),1)])])])])])))),128))])):((0,o.uX)(),(0,o.CE)("div",Or,t[10]||(t[10]=[(0,o.Lk)("p",null,"Документы не найдены",-1)])))])])}var zr={name:"MobileDocuments",setup(){const e=(0,fe.KR)(""),t=(0,fe.KR)(!1),s=(0,fe.KR)("за неделю"),a=(0,fe.KR)(!1),l=(0,fe.KR)(!1),i=["за день","за неделю","за месяц"],r=(0,fe.KR)([{title:"Перечень нормативных правовых актов и нормативных технических документов в области архитектуры, градостроительства и строительства, действующих на территории Республики Казахстан",publisher:"TengriNews",publishDate:"2023-10-24T12:12:00",updateDate:"2023-10-24T12:12:00",isFavorite:!1}]),n=e=>{e.stopPropagation(),t.value=!t.value},c=e=>{s.value=e,t.value=!1},d=()=>{a.value=!a.value},u=e=>{e.isFavorite=!e.isFavorite},p=e=>new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"});return(0,o.sV)((()=>{window.addEventListener("click",(()=>{t.value=!1}))})),{searchQuery:e,isPeriodsMenuOpen:t,selectedPeriod:s,showFavorites:a,isLoading:l,periods:i,documents:r,togglePeriodsMenu:n,selectPeriod:c,toggleFavoriteFilter:d,toggleFavorite:u,formatDate:p}}};const qr=(0,it.A)(zr,[["render",Vr],["__scopeId","data-v-aaf150a4"]]);var Jr=qr,Gr={components:{DocumentsContent:Dr,MobileDocuments:Jr},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}}};const Hr=(0,it.A)(Gr,[["render",br],["__scopeId","data-v-54a28dd6"]]);var Yr=Hr;const Zr={key:0},en={key:1,class:"main-page"};function tn(e,t,s,a,l,i){const r=(0,o.g2)("MobileCalendar"),n=(0,o.g2)("MobileActivityChart"),c=(0,o.g2)("Calendar",!0),d=(0,o.g2)("ActivityChart");return(0,o.uX)(),(0,o.CE)("div",null,[a.isMobile?((0,o.uX)(),(0,o.CE)("div",Zr,[(0,o.bF)(r),(0,o.bF)(n)])):((0,o.uX)(),(0,o.CE)("div",en,[(0,o.bF)(c),(0,o.bF)(d)]))])}var sn=s.p+"img/right.83097bf7.svg";const an={class:"page-container"},on={class:"calendar-section"},ln={class:"calendar-container"},rn={class:"calendar-header"},nn={class:"current-month"},cn={class:"project-selector"},dn={class:"project-select-wrapper"},un={class:"select-container"},pn=["value"],hn={class:"calendar-table"},mn=["onClick"],vn={class:"day-number"},kn={key:0,class:"day-tasks"},gn=["title"],fn={class:"events-section"},yn={key:0,class:"events-list"},Ln={class:"task-header"},bn={class:"task-date"},Cn={class:"task-description"},_n={class:"task-assignee"},wn={key:1,class:"no-events"},En={class:"modal-content"},Dn={class:"task-form"},jn={class:"form-group"},Sn={class:"form-group"},Fn={key:0,class:"members-list"},Xn=["onClick"],In={class:"member-photo"},Pn=["src","alt"],Mn={class:"member-info"},Tn={class:"member-name"},An={class:"member-role"},Nn={class:"modal-actions"},xn=["disabled"];function Un(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",an,[(0,o.Lk)("div",on,[(0,o.Lk)("div",ln,[(0,o.Lk)("div",rn,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=e=>n.changeMonth(-1))},t[10]||(t[10]=[(0,o.Lk)("img",{src:ye,alt:"Предыдущий месяц"},null,-1)])),(0,o.Lk)("h2",nn,(0,l.v_)(n.currentMonthName)+" "+(0,l.v_)(n.currentYear),1),(0,o.Lk)("button",{onClick:t[1]||(t[1]=e=>n.changeMonth(1))},t[11]||(t[11]=[(0,o.Lk)("img",{src:sn,alt:"Следующий месяц"},null,-1)]))]),(0,o.Lk)("div",cn,[(0,o.Lk)("div",dn,[t[14]||(t[14]=(0,o.Lk)("label",{for:"project-select"},"Текущий проект:",-1)),(0,o.Lk)("div",un,[(0,o.bo)((0,o.Lk)("select",{id:"project-select","onUpdate:modelValue":t[2]||(t[2]=e=>r.selectedProjectId=e),class:"project-select",onChange:t[3]||(t[3]=(...e)=>n.handleProjectChange&&n.handleProjectChange(...e))},[t[12]||(t[12]=(0,o.Lk)("option",{value:"",disabled:""},"Выберите проект",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.inProgressProjects,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.uuid,value:e.uuid},(0,l.v_)(e.name),9,pn)))),128))],544),[[i.u1,r.selectedProjectId]]),t[13]||(t[13]=(0,o.Lk)("div",{class:"select-arrow"},null,-1))])])]),(0,o.Lk)("table",hn,[t[15]||(t[15]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Пн"),(0,o.Lk)("th",null,"Вт"),(0,o.Lk)("th",null,"Ср"),(0,o.Lk)("th",null,"Чт"),(0,o.Lk)("th",null,"Пт"),(0,o.Lk)("th",null,"Сб"),(0,o.Lk)("th",null,"Вс")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.weeks,((e,t)=>((0,o.uX)(),(0,o.CE)("tr",{key:t},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e,((e,t)=>((0,o.uX)(),(0,o.CE)("td",{key:t,class:(0,l.C4)({empty:0!==e.monthOffset,"past-date":n.isPastDate(e),today:n.isToday(e),selected:n.isSelectedDay(e)}),onClick:t=>0===e.monthOffset&&n.selectDay(e.day)},[(0,o.Lk)("span",vn,(0,l.v_)(e.day),1),0===e.monthOffset?((0,o.uX)(),(0,o.CE)("div",kn,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.getTasksForDay(e.day),(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,l.C4)(["task-indicator",e.status]),title:e.title},(0,l.v_)(e.title.substring(0,15))+"... ",11,gn)))),128))])):(0,o.Q3)("",!0)],10,mn)))),128))])))),128))])]),t[16]||(t[16]=(0,o.Fv)('<div class="task-status-legend"><div class="legend-item"><span class="status-dot green"></span><span>В работе</span></div><div class="legend-item"><span class="status-dot yellow"></span><span>Истекает</span></div><div class="legend-item"><span class="status-dot red"></span><span>Просрочено</span></div></div>',1))])]),(0,o.Lk)("div",fn,[t[17]||(t[17]=(0,o.Lk)("h3",null,"Задачи",-1)),r.tasks.length?((0,o.uX)(),(0,o.CE)("ul",yn,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.sortedTasks,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id,class:"event-item"},[(0,o.Lk)("div",Ln,[(0,o.Lk)("div",{class:(0,l.C4)(["task-title",n.getTaskStatus(e)])},(0,l.v_)(e.title),3),(0,o.Lk)("div",bn,(0,l.v_)(n.formatDate(e.due_date)),1)]),(0,o.Lk)("div",Cn,(0,l.v_)(e.description),1),(0,o.Lk)("div",_n," Исполнитель: "+(0,l.v_)(e.assigned_to),1)])))),128))])):((0,o.uX)(),(0,o.CE)("div",wn," Нет активных задач "))]),r.showEventModal?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:t[9]||(t[9]=(0,i.D$)(((...e)=>n.closeEventModal&&n.closeEventModal(...e)),["self"]))},[(0,o.Lk)("div",En,[(0,o.Lk)("h3",null," Добавить задачу на "+(0,l.v_)(r.selectedDay)+" "+(0,l.v_)(n.currentMonthName)+" "+(0,l.v_)(n.currentYear),1),(0,o.Lk)("div",Dn,[(0,o.Lk)("div",jn,[t[18]||(t[18]=(0,o.Lk)("label",{for:"taskTitle"},"Название задачи:",-1)),(0,o.bo)((0,o.Lk)("input",{id:"taskTitle","onUpdate:modelValue":t[4]||(t[4]=e=>r.taskTitle=e),type:"text",placeholder:"Введите название задачи"},null,512),[[i.Jo,r.taskTitle]])]),(0,o.Lk)("div",Sn,[t[19]||(t[19]=(0,o.Lk)("label",{for:"taskDescription"},"Описание задачи:",-1)),(0,o.bo)((0,o.Lk)("textarea",{id:"taskDescription","onUpdate:modelValue":t[5]||(t[5]=e=>r.taskDescription=e),placeholder:"Введите описание задачи"},null,512),[[i.Jo,r.taskDescription]])])]),r.projectMembers.length?((0,o.uX)(),(0,o.CE)("div",Fn,[t[20]||(t[20]=(0,o.Lk)("h4",null,"Выберите исполнителя:",-1)),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.projectMembers,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id,class:(0,l.C4)(["member-item",{selected:r.selectedMember===e.user_id}]),onClick:t=>r.selectedMember=e.user_id},[(0,o.Lk)("div",In,[(0,o.Lk)("img",{src:e.member.photo,alt:e.member.first_name,onError:t[6]||(t[6]=(...e)=>n.handleImageError&&n.handleImageError(...e))},null,40,Pn)]),(0,o.Lk)("div",Mn,[(0,o.Lk)("div",Tn,(0,l.v_)(e.member.last_name)+" "+(0,l.v_)(e.member.first_name),1),(0,o.Lk)("div",An,(0,l.v_)(e.role),1)])],10,Xn)))),128))])])):(0,o.Q3)("",!0),(0,o.Lk)("div",Nn,[(0,o.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>n.addEvent&&n.addEvent(...e)),disabled:!r.taskTitle||!r.taskDescription||!r.selectedMember}," Создать задачу ",8,xn),(0,o.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>n.closeEventModal&&n.closeEventModal(...e)),class:"cancel-button"},"Отмена")])])])):(0,o.Q3)("",!0)])}var $n=s(1576),Kn=s.n($n),Rn=s(2317),Wn=s.n(Rn);s(8181);Kn().extend(Wn()),Kn().locale("ru");var Qn={data(){return{currentDate:Kn()(),today:Kn()(),weeks:[],selectedDay:null,showEventModal:!1,dailyEvents:[],projectMembers:[],selectedMember:null,taskTitle:"",taskDescription:"",tasks:[],selectedProjectId:null}},setup(){const e=Ol();return{projectStore:e}},computed:{inProgressProjects(){return console.log("Projects from store:",this.projectStore.projects),this.projectStore.projects?.filter((e=>"in_progress"===e.status))||[]},currentProject(){return this.projectStore.projects?.find((e=>e.uuid===this.selectedProjectId))},currentMonthName(){return this.currentDate.format("MMMM").charAt(0).toUpperCase()+this.currentDate.format("MMMM").slice(1)},currentYear(){return this.currentDate.year()},sortedTasks(){return[...this.tasks].sort(((e,t)=>Kn()(e.due_date).valueOf()-Kn()(t.due_date).valueOf()))}},methods:{generateCalendar(){const e=this.currentDate.startOf("month"),t=this.currentDate.daysInMonth();let s=e.day();0===s&&(s=7);const a=[];let o=[];const l=this.currentDate.subtract(1,"month"),i=l.daysInMonth();for(let n=s-1;n>0;n--)o.push({day:(i-n+1).toString(),monthOffset:-1});for(let n=1;n<=t;n++)o.push({day:n.toString(),monthOffset:0}),7===o.length&&(a.push([...o]),o=[]);let r=1;while(o.length<7)o.push({day:r.toString(),monthOffset:1}),r++;a.push([...o]);while(a.length<6){const e=[];for(let t=0;t<7;t++)e.push({day:r.toString(),monthOffset:1}),r++;a.push(e)}this.weeks=a},isPastDate(e){const t=Kn()(this.currentDate).add(e.monthOffset,"month").set("date",parseInt(e.day));return t.isBefore(this.today,"day")},isToday(e){const t=Kn()(this.currentDate).add(e.monthOffset,"month").set("date",parseInt(e.day));return t.isSame(this.today,"day")},isSelectedDay(e){return 0===e.monthOffset&&parseInt(e.day)===parseInt(this.selectedDay)},selectDay(e){this.selectedDay=e,this.showEventModal=!0,this.fetchProjectMembers()},closeEventModal(){this.showEventModal=!1,this.selectedDay=null},async addEvent(){try{if(!this.selectedProjectId)return void console.error("Нет выбранного проекта");const e=localStorage.getItem("accessToken"),t={title:this.taskTitle,description:this.taskDescription,assigned_to:this.selectedMember,project:this.selectedProjectId,due_date_str:Kn()(this.currentDate).set("date",this.selectedDay).format("YYYY-MM-DD")};console.log("Creating task:",t),await ge.A.post("/api/tasks/",t,{headers:{Authorization:`Bearer ${e}`}}),await this.fetchTasks(),this.closeEventModal()}catch(e){console.error("Ошибка при создании задачи:",e)}},async changeMonth(e){this.currentDate=this.currentDate.add(e,"month"),this.generateCalendar(),this.selectedProjectId&&await this.fetchTasks()},async fetchProjectMembers(){try{this.projectMembers=[];const e=localStorage.getItem("accessToken"),t=await ge.A.get("/api/projects/members/",{headers:{Authorization:`Bearer ${e}`}}),s=t.data.filter((e=>e.project_uuid===this.selectedProjectId));this.projectMembers=s.map((e=>({id:e.id,user_id:e.user_id,role:e.role,joined_at:e.joined_at,project_name:e.project_name,project_uuid:e.project_uuid,member:{first_name:e.member.first_name,last_name:e.member.last_name,photo:e.member.photo||null,full_name:`${e.member.last_name} ${e.member.first_name}`}})))}catch(e){console.error("Ошибка при получении участников проекта:",e),this.projectMembers=[]}},handleImageError(e){e.target.src="путь_к_дефолтной_картинке.jpg"},async fetchTasks(){try{if(!this.selectedProjectId)return void(this.tasks=[]);const e=localStorage.getItem("accessToken"),t=await ge.A.get("/api/tasks/",{headers:{Authorization:`Bearer ${e}`},params:{project:this.selectedProjectId}}),s=t.data.filter((e=>e.project===this.selectedProjectId));this.tasks=s.map((e=>({...e,status:this.getTaskStatus(e),assigned_to:e.assigned_to_details?`${e.assigned_to_details.last_name} ${e.assigned_to_details.first_name}`:"Исполнитель не назначен"}))),this.$nextTick((()=>{this.generateCalendar()}))}catch(e){console.error("Ошибка при получении задач:",{message:e.message,response:e.response?.data,status:e.response?.status}),this.tasks=[]}},getTaskStatus(e){const t=Kn()(e.due_date),s=Kn()();if(t.isBefore(s))return"red";const a=t.diff(s,"day");return a<=3?"yellow":"green"},getTasksForDay(e){return this.tasks.length?this.tasks.filter((t=>{const s=Kn()(t.due_date);return s.date()===parseInt(e)&&s.month()===this.currentDate.month()&&s.year()===this.currentDate.year()})):[]},formatDate(e){return Kn()(e).format("D MMMM YYYY")},async handleProjectChange(){console.log("Project changed to:",this.selectedProjectId),console.log("Current project object:",this.currentProject),this.tasks=[],this.selectedDay=null,this.showEventModal=!1,this.selectedProjectId&&(await this.fetchTasks(),this.generateCalendar())}},watch:{selectedProjectId:{handler(e,t){e!==t&&this.handleProjectChange()},immediate:!1},tasks:{handler(){this.$nextTick((()=>{this.generateCalendar()}))},deep:!0}},async mounted(){this.generateCalendar(),await this.projectStore.fetchProjects();const e=this.inProgressProjects;e.length>0&&(this.selectedProjectId=e[0].uuid,await this.fetchTasks())}};const Bn=(0,it.A)(Qn,[["render",Un]]);var On=Bn;const Vn={class:"activity-chart"},zn={key:0,class:"loading"},qn={key:1,class:"error"},Jn={key:2,class:"info"},Gn={class:"chart-header"},Hn={class:"chart-header-left"},Yn=["value"],Zn={class:"chart-container"},ec={class:"schedule-container"},tc={class:"fixed-column"},sc={class:"task-list-content"},ac={class:"group-header"},oc={class:"group-id"},lc={class:"task-info"},ic={class:"task-id"},rc={class:"task-name"},nc={class:"scrollable-content"},cc={class:"days-header"},dc={class:"schedule-grid",ref:"scheduleGrid"};function uc(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",Vn,[a.projectStore.isLoading?((0,o.uX)(),(0,o.CE)("div",zn," Загрузка графика... ")):a.projectStore.hasError?((0,o.uX)(),(0,o.CE)("div",qn," Ошибка при загрузке графика: "+(0,l.v_)(a.projectStore.error),1)):n.isProjectInProgress?((0,o.uX)(),(0,o.CE)(o.FK,{key:3},[(0,o.Lk)("div",Gn,[(0,o.Lk)("div",Hn,[t[3]||(t[3]=(0,o.Lk)("h3",null,"График производства работ",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedProjectId=e),class:"project-selector",onChange:t[1]||(t[1]=(...e)=>n.handleProjectChange&&n.handleProjectChange(...e))},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.inProgressProjects,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.name),9,Yn)))),128))],544),[[i.u1,r.selectedProjectId]])]),t[4]||(t[4]=(0,o.Fv)('<div class="chart-controls" data-v-1e28b782><div class="legend" data-v-1e28b782><div class="legend-item" data-v-1e28b782><span class="legend-color work-day" data-v-1e28b782></span><span data-v-1e28b782>В работе</span></div><div class="legend-item" data-v-1e28b782><span class="legend-color completed" data-v-1e28b782></span><span data-v-1e28b782>Выполнено</span></div></div></div>',1))]),(0,o.Lk)("div",Zn,[(0,o.Lk)("div",ec,[(0,o.Lk)("div",tc,[t[6]||(t[6]=(0,o.Lk)("div",{class:"header-row"},[(0,o.Lk)("div",{class:"header-cell"},"Наименование работ / Длительность")],-1)),(0,o.Lk)("div",{class:"task-list",ref:"taskList",onScroll:t[2]||(t[2]=(...e)=>n.handleTaskListScroll&&n.handleTaskListScroll(...e))},[(0,o.Lk)("div",sc,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.workSchedule,((e,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s,class:"task-group"},[(0,o.Lk)("div",ac,[(0,o.Lk)("span",oc,"#"+(0,l.v_)(e.prefix),1),(0,o.eW)(" "+(0,l.v_)(e.title),1)]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.tasks,((e,a)=>((0,o.uX)(),(0,o.CE)("div",{key:`${s}-${a}`,class:"task-row"},[(0,o.Lk)("div",lc,[(0,o.Lk)("span",ic,(0,l.v_)(e.order),1),(0,o.Lk)("span",rc,(0,l.v_)(e.name),1),t[5]||(t[5]=(0,o.Lk)("span",{class:"duration"},"5 дн.",-1))])])))),128))])))),128))])],544)]),(0,o.Lk)("div",nc,[t[8]||(t[8]=(0,o.Fv)('<div class="month-header" data-v-1e28b782><div class="month-cell" data-v-1e28b782>Январь</div><div class="month-cell" data-v-1e28b782>Февраль</div><div class="month-cell" data-v-1e28b782>Март</div><div class="month-cell" data-v-1e28b782>Апрель</div><div class="month-cell" data-v-1e28b782>Май</div></div>',1)),(0,o.Lk)("div",cc,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.months,((e,t)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:t},[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(5,(e=>(0,o.Lk)("div",{key:`${t}-${e}`,class:"day-column"},(0,l.v_)(e),1))),64))],64)))),128))]),(0,o.Lk)("div",dc,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.workSchedule,((e,s)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:s},[t[7]||(t[7]=(0,o.Lk)("div",{class:"group-timeline-spacer"},null,-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.tasks,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:`${s}-${t}`,class:"task-timeline"},[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(25,(t=>(0,o.Lk)("div",{key:t,class:(0,l.C4)(["day-cell",{"work-day":n.isWorkDayInBlock(e,t),completed:n.isCompletedDayInBlock(e,t)}])},null,2))),64))])))),128))],64)))),128))],512)])])])],64)):((0,o.uX)(),(0,o.CE)("div",Jn," График доступен только для проектов в работе "))])}s(8872);var pc={name:"ActivityChart",setup(){const e=Ol();return{projectStore:e}},data(){return{months:[{name:"Январь",days:31},{name:"Февраль",days:28},{name:"Март",days:31},{name:"Апрель",days:30},{name:"Май",days:31}],workSchedule:[],isScrolling:!1,selectedProjectId:null}},computed:{inProgressProjects(){return this.projectStore.getProjects.filter((e=>"in_progress"===e.status))},currentProject(){return this.projectStore.getProjects.find((e=>e.id===this.selectedProjectId))},formattedTasks(){const e=this.currentProject?.template?.default_tasks;if(console.log("Default tasks:",e),!e)return[];const t=e.reduce(((e,t)=>{if(console.log("Processing task:",t),!e[t.sub_work_name]){const s=t.order.split(".")[0];e[t.sub_work_name]={title:t.sub_work_name,prefix:s,tasks:[]}}return e[t.sub_work_name].tasks.push({id:t.id,name:t.work_name,order:t.order,duration:5,workDays:this.generateWorkDays(t.order),completedDays:[]}),e}),{});return console.log("Grouped tasks:",t),Object.values(t)},isProjectInProgress(){return"in_progress"===this.currentProject?.status}},created(){this.loadProjectData().then((()=>{this.inProgressProjects.length>0&&(this.selectedProjectId=this.inProgressProjects[0].id)}))},methods:{async loadProjectData(){console.log("Loading projects data"),await this.projectStore.fetchProjects()},generateWorkDays(e){const t=[],s=5,a=1;for(let o=0;o<s;o++)t.push(a+o);return t},isWorkDayInBlock(e,t){return 1===t},isCompletedDayInBlock(e,t){if(!e.completedDays?.length)return!1;const s=Math.floor(e.completedDays[0]/5)+1,a=Math.ceil(e.completedDays.length/5);return t>=s&&t<s+a},handleTaskListScroll(e){if(this.isScrolling)return;this.isScrolling=!0;const t=e.target,s=this.$refs.scheduleGrid;s&&(s.style.marginTop=`-${t.scrollTop}px`),this.isScrolling=!1},handleProjectChange(){console.log("Selected project changed:",this.selectedProjectId)}},watch:{formattedTasks:{immediate:!0,handler(e){this.workSchedule=e}}},mounted(){const e=new ResizeObserver((()=>{const e=this.$refs.taskList,t=this.$refs.scheduleGrid;if(e&&t){const s=e.querySelectorAll(".task-row"),a=t.querySelectorAll(".task-timeline");s.forEach(((e,t)=>{a[t]&&(a[t].style.height=`${e.offsetHeight}px`)}))}}));this.$refs.taskList&&e.observe(this.$refs.taskList)},beforeUnmount(){this.resizeObserver&&this.resizeObserver.disconnect()}};const hc=(0,it.A)(pc,[["render",uc],["__scopeId","data-v-1e28b782"]]);var mc=hc;const vc={class:"mobile-calendar"},kc={class:"project-selector"},gc={class:"project-select-wrapper"},fc={class:"select-container"},yc=["value"],Lc={class:"tabs"},bc={key:0,class:"calendar-content"},Cc={class:"calendar-header"},_c={class:"current-month"},wc={class:"calendar-grid"},Ec={class:"weekdays"},Dc={class:"days"},jc=["onClick"],Sc={class:"day-number"},Fc={key:1,class:"tasks-content"},Xc={class:"tasks-list"},Ic={key:0,class:"empty-state"},Pc={class:"task-header"},Mc={class:"task-title"},Tc={class:"task-date"},Ac={class:"task-description"},Nc={class:"task-assignee"},xc={class:"modal-content"},Uc={class:"task-form"},$c={class:"form-group"},Kc={class:"form-group"},Rc={key:0,class:"members-list"},Wc={class:"members-scroll"},Qc=["onClick"],Bc={class:"member-photo"},Oc=["src","alt"],Vc={class:"member-info"},zc={class:"member-name"},qc={class:"member-role"},Jc={class:"modal-actions"},Gc=["disabled"];function Hc(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",vc,[(0,o.Lk)("div",kc,[(0,o.Lk)("div",gc,[t[14]||(t[14]=(0,o.Lk)("label",{for:"mobile-project-select"},"Текущий проект:",-1)),(0,o.Lk)("div",fc,[(0,o.bo)((0,o.Lk)("select",{id:"mobile-project-select","onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedProjectId=e),class:"project-select",onChange:t[1]||(t[1]=(...e)=>n.handleProjectChange&&n.handleProjectChange(...e))},[t[12]||(t[12]=(0,o.Lk)("option",{value:"",disabled:""},"Выберите проект",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.inProgressProjects,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.uuid,value:e.uuid},(0,l.v_)(e.name),9,yc)))),128))],544),[[i.u1,r.selectedProjectId]]),t[13]||(t[13]=(0,o.Lk)("div",{class:"select-arrow"},null,-1))])])]),(0,o.Lk)("div",Lc,[(0,o.Lk)("button",{onClick:t[2]||(t[2]=e=>r.activeTab="calendar"),class:(0,l.C4)(["tab-btn",{active:"calendar"===r.activeTab}])}," Календарь ",2),(0,o.Lk)("button",{onClick:t[3]||(t[3]=e=>r.activeTab="tasks"),class:(0,l.C4)(["tab-btn",{active:"tasks"===r.activeTab}])}," Задачи ",2)]),"calendar"===r.activeTab?((0,o.uX)(),(0,o.CE)("div",bc,[(0,o.Lk)("div",Cc,[(0,o.Lk)("button",{onClick:t[4]||(t[4]=e=>n.changeMonth(-1))},t[15]||(t[15]=[(0,o.Lk)("img",{src:ye,alt:"Предыдущий месяц"},null,-1)])),(0,o.Lk)("h2",_c,(0,l.v_)(n.currentMonthName)+" "+(0,l.v_)(n.currentYear),1),(0,o.Lk)("button",{onClick:t[5]||(t[5]=e=>n.changeMonth(1))},t[16]||(t[16]=[(0,o.Lk)("img",{src:sn,alt:"Следующий месяц"},null,-1)]))]),(0,o.Lk)("div",wc,[(0,o.Lk)("div",Ec,[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],(e=>(0,o.Lk)("div",{key:e,class:"weekday"},(0,l.v_)(e),1))),64))]),(0,o.Lk)("div",Dc,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.weeks.flat(),((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:(0,l.C4)(["day-cell",{empty:0!==e.monthOffset,today:n.isToday(e),selected:n.isSelectedDay(e),"past-date":n.isPastDate(e),"has-tasks":n.getTasksForDay(e.day).length>0,"task-green":n.hasTaskWithStatus(e.day,"green"),"task-yellow":n.hasTaskWithStatus(e.day,"yellow"),"task-red":n.hasTaskWithStatus(e.day,"red")}]),onClick:t=>0===e.monthOffset&&n.selectDay(e.day)},[(0,o.Lk)("span",Sc,(0,l.v_)(e.day),1)],10,jc)))),128))])]),t[17]||(t[17]=(0,o.Fv)('<div class="task-status-legend" data-v-5698867e><div class="legend-item" data-v-5698867e><span class="status-dot green" data-v-5698867e></span><span data-v-5698867e>В работе</span></div><div class="legend-item" data-v-5698867e><span class="status-dot yellow" data-v-5698867e></span><span data-v-5698867e>Истекает</span></div><div class="legend-item" data-v-5698867e><span class="status-dot red" data-v-5698867e></span><span data-v-5698867e>Просрочено</span></div></div>',1))])):((0,o.uX)(),(0,o.CE)("div",Fc,[t[19]||(t[19]=(0,o.Lk)("div",{class:"tasks-header"},[(0,o.Lk)("h3",null,"Задачи проекта")],-1)),(0,o.Lk)("div",Xc,[0===r.tasks.length?((0,o.uX)(),(0,o.CE)("div",Ic,t[18]||(t[18]=[(0,o.Lk)("img",{src:Ct,alt:"Нет задач",class:"empty-icon"},null,-1),(0,o.Lk)("p",null,"Нет активных задач",-1)]))):((0,o.uX)(!0),(0,o.CE)(o.FK,{key:1},(0,o.pI)(n.sortedTasks,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,l.C4)(["task-item",e.status])},[(0,o.Lk)("div",Pc,[(0,o.Lk)("div",Mc,(0,l.v_)(e.title),1),(0,o.Lk)("div",Tc,(0,l.v_)(n.formatDate(e.due_date)),1)]),(0,o.Lk)("div",Ac,(0,l.v_)(e.description),1),(0,o.Lk)("div",Nc," Исполнитель: "+(0,l.v_)(e.assigned_to),1)],2)))),128))])])),r.showEventModal?((0,o.uX)(),(0,o.CE)("div",{key:2,class:"modal-overlay",onClick:t[11]||(t[11]=(0,i.D$)(((...e)=>n.closeEventModal&&n.closeEventModal(...e)),["self"]))},[(0,o.Lk)("div",xc,[(0,o.Lk)("h3",null,"Добавить задачу на "+(0,l.v_)(r.selectedDay)+" "+(0,l.v_)(n.currentMonthName),1),(0,o.Lk)("div",Uc,[(0,o.Lk)("div",$c,[t[20]||(t[20]=(0,o.Lk)("label",{for:"taskTitle"},"Название задачи:",-1)),(0,o.bo)((0,o.Lk)("input",{id:"taskTitle","onUpdate:modelValue":t[6]||(t[6]=e=>r.taskTitle=e),type:"text",placeholder:"Введите название задачи"},null,512),[[i.Jo,r.taskTitle]])]),(0,o.Lk)("div",Kc,[t[21]||(t[21]=(0,o.Lk)("label",{for:"taskDescription"},"Описание задачи:",-1)),(0,o.bo)((0,o.Lk)("textarea",{id:"taskDescription","onUpdate:modelValue":t[7]||(t[7]=e=>r.taskDescription=e),placeholder:"Введите описание задачи"},null,512),[[i.Jo,r.taskDescription]])]),r.projectMembers.length?((0,o.uX)(),(0,o.CE)("div",Rc,[t[22]||(t[22]=(0,o.Lk)("h4",null,"Выберите исполнителя:",-1)),(0,o.Lk)("div",Wc,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.projectMembers,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,l.C4)(["member-item",{selected:r.selectedMember===e.user_id}]),onClick:t=>r.selectedMember=e.user_id},[(0,o.Lk)("div",Bc,[(0,o.Lk)("img",{src:e.member.photo,alt:e.member.first_name,onError:t[8]||(t[8]=(...e)=>n.handleImageError&&n.handleImageError(...e))},null,40,Oc)]),(0,o.Lk)("div",Vc,[(0,o.Lk)("div",zc,(0,l.v_)(e.member.last_name)+" "+(0,l.v_)(e.member.first_name),1),(0,o.Lk)("div",qc,(0,l.v_)(e.role),1)])],10,Qc)))),128))])])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",Jc,[(0,o.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>n.addEvent&&n.addEvent(...e)),disabled:!r.taskTitle||!r.taskDescription||!r.selectedMember,class:"create-btn"}," Создать задачу ",8,Gc),(0,o.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>n.closeEventModal&&n.closeEventModal(...e)),class:"cancel-btn"},"Отмена")])])])):(0,o.Q3)("",!0)])}Kn().locale("ru");var Yc={name:"MobileCalendar",data(){return{currentDate:Kn()(),today:Kn()(),weeks:[],selectedDay:null,activeTab:"calendar",showEventModal:!1,selectedProjectId:null,tasks:[],projectMembers:[],selectedMember:null,taskTitle:"",taskDescription:""}},setup(){const e=Ol();return{projectStore:e}},computed:{inProgressProjects(){return this.projectStore.projects?.filter((e=>"in_progress"===e.status))||[]},currentProject(){return this.projectStore.projects?.find((e=>e.uuid===this.selectedProjectId))},currentMonthName(){return this.currentDate.format("MMMM").charAt(0).toUpperCase()+this.currentDate.format("MMMM").slice(1)},currentYear(){return this.currentDate.year()},sortedTasks(){return[...this.tasks].sort(((e,t)=>Kn()(e.due_date).valueOf()-Kn()(t.due_date).valueOf()))}},methods:{generateCalendar(){const e=this.currentDate.startOf("month"),t=this.currentDate.daysInMonth();let s=e.day();0===s&&(s=7);const a=[];let o=[];const l=this.currentDate.subtract(1,"month"),i=l.daysInMonth();for(let n=s-1;n>0;n--)o.push({day:i-n+1,monthOffset:-1});for(let n=1;n<=t;n++)o.push({day:n,monthOffset:0}),7===o.length&&(a.push(o),o=[]);let r=1;while(o.length<7)o.push({day:r++,monthOffset:1});a.push(o),this.weeks=a},async handleProjectChange(){console.log("Project changed to:",this.selectedProjectId),console.log("Current project object:",this.currentProject),this.tasks=[],this.selectedDay=null,this.showEventModal=!1,this.selectedProjectId&&(await this.fetchTasks(),this.generateCalendar())},async fetchTasks(){try{if(!this.selectedProjectId)return void(this.tasks=[]);const e=localStorage.getItem("accessToken"),t=await ge.A.get("https:///api/tasks/",{headers:{Authorization:`Bearer ${e}`},params:{project:this.selectedProjectId}}),s=t.data.filter((e=>e.project===this.selectedProjectId));this.tasks=s.map((e=>({...e,status:this.getTaskStatus(e),assigned_to:e.assigned_to_details?`${e.assigned_to_details.last_name} ${e.assigned_to_details.first_name}`:"Исполнитель не назначен"}))),this.$nextTick((()=>{this.generateCalendar()}))}catch(e){console.error("Ошибка при получении задач:",{message:e.message,response:e.response?.data,status:e.response?.status}),this.tasks=[]}},getTaskStatus(e){const t=Kn()(e.due_date),s=Kn()();if(t.isBefore(s))return"red";const a=t.diff(s,"day");return a<=3?"yellow":"green"},handleImageError(e){e.target.src="путь_к_дефолтной_картинке.jpg"},async addEvent(){try{if(!this.selectedProjectId)return void console.error("Нет выбранного проекта");const e=localStorage.getItem("accessToken"),t={title:this.taskTitle,description:this.taskDescription,assigned_to:this.selectedMember,project:this.selectedProjectId,due_date_str:Kn()(this.currentDate).set("date",this.selectedDay).format("YYYY-MM-DD")};await ge.A.post("https:///api/tasks/",t,{headers:{Authorization:`Bearer ${e}`}}),await this.fetchTasks(),this.closeEventModal()}catch(e){console.error("Ошибка при создании задачи:",e)}},closeEventModal(){this.showEventModal=!1,this.selectedDay=null,this.taskTitle="",this.taskDescription="",this.selectedMember=null},changeMonth(e){this.currentDate=this.currentDate.add(e,"month"),this.generateCalendar()},selectDay(e){this.selectedDay=e},isToday(e){return 0===e.monthOffset&&this.currentDate.date(e.day).isSame(this.today,"day")},isSelectedDay(e){return 0===e.monthOffset&&e.day===this.selectedDay},isPastDate(e){const t=this.currentDate.add(e.monthOffset,"month").date(e.day);return t.isBefore(this.today,"day")},formatDate(e){return new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long"})},getTasksForDay(e){return this.tasks?.length?this.tasks.filter((t=>{const s=Kn()(t.due_date);return s.date()===parseInt(e)&&s.month()===this.currentDate.month()&&s.year()===this.currentDate.year()})):[]},hasTaskWithStatus(e,t){return!!this.tasks?.length&&this.tasks.some((s=>{const a=Kn()(s.due_date);return a.date()===parseInt(e)&&a.month()===this.currentDate.month()&&a.year()===this.currentDate.year()&&s.status===t}))}},watch:{selectedProjectId:{handler(e,t){e!==t&&this.handleProjectChange()},immediate:!1},tasks:{handler(){this.$nextTick((()=>{this.generateCalendar()}))},deep:!0}},async mounted(){this.generateCalendar(),await this.projectStore.fetchProjects();const e=this.inProgressProjects;e.length>0&&(this.selectedProjectId=e[0].uuid,await this.fetchTasks())}};const Zc=(0,it.A)(Yc,[["render",Hc],["__scopeId","data-v-5698867e"]]);var ed=Zc;const td={class:"mobile-activity-chart"},sd={key:0,class:"loading-state"},ad={key:1,class:"error-state"},od={key:2,class:"info-state"},ld={class:"chart-header"},id=["value"],rd={class:"months-selector"},nd=["onClick"],cd={class:"tasks-container"},dd=["onClick"],ud={class:"group-id"},pd={class:"group-title"},hd={class:"group-tasks"},md={class:"task-header"},vd={class:"task-id"},kd={class:"task-name"},gd={class:"task-progress"},fd={class:"progress-bar"},yd={class:"progress-text"},Ld={class:"task-dates"},bd={class:"start-date"},Cd={class:"end-date"};function _d(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",td,[a.projectStore.isLoading?((0,o.uX)(),(0,o.CE)("div",sd,t[2]||(t[2]=[(0,o.Lk)("p",null,"Загрузка графика...",-1)]))):a.projectStore.hasError?((0,o.uX)(),(0,o.CE)("div",ad,[(0,o.Lk)("p",null,"Ошибка при загрузке графика: "+(0,l.v_)(a.projectStore.error),1)])):n.isProjectInProgress?((0,o.uX)(),(0,o.CE)(o.FK,{key:3},[(0,o.Lk)("div",ld,[t[4]||(t[4]=(0,o.Lk)("h3",null,"График производства работ",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedProjectId=e),class:"project-selector",onChange:t[1]||(t[1]=(...e)=>n.handleProjectChange&&n.handleProjectChange(...e))},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.inProgressProjects,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.name),9,id)))),128))],544),[[i.u1,r.selectedProjectId]])]),t[6]||(t[6]=(0,o.Fv)('<div class="chart-legend" data-v-4d336432><div class="legend-item" data-v-4d336432><span class="legend-color work-day" data-v-4d336432></span><span data-v-4d336432>В работе</span></div><div class="legend-item" data-v-4d336432><span class="legend-color completed" data-v-4d336432></span><span data-v-4d336432>Выполнено</span></div></div>',1)),(0,o.Lk)("div",rd,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.months,((e,t)=>((0,o.uX)(),(0,o.CE)("button",{key:e.name,class:(0,l.C4)([{active:a.selectedMonth===t},"month-button"]),onClick:e=>n.selectMonth(t)},(0,l.v_)(e.name),11,nd)))),128))]),(0,o.Lk)("div",cd,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.workSchedule,((e,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s,class:"task-group"},[(0,o.Lk)("div",{class:"group-header",onClick:e=>n.toggleGroup(s)},[(0,o.Lk)("span",ud,"#"+(0,l.v_)(e.prefix),1),(0,o.Lk)("span",pd,(0,l.v_)(e.title),1),(0,o.Lk)("span",{class:(0,l.C4)(["group-toggle",{"is-open":a.openGroups[s]}])}," ▼ ",2)],8,dd),(0,o.bo)((0,o.Lk)("div",hd,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.tasks,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"task-item"},[(0,o.Lk)("div",md,[(0,o.Lk)("span",vd,(0,l.v_)(e.order),1),(0,o.Lk)("span",kd,(0,l.v_)(e.name),1),t[5]||(t[5]=(0,o.Lk)("span",{class:"task-duration"},"5 дн.",-1))]),(0,o.Lk)("div",gd,[(0,o.Lk)("div",fd,[(0,o.Lk)("div",{class:(0,l.C4)(["progress-fill",{completed:n.isTaskCompleted(e)}]),style:(0,l.Tr)({width:n.getTaskProgress(e)+"%"})},null,6)]),(0,o.Lk)("span",yd,(0,l.v_)(n.getTaskProgress(e))+"%",1)]),(0,o.Lk)("div",Ld,[(0,o.Lk)("span",bd,(0,l.v_)(n.getTaskStartDate(e)),1),(0,o.Lk)("span",Cd,(0,l.v_)(n.getTaskEndDate(e)),1)])])))),128))],512),[[i.aG,a.openGroups[s]]])])))),128))])],64)):((0,o.uX)(),(0,o.CE)("div",od,t[3]||(t[3]=[(0,o.Lk)("p",null,"График доступен только для проектов в работе",-1)])))])}var wd={name:"MobileActivityChart",setup(){const e=Ol(),t=(0,fe.KR)(0),s=(0,fe.KR)({});return{projectStore:e,selectedMonth:t,openGroups:s}},data(){return{months:[{name:"Янв",days:31},{name:"Фев",days:28},{name:"Мар",days:31},{name:"Апр",days:30},{name:"Май",days:31}],selectedProjectId:null}},computed:{inProgressProjects(){return this.projectStore.getProjects.filter((e=>"in_progress"===e.status))},currentProject(){return this.projectStore.getProjects.find((e=>e.id===this.selectedProjectId))},workSchedule(){const e=this.currentProject?.template?.default_tasks;if(!e)return[];const t=e.reduce(((e,t)=>{if(!e[t.sub_work_name]){const s=t.order.split(".")[0];e[t.sub_work_name]={title:t.sub_work_name,prefix:s,tasks:[]}}return e[t.sub_work_name].tasks.push({id:t.id,name:t.work_name,order:t.order,duration:t.duration||5,startDate:t.start_date,endDate:t.end_date,progress:t.progress||0,status:t.status||"pending"}),e}),{});return Object.values(t)},isProjectInProgress(){return this.inProgressProjects.length>0}},methods:{async loadProjectData(){await this.projectStore.fetchProjects(),this.inProgressProjects.length>0&&(this.selectedProjectId=this.inProgressProjects[0].id)},selectMonth(e){this.selectedMonth=e},toggleGroup(e){this.openGroups[e]=!this.openGroups[e],this.$forceUpdate()},handleProjectChange(){this.loadProjectData()},getTaskProgress(e){return e.progress||0},isTaskCompleted(e){return"completed"===e.status||100===e.progress},getTaskStartDate(e){return e.startDate?new Date(e.startDate).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-"},getTaskEndDate(e){return e.endDate?new Date(e.endDate).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-"}},created(){this.loadProjectData()}};const Ed=(0,it.A)(wd,[["render",_d],["__scopeId","data-v-4d336432"]]);var Dd=Ed,jd={components:{Calendar:On,ActivityChart:mc,MobileCalendar:ed,MobileActivityChart:Dd},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}}};const Sd=(0,it.A)(jd,[["render",tn],["__scopeId","data-v-6ac9365a"]]);var Fd=Sd;const Xd={key:0},Id={key:1,class:"desktop-dashboard"},Pd={key:1,class:"loading"};function Md(e,t,s,a,i,r){const n=(0,o.g2)("MobileDashboard"),c=(0,o.g2)("Banner"),d=(0,o.g2)("Dashboard",!0),u=(0,o.g2)("LastNews");return a.userStore.isDataLoaded?((0,o.uX)(),(0,o.CE)("div",Xd,[a.isMobile?((0,o.uX)(),(0,o.Wv)(n,{key:0})):((0,o.uX)(),(0,o.CE)("div",Id,[(0,o.Lk)("h2",null,"Добрый день, "+(0,l.v_)(a.userStore.firstName),1),(0,o.bF)(c),(0,o.bF)(d),(0,o.bF)(u)]))])):((0,o.uX)(),(0,o.CE)("div",Pd,t[0]||(t[0]=[(0,o.Lk)("p",null,"Загрузка...",-1)])))}const Td={class:"banner"};function Ad(e,t,s,a,l,i){return(0,o.uX)(),(0,o.CE)("div",Td,t[0]||(t[0]=[(0,o.Lk)("div",{class:"content"},[(0,o.Lk)("h1",{class:"title"},"PROJECT MANAGER"),(0,o.Lk)("div",{class:"underline"}),(0,o.Lk)("p",{class:"subtitle"},"Добро пожаловать на альфу-версию нашего сайта")],-1)]))}var Nd={name:"Banner"};const xd=(0,it.A)(Nd,[["render",Ad],["__scopeId","data-v-3db513c4"]]);var Ud=xd;const $d={class:"active-projects"},Kd={key:0,class:"no-projects"},Rd={key:1,class:"projects-table"},Wd={class:"project-info"},Qd=["src"],Bd={class:"project-details"},Od={class:"project-name"},Vd={class:"owner"},zd={class:"progress"},qd={class:"priority-cell"},Jd={class:"budget"};function Gd(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",$d,[t[1]||(t[1]=(0,o.Lk)("h2",null,"Мои проекты",-1)),0===i.projects.length?((0,o.uX)(),(0,o.CE)("div",Kd," У вас нет активных проектов ")):((0,o.uX)(),(0,o.CE)("table",Rd,[t[0]||(t[0]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{class:"header"},"Проекты"),(0,o.Lk)("th",{class:"header"},"Прогресс"),(0,o.Lk)("th",{class:"header"},"Приоритет"),(0,o.Lk)("th",{class:"header"},"Бюджет")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.projects,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,[(0,o.Lk)("div",Wd,[(0,o.Lk)("img",{src:e.avatar,alt:"Аватар",class:"project-avatar"},null,8,Qd),(0,o.Lk)("div",Bd,[(0,o.Lk)("p",Od,(0,l.v_)(e.name),1),(0,o.Lk)("span",Vd,(0,l.v_)(e.owner),1)])])]),(0,o.Lk)("td",zd,(0,l.v_)(e.progress)+"%",1),(0,o.Lk)("td",qd,[(0,o.Lk)("span",{class:(0,l.C4)(["priority",e.priorityClass])},(0,l.v_)(e.priority),3)]),(0,o.Lk)("td",Jd,(0,l.v_)(r.formatBudget(e.budget)),1)])))),128))])]))])}var Hd={name:"ActiveProjects",data(){return{projects:[]}},methods:{formatBudget(e){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"KZT",minimumFractionDigits:0}).format(e)}}};const Yd=(0,it.A)(Hd,[["render",Gd],["__scopeId","data-v-06c74752"]]);var Zd=Yd;const eu={class:"last-news"},tu={key:0,class:"no-news"},su={key:1,class:"news-grid"},au=["onClick"],ou={class:"news-content"},lu={class:"news-title"},iu={class:"news-footer"},ru={class:"news-date"};function nu(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",eu,[t[1]||(t[1]=(0,o.Lk)("h2",null,"Новости дня",-1)),0===i.latestNews.length?((0,o.uX)(),(0,o.CE)("div",tu," Нет доступных новостей ")):((0,o.uX)(),(0,o.CE)("div",su,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.latestNews,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"news-card",onClick:t=>r.goToNews(e)},[(0,o.Lk)("div",{class:"news-image",style:(0,l.Tr)({backgroundImage:`url(${r.getImageUrl(e)})`})},null,4),(0,o.Lk)("div",ou,[(0,o.Lk)("h3",lu,[(0,o.Lk)("span",null,(0,l.v_)(r.removeDots(e.title)),1)]),(0,o.Lk)("div",iu,[(0,o.Lk)("span",ru,[t[0]||(t[0]=(0,o.Lk)("img",{src:Ct,alt:"Calendar",class:"date-icon"},null,-1)),(0,o.eW)(" "+(0,l.v_)(r.formatDate(e.published_date)),1)])])])],8,au)))),128))]))])}var cu={name:"LastNews",setup(){const e=(0,a.rd)();return{router:e}},data(){return{latestNews:[],defaultImage:s(9771)}},methods:{removeDots(e){return e?e.replace(/\./g,""):e},formatDate(e){const t={day:"numeric",month:"long"};return new Date(e).toLocaleDateString("ru-RU",t)},getImageUrl(e){if(e.image_url){const t=encodeURI(e.image_url);return t}return this.defaultImage},async fetchNews(){try{const e=await ge.A.get("api/news/"),t=e.data.filter((e=>"Archdaily"===e.source)).sort(((e,t)=>new Date(t.published_date)-new Date(e.published_date))).slice(0,3);this.latestNews=t}catch(e){}},goToNews(){this.router.push("/news")}},mounted(){this.fetchNews()}};const du=(0,it.A)(cu,[["render",nu],["__scopeId","data-v-82dd6d4e"]]);var uu=du;const pu={class:"mobile-dashboard"},hu={class:"welcome-section"},mu={class:"projects-section"},vu={key:0,class:"no-projects"},ku={key:1,class:"projects-list"},gu={class:"project-header"},fu=["src"],yu={class:"project-info"},Lu={class:"owner"},bu={class:"project-details"},Cu={class:"detail-item"},_u={class:"progress-bar"},wu={class:"detail-row"},Eu={class:"detail-item"},Du={class:"detail-item"},ju={class:"budget"},Su={class:"news-section"},Fu={class:"section-header"},Xu={key:0,class:"no-news"},Iu={key:1,class:"news-list"},Pu={class:"news-content"},Mu={class:"news-date"};function Tu(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",pu,[(0,o.Lk)("div",hu,[(0,o.Lk)("h2",null,"Добрый день, "+(0,l.v_)(a.userStore.firstName),1)]),t[10]||(t[10]=(0,o.Lk)("div",{class:"mobile-banner"},[(0,o.Lk)("h1",null,"PROJECT MANAGER"),(0,o.Lk)("div",{class:"banner-line"}),(0,o.Lk)("p",null,"Альфа-версия")],-1)),(0,o.Lk)("div",mu,[t[6]||(t[6]=(0,o.Lk)("div",{class:"section-header"},[(0,o.Lk)("h3",null,"Мои проекты"),(0,o.Lk)("button",{class:"view-all"},"Все")],-1)),0===i.projects.length?((0,o.uX)(),(0,o.CE)("div",vu,t[2]||(t[2]=[(0,o.Lk)("img",{src:bt,alt:"No projects"},null,-1),(0,o.Lk)("p",null,"У вас нет активных проектов",-1)]))):((0,o.uX)(),(0,o.CE)("div",ku,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.projects,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"project-card"},[(0,o.Lk)("div",gu,[(0,o.Lk)("img",{src:e.avatar,alt:"Project",class:"project-avatar"},null,8,fu),(0,o.Lk)("div",yu,[(0,o.Lk)("h4",null,(0,l.v_)(e.name),1),(0,o.Lk)("span",Lu,(0,l.v_)(e.owner),1)])]),(0,o.Lk)("div",bu,[(0,o.Lk)("div",Cu,[t[3]||(t[3]=(0,o.Lk)("span",{class:"label"},"Прогресс",-1)),(0,o.Lk)("div",_u,[(0,o.Lk)("div",{class:"progress-fill",style:(0,l.Tr)({width:`${e.progress}%`})},null,4)])]),(0,o.Lk)("div",wu,[(0,o.Lk)("div",Eu,[t[4]||(t[4]=(0,o.Lk)("span",{class:"label"},"Приоритет",-1)),(0,o.Lk)("span",{class:(0,l.C4)(["priority-badge",e.priorityClass])},(0,l.v_)(e.priority),3)]),(0,o.Lk)("div",Du,[t[5]||(t[5]=(0,o.Lk)("span",{class:"label"},"Бюджет",-1)),(0,o.Lk)("span",ju,(0,l.v_)(r.formatBudget(e.budget)),1)])])])])))),128))]))]),(0,o.Lk)("div",Su,[(0,o.Lk)("div",Fu,[t[7]||(t[7]=(0,o.Lk)("h3",null,"Новости",-1)),(0,o.Lk)("button",{class:"view-all",onClick:t[0]||(t[0]=(...e)=>r.goToNews&&r.goToNews(...e))},"Все")]),0===i.latestNews.length?((0,o.uX)(),(0,o.CE)("div",Xu,t[8]||(t[8]=[(0,o.Lk)("img",{src:wt,alt:"No news"},null,-1),(0,o.Lk)("p",null,"Нет доступных новостей",-1)]))):((0,o.uX)(),(0,o.CE)("div",Iu,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.latestNews,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"news-card",onClick:t[1]||(t[1]=(...e)=>r.goToNews&&r.goToNews(...e))},[(0,o.Lk)("div",{class:"news-image",style:(0,l.Tr)({backgroundImage:`url(${r.getImageUrl(e)})`})},null,4),(0,o.Lk)("div",Pu,[(0,o.Lk)("h4",null,(0,l.v_)(r.removeDots(e.title)),1),(0,o.Lk)("div",Mu,[t[9]||(t[9]=(0,o.Lk)("img",{src:Ct,alt:"Date"},null,-1)),(0,o.Lk)("span",null,(0,l.v_)(r.formatDate(e.published_date)),1)])])])))),128))]))])])}var Au={name:"MobileDashboard",setup(){const e=hs(),t=(0,a.rd)();return{userStore:e,router:t}},data(){return{projects:[],latestNews:[],defaultImage:s(9771)}},methods:{formatBudget(e){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"KZT",minimumFractionDigits:0}).format(e)},removeDots(e){return e?e.replace(/\./g,""):e},formatDate(e){const t={day:"numeric",month:"long"};return new Date(e).toLocaleDateString("ru-RU",t)},getImageUrl(e){return e.image_url?encodeURI(e.image_url):this.defaultImage},goToNews(){this.router.push("/news")},async fetchNews(){try{const e=await ge.A.get("api/news/");this.latestNews=e.data.filter((e=>"Archdaily"===e.source)).sort(((e,t)=>new Date(t.published_date)-new Date(e.published_date))).slice(0,3)}catch(e){console.error("Error fetching news:",e)}}},mounted(){this.fetchNews()}};const Nu=(0,it.A)(Au,[["render",Tu],["__scopeId","data-v-7e1dcad2"]]);var xu=Nu,Uu={name:"MainPage",components:{Banner:Ud,Dashboard:Zd,LastNews:uu,MobileDashboard:xu},setup(){const e=hs(),t=(0,fe.KR)(window.innerWidth<=768),s=()=>{t.value=window.innerWidth<=768};return(0,o.sV)((()=>{e.isDataLoaded||e.initialize(),window.addEventListener("resize",s)})),(0,o.xo)((()=>{window.removeEventListener("resize",s)})),{userStore:e,isMobile:t}}};const $u=(0,it.A)(Uu,[["render",Md],["__scopeId","data-v-1dffb561"]]);var Ku=$u;const Ru={key:1,class:"main-page"};function Wu(e,t,s,a,l,i){const r=(0,o.g2)("MobileFinance"),n=(0,o.g2)("Wallet"),c=(0,o.g2)("Transactions");return(0,o.uX)(),(0,o.CE)("div",null,[a.isMobile?((0,o.uX)(),(0,o.Wv)(r,{key:0})):((0,o.uX)(),(0,o.CE)("div",Ru,[t[0]||(t[0]=(0,o.Lk)("h2",null,"Ваш кошелек",-1)),(0,o.bF)(n),t[1]||(t[1]=(0,o.Lk)("h2",null,"Текущие транзакции",-1)),(0,o.bF)(c)]))])}const Qu={class:"wallet-section"},Bu={class:"balance-section"},Ou={class:"balance-info"},Vu={class:"balance-amount"},zu={class:"chart-section"},qu={class:"chart-details"};function Ju(e,t,s,a,i,r){const n=(0,o.g2)("ApexDoughnutChart");return(0,o.uX)(),(0,o.CE)("div",Qu,[(0,o.Lk)("div",Bu,[(0,o.Lk)("div",Ou,[t[1]||(t[1]=(0,o.Lk)("p",null,"Доступно для вывода",-1)),(0,o.Lk)("h3",Vu,(0,l.v_)(r.availableFormatted)+" тг.",1),(0,o.Lk)("button",{class:"request-payout-btn",onClick:t[0]||(t[0]=(...e)=>r.requestPayout&&r.requestPayout(...e))}," Запросить выплату ")]),(0,o.Lk)("div",zu,[(0,o.Lk)("div",qu,[(0,o.Lk)("p",null,[t[2]||(t[2]=(0,o.Lk)("span",{class:"chart-indicator remaining"},null,-1)),t[3]||(t[3]=(0,o.Lk)("span",{class:"text-gray"},"Осталось:",-1)),(0,o.Lk)("span",null,(0,l.v_)(r.remainingFormatted)+" тенге",1)]),(0,o.Lk)("p",null,[t[4]||(t[4]=(0,o.Lk)("span",{class:"chart-indicator accrued"},null,-1)),t[5]||(t[5]=(0,o.Lk)("span",{class:"text-gray"},"Начислено:",-1)),(0,o.Lk)("span",null,(0,l.v_)(r.accruedFormatted)+" тенге",1)]),(0,o.Lk)("p",null,[t[6]||(t[6]=(0,o.Lk)("span",{class:"chart-indicator penalties"},null,-1)),t[7]||(t[7]=(0,o.Lk)("span",{class:"text-gray"},"Штрафы:",-1)),(0,o.Lk)("span",null,(0,l.v_)(r.penaltiesFormatted)+" тенге",1)]),(0,o.Lk)("p",null,[t[8]||(t[8]=(0,o.Lk)("span",{class:"chart-indicator available"},null,-1)),t[9]||(t[9]=(0,o.Lk)("span",{class:"text-gray"},"Доступно д/вывода:",-1)),(0,o.Lk)("span",null,(0,l.v_)(r.availableFormatted)+" тенге",1)])]),(0,o.bF)(n,{totalAmount:r.totalFormatted,available:i.available,accrued:i.accrued,penalties:i.penalties},null,8,["totalAmount","available","accrued","penalties"])])])])}const Gu={class:"chart-container"},Hu={class:"chart-center"},Yu={class:"total-amount"};function Zu(e,t,s,a,i,r){const n=(0,o.g2)("apexchart");return(0,o.uX)(),(0,o.CE)("div",Gu,[(0,o.bF)(n,{type:"radialBar",options:e.chartOptions,series:e.series},null,8,["options","series"]),(0,o.Lk)("div",Hu,[(0,o.Lk)("span",Yu,[t[0]||(t[0]=(0,o.eW)("Всего")),t[1]||(t[1]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)((0,l.v_)(e.totalAmount)+" тг.",1)])])])}var ep=s(1758),tp=(0,o.pM)({name:"ApexDoughnutChart",components:{apexchart:ep.A},props:{totalAmount:{type:String,required:!0},available:{type:Number,required:!0},accrued:{type:Number,required:!0},penalties:{type:Number,required:!0}},setup(e){const t=e.available+e.accrued+e.penalties,s=(0,o.EW)((()=>[e.available/t*100,e.accrued/t*100,e.penalties/t*100])),a=(0,o.EW)((()=>({chart:{height:350,type:"radialBar"},plotOptions:{radialBar:{hollow:{size:"70%"},dataLabels:{show:!1},track:{background:"#f0f0f0"}}},labels:["Доступно","Начислено","Штрафы"],colors:["#539bff","#ffa500","#ff0000"],legend:{show:!1},responsive:[{breakpoint:480,options:{chart:{height:300},legend:{position:"bottom"}}}]})));return{series:s,chartOptions:a}}});const sp=(0,it.A)(tp,[["render",Zu],["__scopeId","data-v-729eddba"]]);var ap=sp,op={name:"WalletSection",components:{ApexDoughnutChart:ap},data(){return{total:1e7,available:2e6,accrued:1e6,penalties:1e5}},computed:{remaining(){return this.total-this.available-this.accrued-this.penalties},totalFormatted(){return this.formatCurrency(this.total)},availableFormatted(){return this.formatCurrency(this.available)},accruedFormatted(){return this.formatCurrency(this.accrued)},penaltiesFormatted(){return this.formatCurrency(this.penalties)},remainingFormatted(){return this.formatCurrency(this.remaining)}},methods:{requestPayout(){console.log("Запрос выплаты отправлен")},formatCurrency(e){return e.toLocaleString("ru-RU")},fetchData(){}},mounted(){this.fetchData()}};const lp=(0,it.A)(op,[["render",Ju],["__scopeId","data-v-29f0b4de"]]);var ip=lp;const rp={class:"transaction-tabs"},np={class:"transactions-section"},cp={key:0,class:"empty-state"},dp={key:1,class:"transaction-table"};function up(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",rp,[(0,o.Lk)("button",{class:(0,l.C4)(["tab",{active:"all"===i.activeTab}]),onClick:t[0]||(t[0]=e=>r.switchTab("all"))}," Все транзакции ",2),(0,o.Lk)("button",{class:(0,l.C4)(["tab",{active:"accrued"===i.activeTab}]),onClick:t[1]||(t[1]=e=>r.switchTab("accrued"))}," Начислено ",2),(0,o.Lk)("button",{class:(0,l.C4)(["tab",{active:"withdrawn"===i.activeTab}]),onClick:t[2]||(t[2]=e=>r.switchTab("withdrawn"))}," Выведено ",2),(0,o.Lk)("button",{class:(0,l.C4)(["tab",{active:"penalties"===i.activeTab}]),onClick:t[3]||(t[3]=e=>r.switchTab("penalties"))}," Штрафы ",2),(0,o.Lk)("button",{class:(0,l.C4)(["tab",{active:"bonuses"===i.activeTab}]),onClick:t[4]||(t[4]=e=>r.switchTab("bonuses"))}," Бонусы ",2)]),(0,o.Lk)("div",np,[0===i.transactions.length?((0,o.uX)(),(0,o.CE)("div",cp,t[5]||(t[5]=[(0,o.Lk)("h3",null,"Нет транзакций",-1),(0,o.Lk)("p",null,"На данный момент у вас нет никаких транзакций",-1)]))):"all"===i.activeTab?((0,o.uX)(),(0,o.CE)("table",dp,[t[7]||(t[7]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"ID транзакции"),(0,o.Lk)("th",null,"Тип"),(0,o.Lk)("th",null,"Карта"),(0,o.Lk)("th",null,"Дата"),(0,o.Lk)("th",null,"Сумма"),(0,o.Lk)("th",null,"Квитанция"),(0,o.Lk)("th",null,"Статус")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.transactions,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,(0,l.v_)(e.id),1),(0,o.Lk)("td",null,(0,l.v_)(e.type),1),(0,o.Lk)("td",null,(0,l.v_)(e.card),1),(0,o.Lk)("td",null,(0,l.v_)(e.date),1),(0,o.Lk)("td",{class:(0,l.C4)({"positive-amount":e.amount>0,"negative-amount":e.amount<0})},(0,l.v_)(r.formatAmount(e.amount)),3),t[6]||(t[6]=(0,o.Lk)("td",null,[(0,o.Lk)("button",{class:"icon-button"},[(0,o.Lk)("i",{class:"fas fa-download"})]),(0,o.Lk)("button",{class:"icon-button"},[(0,o.Lk)("i",{class:"fas fa-eye"})])],-1)),(0,o.Lk)("td",null,(0,l.v_)(e.status),1)])))),128))])])):(0,o.Q3)("",!0)])],64)}var pp={data(){return{activeTab:"all",transactions:[]}},methods:{switchTab(e){this.activeTab=e},formatAmount(e){return e>0?`+${e.toLocaleString()} тг.`:`${e.toLocaleString()} тг.`}}};const hp=(0,it.A)(pp,[["render",up],["__scopeId","data-v-3bc68ac4"]]);var mp=hp;const vp={class:"mobile-finance"},kp={class:"wallet-card"},gp={class:"balance-info"},fp={class:"balance-amount"},yp={class:"balance-details"},Lp={class:"detail-item"},bp={class:"detail-value"},Cp={class:"detail-item"},_p={class:"detail-value"},wp={class:"detail-item"},Ep={class:"detail-value"},Dp={class:"transactions-card"},jp={class:"transactions-header"},Sp={class:"tabs"},Fp=["onClick"],Xp={key:0,class:"transactions-list"},Ip={class:"transaction-info"},Pp={class:"transaction-type"},Mp={class:"transaction-date"},Tp={key:1,class:"empty-transactions"};function Ap(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",vp,[(0,o.Lk)("div",kp,[t[5]||(t[5]=(0,o.Lk)("h3",null,"Баланс",-1)),(0,o.Lk)("div",gp,[t[1]||(t[1]=(0,o.Lk)("span",{class:"balance-label"},"Доступно для вывода",-1)),(0,o.Lk)("span",fp,(0,l.v_)(r.availableFormatted)+" тг.",1),(0,o.Lk)("button",{class:"withdraw-button",onClick:t[0]||(t[0]=(...e)=>r.requestPayout&&r.requestPayout(...e))}," Запросить выплату ")]),(0,o.Lk)("div",yp,[(0,o.Lk)("div",Lp,[t[2]||(t[2]=(0,o.Lk)("span",{class:"detail-label"},[(0,o.Lk)("span",{class:"dot remaining"}),(0,o.eW)(" Осталось ")],-1)),(0,o.Lk)("span",bp,(0,l.v_)(r.remainingFormatted)+" тг.",1)]),(0,o.Lk)("div",Cp,[t[3]||(t[3]=(0,o.Lk)("span",{class:"detail-label"},[(0,o.Lk)("span",{class:"dot accrued"}),(0,o.eW)(" Начислено ")],-1)),(0,o.Lk)("span",_p,(0,l.v_)(r.accruedFormatted)+" тг.",1)]),(0,o.Lk)("div",wp,[t[4]||(t[4]=(0,o.Lk)("span",{class:"detail-label"},[(0,o.Lk)("span",{class:"dot penalties"}),(0,o.eW)(" Штрафы ")],-1)),(0,o.Lk)("span",Ep,(0,l.v_)(r.penaltiesFormatted)+" тг.",1)])])]),(0,o.Lk)("div",Dp,[(0,o.Lk)("div",jp,[t[6]||(t[6]=(0,o.Lk)("h3",null,"Транзакции",-1)),(0,o.Lk)("div",Sp,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.tabs,(e=>((0,o.uX)(),(0,o.CE)("button",{key:e.id,class:(0,l.C4)(["tab-button",{active:i.activeTab===e.id}]),onClick:t=>i.activeTab=e.id},(0,l.v_)(e.name),11,Fp)))),128))])]),i.transactions.length>0?((0,o.uX)(),(0,o.CE)("div",Xp,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.transactions,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"transaction-item"},[(0,o.Lk)("div",Ip,[(0,o.Lk)("span",Pp,(0,l.v_)(e.type),1),(0,o.Lk)("span",Mp,(0,l.v_)(r.formatDate(e.date)),1)]),(0,o.Lk)("span",{class:(0,l.C4)(["transaction-amount",e.amount>0?"positive":"negative"])},(0,l.v_)(r.formatAmount(e.amount))+" тг. ",3)])))),128))])):((0,o.uX)(),(0,o.CE)("div",Tp,t[7]||(t[7]=[(0,o.Lk)("img",{src:Lt,alt:"Empty transactions"},null,-1),(0,o.Lk)("p",null,"Нет транзакций",-1)])))])])}var Np={name:"MobileFinance",data(){return{total:1e7,available:2e6,accrued:1e6,penalties:1e5,activeTab:"all",tabs:[{id:"all",name:"Все"},{id:"accrued",name:"Начислено"},{id:"withdrawn",name:"Выведено"},{id:"penalties",name:"Штрафы"}],transactions:[]}},computed:{remaining(){return this.total-this.available-this.accrued-this.penalties},availableFormatted(){return this.formatNumber(this.available)},accruedFormatted(){return this.formatNumber(this.accrued)},penaltiesFormatted(){return this.formatNumber(this.penalties)},remainingFormatted(){return this.formatNumber(this.remaining)}},methods:{formatNumber(e){return e.toLocaleString("ru-RU")},formatAmount(e){return Math.abs(e).toLocaleString("ru-RU")},formatDate(e){return new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long"})},requestPayout(){console.log("Запрос выплаты")}}};const xp=(0,it.A)(Np,[["render",Ap],["__scopeId","data-v-556c48a0"]]);var Up=xp,$p={components:{Wallet:ip,Transactions:mp,MobileFinance:Up},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}}};const Kp=(0,it.A)($p,[["render",Wu],["__scopeId","data-v-6324a445"]]);var Rp=Kp;const Wp={key:1,class:"main-page"},Qp={class:"horizontal-container"};function Bp(e,t,s,a,l,i){const r=(0,o.g2)("MobileInvestments"),n=(0,o.g2)("WorkData"),c=(0,o.g2)("Inspector");return(0,o.uX)(),(0,o.CE)("div",null,[a.isMobile?((0,o.uX)(),(0,o.Wv)(r,{key:0})):((0,o.uX)(),(0,o.CE)("div",Wp,[t[0]||(t[0]=(0,o.Lk)("h2",null,"Вложения",-1)),(0,o.Lk)("div",Qp,[(0,o.bF)(n),(0,o.bF)(c)])]))])}var Op=s.p+"img/edit.f004aa27.svg",Vp=s.p+"img/addpaper.4678a5e2.svg",zp=s.p+"img/delete.fd9b7779.svg",qp=s.p+"img/download.c305db4e.svg";const Jp={class:"work-data-container"},Gp={class:"work-data"},Hp={class:"header"},Yp={class:"header-left"},Zp={class:"project-select"},eh=["value"],th={class:"actions"},sh={class:"folders-container"},ah={class:"folders-list"},oh=["onClick"],lh={class:"folder-content"},ih={class:"folder-name"},rh=["onClick"],nh={class:"folder-content"},ch={class:"folder-name"},dh={key:0,src:qp,alt:"download",class:"download-icon"},uh={key:0,class:"archive folder-item"},ph={key:0,class:"modal"},hh={class:"modal-content"},mh={class:"input-group"},vh=["placeholder"],kh={class:"input-info"},gh={key:0,class:"error-message"},fh={class:"modal-actions"},yh={key:1,class:"modal"},Lh={class:"modal-content"},bh={class:"modal-actions"},Ch={key:2,class:"modal"},_h={class:"modal-content"},wh={class:"input-group"},Eh={class:"input-info"},Dh={key:0,class:"error-message"},jh={key:0,class:"selected-file"},Sh={class:"modal-actions"};function Fh(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",Jp,[(0,o.Lk)("div",Gp,[(0,o.Lk)("div",Hp,[(0,o.Lk)("div",Yp,[r.currentFolder?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>n.goBack&&n.goBack(...e)),class:"back-button"},t[17]||(t[17]=[(0,o.Lk)("img",{src:ye,alt:"back",class:"action-icon"},null,-1)]))):(0,o.Q3)("",!0),(0,o.Lk)("h3",null,(0,l.v_)(r.currentFolder?r.currentFolder.name:"Рабочие данные"),1)]),(0,o.Lk)("div",Zp,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.selectedProjectUuid=e),onChange:t[2]||(t[2]=(...e)=>n.handleProjectChange&&n.handleProjectChange(...e))},[t[18]||(t[18]=(0,o.Lk)("option",{value:""},"Все проекты",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.inProgressProjects,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.uuid,value:e.uuid},(0,l.v_)(e.name),9,eh)))),128))],544),[[i.u1,r.selectedProjectUuid]])]),(0,o.Lk)("div",th,[(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>n.startEditMode&&n.startEditMode(...e)),class:(0,l.C4)([{active:r.isEditMode},"action-button"])},t[19]||(t[19]=[(0,o.Lk)("img",{src:Op,alt:"edit",class:"action-icon"},null,-1)]),2),(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>n.openCreateModal&&n.openCreateModal(...e)),class:"action-button"},t[20]||(t[20]=[(0,o.Lk)("img",{src:gt,alt:"add",class:"action-icon"},null,-1)])),r.currentFolder?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[5]||(t[5]=(...e)=>n.openFileUpload&&n.openFileUpload(...e)),class:"action-button"},t[21]||(t[21]=[(0,o.Lk)("img",{src:Vp,alt:"upload",class:"action-icon"},null,-1)]))):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>n.startDeleteMode&&n.startDeleteMode(...e)),class:(0,l.C4)([{active:r.isDeleteMode},"action-button"])},t[22]||(t[22]=[(0,o.Lk)("img",{src:zp,alt:"delete",class:"action-icon"},null,-1)]),2)])]),(0,o.Lk)("div",sh,[(0,o.Lk)("ul",ah,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.folders,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id,class:(0,l.C4)(["folder-item",{"folder-item--edit":r.isEditMode,"folder-item--delete":r.isDeleteMode}]),onClick:t=>n.handleFolderClick(e)},[(0,o.Lk)("div",lh,[t[23]||(t[23]=(0,o.Lk)("img",{src:bt,alt:"folder",class:"folder-icon"},null,-1)),(0,o.Lk)("span",ih,(0,l.v_)(e.name),1)])],10,oh)))),128)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.files,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id,class:(0,l.C4)(["folder-item file-item",{"folder-item--edit":r.isEditMode,"folder-item--delete":r.isDeleteMode}]),onClick:t=>n.handleFileClick(e)},[(0,o.Lk)("div",nh,[t[24]||(t[24]=(0,o.Lk)("img",{src:Et,alt:"file",class:"folder-icon"},null,-1)),(0,o.Lk)("span",ch,(0,l.v_)(e.name),1),r.isEditMode||r.isDeleteMode?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("img",dh))])],10,rh)))),128)),r.currentFolder?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("li",uh,t[25]||(t[25]=[(0,o.Lk)("div",{class:"folder-content"},[(0,o.Lk)("img",{src:bt,alt:"folder",class:"folder-icon"}),(0,o.Lk)("span",{class:"folder-name"},"Архив")],-1)])))])])]),r.showModal?((0,o.uX)(),(0,o.CE)("div",ph,[(0,o.Lk)("div",hh,[(0,o.Lk)("h3",null,(0,l.v_)(r.isEditing?"Редактировать "+(r.selectedFolder?"file"in r.selectedFolder?"файл":"папку":"элемент"):"Создать папку"),1),(0,o.Lk)("div",mh,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>r.folderName=e),type:"text",placeholder:r.selectedFolder&&"file"in r.selectedFolder?"Название файла":"Название папки",onKeyup:t[8]||(t[8]=(0,i.jR)(((...e)=>n.saveFolder&&n.saveFolder(...e)),["enter"])),maxlength:"50",class:(0,l.C4)({"input-error":r.showError})},null,42,vh),[[i.Jo,r.folderName]]),(0,o.Lk)("div",kh,[r.showError?((0,o.uX)(),(0,o.CE)("span",gh," Пожалуйста, введите название "+(0,l.v_)(r.selectedFolder&&"file"in r.selectedFolder?"файла":"папки"),1)):(0,o.Q3)("",!0),(0,o.Lk)("span",{class:(0,l.C4)(["char-counter",{"char-counter--limit":r.folderName.length>=50}])},(0,l.v_)(r.folderName.length)+"/50 ",3)])]),(0,o.Lk)("div",fh,[(0,o.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>n.saveFolder&&n.saveFolder(...e))},"Сохранить"),(0,o.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>n.closeModal&&n.closeModal(...e))},"Отмена")])])])):(0,o.Q3)("",!0),r.showDeleteConfirm?((0,o.uX)(),(0,o.CE)("div",yh,[(0,o.Lk)("div",Lh,[t[26]||(t[26]=(0,o.Lk)("h3",null,"Подтвердите удаление",-1)),(0,o.Lk)("p",null," Вы уверены, что хотите удалить "+(0,l.v_)(r.selectedFolder?"file"in r.selectedFolder?"файл":"папку":"элемент")+' "'+(0,l.v_)(r.selectedFolder?.name)+'"? ',1),(0,o.Lk)("div",bh,[(0,o.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>n.deleteFolder&&n.deleteFolder(...e))},"Удалить"),(0,o.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>n.cancelDelete&&n.cancelDelete(...e))},"Отмена")])])])):(0,o.Q3)("",!0),(0,o.Lk)("input",{type:"file",ref:"fileInput",onChange:t[13]||(t[13]=(...e)=>n.handleFileUpload&&n.handleFileUpload(...e)),style:{display:"none"}},null,544),r.showUploadModal?((0,o.uX)(),(0,o.CE)("div",Ch,[(0,o.Lk)("div",_h,[t[27]||(t[27]=(0,o.Lk)("h3",null,"Загрузить файл",-1)),(0,o.Lk)("div",wh,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>r.uploadFileName=e),type:"text",placeholder:"Название файла",class:(0,l.C4)({"input-error":r.showError})},null,2),[[i.Jo,r.uploadFileName]]),(0,o.Lk)("div",Eh,[r.showError?((0,o.uX)(),(0,o.CE)("span",Dh," Пожалуйста, введите название файла ")):(0,o.Q3)("",!0)])]),r.selectedFile?((0,o.uX)(),(0,o.CE)("div",jh," Выбранный файл: "+(0,l.v_)(r.selectedFile.name),1)):(0,o.Q3)("",!0),(0,o.Lk)("div",Sh,[(0,o.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>n.uploadFile&&n.uploadFile(...e))},"Загрузить"),(0,o.Lk)("button",{onClick:t[16]||(t[16]=(...e)=>n.cancelUpload&&n.cancelUpload(...e))},"Отмена")])])])):(0,o.Q3)("",!0)])}var Xh={setup(){const e=Ol();return{projectStore:e}},data(){return{folders:[],selectedFolder:null,showModal:!1,showDeleteConfirm:!1,folderName:"",isEditing:!1,isDeleteMode:!1,isEditMode:!1,inProgressProjects:[],showError:!1,currentFolder:null,folderHistory:[],isNavigating:!1,files:[],showUploadModal:!1,uploadFileName:"",selectedFile:null,selectedProjectUuid:"",filteredFolders:[]}},methods:{async getInProgressProjects(){try{const e=this.projectStore.getProjects;console.log("Все проекты:",e),this.inProgressProjects=e.filter((e=>"in_progress"===e.status)),console.log("Проекты в работе:",this.inProgressProjects),await this.getAllProjectsFolders()}catch(e){console.error("Ошибка при получении проектов:",e)}},async getAllProjectsFolders(){try{if(!this.inProgressProjects.length)return;let e=this.selectedProjectUuid?[this.inProgressProjects.find((e=>e.uuid===this.selectedProjectUuid))]:this.inProgressProjects;const t=e.map((e=>ge.A.get(`api/folders/projects/${e.uuid}/folders/`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}).then((t=>t.data.filter((e=>null===e.parent)).map((t=>({...t,project_uuid:e.uuid,project_name:e.name}))))))),s=await Promise.all(t);this.folders=s.flat(),console.log("Полученные корневые папки:",this.folders)}catch(e){console.error("Ошибка при получении папок:",e),this.folders=[]}},startEditMode(){console.log("Включение режима редактирования"),this.isDeleteMode&&(this.isDeleteMode=!1),this.isEditMode=!this.isEditMode,this.isEditMode||(this.selectedFolder=null)},startDeleteMode(){console.log("Включение режима удаления"),this.isEditMode&&(this.isEditMode=!1),this.isDeleteMode=!this.isDeleteMode,this.isDeleteMode||(this.selectedFolder=null)},openCreateModal(){console.log("Открытие модального окна создания"),this.showModal=!0,this.isEditing=!1,this.folderName=""},handleFolderClick(e){console.log("Клик по папке:",e),this.isEditMode||this.isDeleteMode?this.isDeleteMode?(this.selectedFolder=e,this.showDeleteConfirm=!0):this.isEditMode&&(this.selectedFolder=e,this.folderName=e.name,this.isEditing=!0,this.showModal=!0):this.navigateToFolder(e)},async navigateToFolder(e){try{this.isNavigating=!0,console.log("Переход в папку:",e);const s=await ge.A.get(`api/folders/projects/${e.project_uuid}/folders/`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(console.log("Ответ от сервера:",s.data),this.currentFolder=e,this.folders=[],this.files=[],s.data){const a=s.data.filter((t=>t.parent===e.id));this.folders=a.map((t=>({...t,project_uuid:e.project_uuid,type:"folder"})));try{const t=await ge.A.get(`api/folders/projects/${e.project_uuid}/folders/${e.id}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});t.data&&t.data.files&&(this.files=t.data.files.map((t=>({...t,project_uuid:e.project_uuid,type:"file"}))))}catch(t){console.error("Ошибка при получении файлов:",t)}}console.log("Папки в текущей директории:",this.folders),console.log("Файлы в текущей директории:",this.files)}catch(t){console.error("Ошибка при получении содержимого папки:",t),console.error("Детали ошибки:",{message:t.message,response:t.response?.data,status:t.response?.status})}finally{this.isNavigating=!1}},async goBack(){try{if(!this.currentFolder)return;if(null===this.currentFolder.parent)this.currentFolder=null,this.folders=[],this.files=[],await this.getInProgressProjects();else{const e=await ge.A.get(`api/folders/projects/${this.currentFolder.project_uuid}/folders/${this.currentFolder.parent}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),t={...e.data,project_uuid:this.currentFolder.project_uuid};await this.navigateToFolder(t)}}catch(e){console.error("Ошибка при возврате назад:",e)}},closeModal(){this.showModal=!1,this.folderName="",this.isEditing=!1,this.showError=!1},cancelDelete(){this.showDeleteConfirm=!1,this.selectedFolder=null},saveFolder(){this.folderName.trim()?(this.showError=!1,this.isEditing?this.updateFolder():this.createFolder()):this.showError=!0},async createFolder(){try{if(!this.folderName.trim())return void alert("Пожалуйста, введите название папки");if(!this.inProgressProjects.length)return void console.error("Нету доступных проектов");const e=this.currentFolder?{uuid:this.currentFolder.project_uuid}:this.inProgressProjects[0];console.log("Создание папки в проекте:",e);const t=this.currentFolder?`api/folders/projects/${e.uuid}/folders/${this.currentFolder.id}/create_subfolder/`:`api/folders/projects/${e.uuid}/folders/`,s=this.currentFolder?{name:this.folderName.trim()}:{name:this.folderName.trim(),folder_type:"WORKING",parent:null};console.log("URL запроса:",t),console.log("Отправляемые данные:",s);const a=await ge.A.post(t,s,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"application/json"}});console.log("Ответ при создании папки:",a.data),this.currentFolder?await this.navigateToFolder(this.currentFolder):await this.getAllProjectsFolders(),this.closeModal()}catch(e){console.error("Ошибка при создании папки:",e),console.error("Детали ошибки:",{response:e.response?.data,status:e.response?.status,message:e.message}),alert("Не удалось создать папку. Попробуйте позже.")}},async updateFolder(){let e={};try{if(!this.folderName.trim())return void alert("Пожалуйста, введите название");if(!this.selectedFolder)return void console.error("Элемент не выбран");let t=this.folderName.trim();if("file"in this.selectedFolder){const e=this.selectedFolder.name.split(".").pop();t=`${t}.${e}`}const s=this.inProgressProjects.find((e=>e.uuid===this.selectedFolder.project_uuid));if(!s)return void console.error("Проект не найден");const a="file"in this.selectedFolder,o=a?"files":"folders";e={name:t,...a?{}:{folder_type:this.selectedFolder.folder_type||"WORKING",parent:this.selectedFolder.parent}},await ge.A.put(`api/folders/projects/${s.uuid}/${o}/${this.selectedFolder.id}/`,e,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"application/json"}}),this.currentFolder?await this.navigateToFolder(this.currentFolder):await this.getAllProjectsFolders(),this.closeModal()}catch(t){console.error("Ошибка при обновлении:",t),console.error("Детали ошибки:",{response:t.response?.data,status:t.response?.status,message:t.message,requestData:e}),alert("Не удалось обновить. Попробуйте позже.")}},async deleteFolder(){try{if(!this.selectedFolder)return void console.error("Элемент не выбран");const e=this.inProgressProjects.find((e=>e.uuid===this.selectedFolder.project_uuid));if(!e)return void console.error("Проект не найден");const t="file"in this.selectedFolder,s=t?`api/folders/projects/${e.uuid}/folders/${this.currentFolder.id}/files/${this.selectedFolder.id}/`:`api/folders/projects/${e.uuid}/folders/${this.selectedFolder.id}/`;console.log(`Удаление ${t?"файла":"папки"}:`,s),await ge.A.delete(s,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),this.currentFolder?await this.navigateToFolder(this.currentFolder):await this.getAllProjectsFolders(),this.selectedFolder=null,this.showDeleteConfirm=!1,this.isDeleteMode=!1}catch(e){console.error("Ошибка при удалении:",e),console.error("Детали ошибки:",{response:e.response?.data,status:e.response?.status,message:e.message}),alert(`Не удалось удалить ${"file"in this.selectedFolder?"файл":"папку"}. Попробуйте позже.`)}},async downloadFile(e){try{const t=document.createElement("a");t.href=e.file,t.setAttribute("download",e.name);const s=new URL(e.file);s.searchParams.append("token",localStorage.getItem("accessToken")),t.href=s.toString(),document.body.appendChild(t),t.click(),t.remove()}catch(t){console.error("Ошибка при скачивании файла:",t),alert("Не удалось скачать файл. Попробуйте позже.")}},handleFileClick(e){this.isEditMode?(this.selectedFolder=e,this.folderName=e.name.split(".").slice(0,-1).join("."),this.isEditing=!0,this.showModal=!0):this.isDeleteMode?(this.selectedFolder=e,this.showDeleteConfirm=!0):this.downloadFile(e)},openFileUpload(){this.$refs.fileInput.click()},handleFileUpload(e){const t=e.target.files[0];t&&(this.selectedFile=t,this.uploadFileName=t.name,this.showUploadModal=!0),e.target.value=""},cancelUpload(){this.showUploadModal=!1,this.uploadFileName="",this.selectedFile=null,this.showError=!1},async uploadFile(){if(this.selectedFile)try{const e=new FormData,t=new Blob([this.selectedFile],{type:this.selectedFile.type||"application/octet-stream"});e.append("file",t,this.selectedFile.name),e.append("name",this.uploadFileName||this.selectedFile.name),console.log("Содержимое FormData:");for(const[a,o]of e.entries())o instanceof Blob?console.log(`${a}: Blob/File {\n              name: ${o.name||"unnamed"},\n              size: ${o.size},\n              type: ${o.type||"application/octet-stream"}\n            }`):console.log(`${a}: ${o}`);const s=await ge.A.post(`api/folders/projects/${this.currentFolder.project_uuid}/folders/${this.currentFolder.id}/files/`,e,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"multipart/form-data"}});console.log("Ответ сервера:",s.data),await this.navigateToFolder(this.currentFolder),this.cancelUpload()}catch(e){console.error("Ошибка загрузки файла:",e.response||e.message),alert("Не удалось загрузить файл. Попробуйте позже.")}else alert("Выберите файл для загрузки")},async handleProjectChange(){this.currentFolder&&(this.currentFolder=null,this.files=[]),await this.getAllProjectsFolders()}},watch:{"projectStore.projects":{handler(){console.log("Изменение списка проектов"),this.getInProgressProjects()},immediate:!0}},created(){console.log("Компонент WorkData создан"),this.projectStore.fetchProjects().then((()=>{this.getInProgressProjects()}))},mounted(){console.log("Компонент WorkData смонтирован");const e=localStorage.getItem("accessToken");console.log("Токен доступа существует:",!!e)}};const Ih=(0,it.A)(Xh,[["render",Fh],["__scopeId","data-v-739c3ea2"]]);var Ph=Ih;const Mh={class:"inspector-container"},Th={class:"inspector"},Ah={class:"logs-container"},Nh={class:"log-header"},xh={class:"log-date"},Uh={class:"log-time"},$h={class:"log-action"},Kh={class:"log-project"};function Rh(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",Mh,[(0,o.Lk)("div",Th,[t[0]||(t[0]=(0,o.Lk)("div",{class:"header"},[(0,o.Lk)("h3",null,"Инспектор")],-1)),(0,o.Lk)("div",Ah,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.formattedLogs,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"log-entry"},[(0,o.Lk)("div",Nh,[(0,o.Lk)("span",xh,(0,l.v_)(e.date),1),(0,o.Lk)("span",Uh,(0,l.v_)(e.time),1)]),(0,o.Lk)("p",$h,(0,l.v_)(e.description),1),(0,o.Lk)("div",Kh,"Проект: "+(0,l.v_)(e.project_name),1)])))),128))])])])}var Wh={data(){return{logs:[]}},computed:{formattedLogs(){return this.logs.map((e=>{const t=new Date(e.created_at);return{...e,date:t.toLocaleDateString("ru-RU",{day:"numeric",month:"long"}),time:t.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}}))}},async created(){try{const e=await fetch("api/folders/logs/",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),t=await e.json();console.log("Полученные логи:",t),this.logs=t}catch(e){console.error("Ошибка при получении логов:",e)}}};const Qh=(0,it.A)(Wh,[["render",Rh],["__scopeId","data-v-716ce595"]]);var Bh=Qh;const Oh={class:"mobile-investments"};function Vh(e,t,s,a,l,i){const r=(0,o.g2)("MobileWorkData"),n=(0,o.g2)("MobileInspector");return(0,o.uX)(),(0,o.CE)("div",Oh,[(0,o.bF)(r),(0,o.bF)(n)])}const zh={class:"mobile-work-data"},qh={class:"folders-container"},Jh={key:0,class:"empty-state"},Gh={key:1,class:"folders-list"},Hh={class:"folder-content"},Yh={class:"folder-name"};function Zh(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",zh,[t[2]||(t[2]=(0,o.Lk)("div",{class:"header"},[(0,o.Lk)("h3",null,"Рабочие данные")],-1)),(0,o.Lk)("div",qh,[0===i.folders.length?((0,o.uX)(),(0,o.CE)("div",Jh,t[0]||(t[0]=[(0,o.Lk)("img",{src:bt,alt:"No folders",class:"empty-icon"},null,-1),(0,o.Lk)("p",null,"Нет папок в проекте",-1)]))):((0,o.uX)(),(0,o.CE)("ul",Gh,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.folders,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id,class:"folder-item"},[(0,o.Lk)("div",Hh,[t[1]||(t[1]=(0,o.Lk)("img",{src:bt,alt:"folder",class:"folder-icon"},null,-1)),(0,o.Lk)("span",Yh,(0,l.v_)(e.name),1)])])))),128))]))])])}var em={name:"MobileWorkData",data(){return{folders:[]}}};const tm=(0,it.A)(em,[["render",Zh],["__scopeId","data-v-874e749e"]]);var sm=tm;const am={class:"mobile-inspector"},om={class:"logs-container"},lm={key:0,class:"empty-state"},im={class:"log-header"},rm={class:"log-date"},nm={class:"log-description"};function cm(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",am,[t[1]||(t[1]=(0,o.Lk)("div",{class:"header"},[(0,o.Lk)("h3",null,"Инспектор")],-1)),(0,o.Lk)("div",om,[0===i.logs.length?((0,o.uX)(),(0,o.CE)("div",lm,t[0]||(t[0]=[(0,o.Lk)("img",{src:_t,alt:"No logs",class:"empty-icon"},null,-1),(0,o.Lk)("p",null,"Нет данных в инспекторе",-1)]))):((0,o.uX)(!0),(0,o.CE)(o.FK,{key:1},(0,o.pI)(i.logs,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"log-item"},[(0,o.Lk)("div",im,[(0,o.Lk)("span",rm,(0,l.v_)(r.formatDate(e.created_at)),1)]),(0,o.Lk)("p",nm,(0,l.v_)(e.description),1)])))),128))])])}var dm={name:"MobileInspector",data(){return{logs:[]}},methods:{formatDate(e){return new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long"})}}};const um=(0,it.A)(dm,[["render",cm],["__scopeId","data-v-2e88cf9c"]]);var pm=um,hm={name:"MobileInvestments",components:{MobileWorkData:sm,MobileInspector:pm}};const mm=(0,it.A)(hm,[["render",Vh],["__scopeId","data-v-5dcb3dc1"]]);var vm=mm,km={components:{WorkData:Ph,Inspector:Bh,MobileInvestments:vm},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}}};const gm=(0,it.A)(km,[["render",Bp],["__scopeId","data-v-dceb9210"]]);var fm=gm;const ym={class:"main-page"};function Lm(e,t){return(0,o.uX)(),(0,o.CE)("div",ym,t[0]||(t[0]=[(0,o.Lk)("div",{class:"no-projects"},"Магазин находится в разработке",-1)]))}const bm={},Cm=(0,it.A)(bm,[["render",Lm],["__scopeId","data-v-5d01ed36"]]);var _m=Cm;const wm={key:1,class:"main-page"};function Em(e,t,s,a,l,i){const r=(0,o.g2)("MobileProfile"),n=(0,o.g2)("Profile",!0);return(0,o.uX)(),(0,o.CE)("div",null,[a.isMobile?((0,o.uX)(),(0,o.Wv)(r,{key:0})):((0,o.uX)(),(0,o.CE)("div",wm,[(0,o.bF)(n)]))])}const Dm={class:"profile-page"},jm={class:"profile-header"},Sm={key:0,class:"profile-section"},Fm={class:"profile-grid"},Xm={class:"personal-info-block"},Im={class:"photo-upload"},Pm={class:"circle"},Mm=["src"],Tm={key:1},Am={class:"photo-name"},Nm={class:"full-name"},xm={class:"specialty"},Um={class:"professional-info-block"},$m={class:"personal-info"},Km={key:0,class:"documents-group"},Rm={key:1,class:"profile-section"},Wm={class:"photo-upload"},Qm={class:"circle"},Bm=["src"],Om={key:1},Vm={class:"info-group"},zm={key:0,class:"documents-group"},qm={class:"activity-chart"},Jm={class:"chart-container"},Gm={class:"activity-bars"};function Hm(e,t,s,a,i,r){const n=(0,o.g2)("router-link"),c=(0,o.g2)("DocumentItem");return(0,o.uX)(),(0,o.CE)("div",Dm,[(0,o.Lk)("h2",jm,[(0,o.bF)(n,{to:"/dashboard",class:"icon-link"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.Lk)("img",{src:ye,alt:"Назад"},null,-1)]))),_:1}),t[1]||(t[1]=(0,o.eW)(" Ваш профиль "))]),a.isPhysicalProfile?((0,o.uX)(),(0,o.CE)("div",Sm,[(0,o.Lk)("div",Fm,[(0,o.Lk)("div",Xm,[(0,o.Lk)("div",Im,[(0,o.Lk)("div",Pm,[a.profileStore.profileData.physical_profile&&a.profileStore.profileData.physical_profile.photo?((0,o.uX)(),(0,o.CE)("img",{key:0,src:a.profileStore.profileData.physical_profile.photo,alt:"Фото пользователя",class:"preview-image"},null,8,Mm)):((0,o.uX)(),(0,o.CE)("span",Tm,"Нет фото"))])]),(0,o.Lk)("div",Am,[(0,o.Lk)("p",Nm,(0,l.v_)(a.fullName),1),(0,o.Lk)("p",xm,(0,l.v_)(a.profileStore.getSpecialtyName||"Специальность не указана"),1)])]),(0,o.Lk)("div",Um,[t[9]||(t[9]=(0,o.Lk)("h3",null,"Персональная информация",-1)),(0,o.Lk)("div",$m,[(0,o.Lk)("p",null,[t[2]||(t[2]=(0,o.Lk)("strong",null,"ФИО:",-1)),(0,o.Lk)("span",null,(0,l.v_)(a.fullName),1)]),(0,o.Lk)("p",null,[t[3]||(t[3]=(0,o.Lk)("strong",null,"Почта:",-1)),(0,o.Lk)("span",null,(0,l.v_)(a.profileStore.profileData.email||"Не указано"),1)]),(0,o.Lk)("p",null,[t[4]||(t[4]=(0,o.Lk)("strong",null,"ИИН:",-1)),(0,o.Lk)("span",null,(0,l.v_)(a.profileStore.profileData.physical_profile?.iin||"Не указано"),1)]),(0,o.Lk)("p",null,[t[5]||(t[5]=(0,o.Lk)("strong",null,"Номер телефона:",-1)),(0,o.Lk)("span",null,(0,l.v_)(a.profileStore.profileData.physical_profile?.phone||"Не указано"),1)]),(0,o.Lk)("p",null,[t[6]||(t[6]=(0,o.Lk)("strong",null,"Опыт работы:",-1)),(0,o.Lk)("span",null,(0,l.v_)(a.profileStore.getExperienceName),1)]),(0,o.Lk)("p",null,[t[7]||(t[7]=(0,o.Lk)("strong",null,"Образование:",-1)),(0,o.Lk)("span",null,(0,l.v_)(a.profileStore.getEducationName),1)]),(0,o.Lk)("p",null,[t[8]||(t[8]=(0,o.Lk)("strong",null,"Знание программ:",-1)),(0,o.Lk)("span",null,(0,l.v_)(a.profileStore.selectedProgramsNames||"Программы не указаны"),1)])])])]),a.profileStore.profileData.physical_profile?((0,o.uX)(),(0,o.CE)("div",Km,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.physicalDocuments,(e=>((0,o.uX)(),(0,o.Wv)(c,{key:e.fileName,label:e.label,fileName:e.fileName,baseDownloadUrl:a.profileStore.baseDownloadUrl,downloadFile:a.profileStore.downloadFile,profileData:a.profileStore.profileData,profileType:a.profileStore.profileType},null,8,["label","fileName","baseDownloadUrl","downloadFile","profileData","profileType"])))),128))])):(0,o.Q3)("",!0)])):a.isLegalProfile?((0,o.uX)(),(0,o.CE)("div",Rm,[(0,o.Lk)("div",Wm,[(0,o.Lk)("div",Qm,[a.profileStore.profileData.legal_profile&&a.profileStore.profileData.legal_profile.photo_company?((0,o.uX)(),(0,o.CE)("img",{key:0,src:a.profileStore.profileData.legal_profile.photo_company,alt:"Фото компании",class:"preview-image"},null,8,Bm)):((0,o.uX)(),(0,o.CE)("span",Om,"Нет фото компании"))])]),(0,o.Lk)("div",Vm,[(0,o.Lk)("p",null,[t[10]||(t[10]=(0,o.Lk)("strong",null,"Email:",-1)),(0,o.eW)(" "+(0,l.v_)(a.profileStore.profileData.email||"Не указано"),1)]),(0,o.Lk)("p",null,[t[11]||(t[11]=(0,o.Lk)("strong",null,"Название компании:",-1)),(0,o.eW)(" "+(0,l.v_)(a.profileStore.getCompanyName),1)]),(0,o.Lk)("p",null,[t[12]||(t[12]=(0,o.Lk)("strong",null,"БИН:",-1)),(0,o.eW)(" "+(0,l.v_)(a.profileStore.getBin),1)]),(0,o.Lk)("p",null,[t[13]||(t[13]=(0,o.Lk)("strong",null,"Форма юридического лица:",-1)),(0,o.eW)(" "+(0,l.v_)(a.profileStore.getLegalEntityTypeName),1)]),(0,o.Lk)("p",null,[t[14]||(t[14]=(0,o.Lk)("strong",null,"Категория:",-1)),(0,o.eW)(" "+(0,l.v_)(a.profileStore.getCategoryName),1)])]),a.profileStore.profileData.legal_profile?((0,o.uX)(),(0,o.CE)("div",zm,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.legalDocuments,(e=>((0,o.uX)(),(0,o.Wv)(c,{key:e.fileName,label:e.label,fileName:e.fileName,baseDownloadUrl:a.profileStore.baseDownloadUrl,downloadFile:a.profileStore.downloadFile,profileData:a.profileStore.profileData,profileType:a.profileStore.profileType},null,8,["label","fileName","baseDownloadUrl","downloadFile","profileData","profileType"])))),128))])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0),t[18]||(t[18]=(0,o.Fv)('<div class="statistics-row" data-v-3bbba878><div class="stat-block" data-v-3bbba878><div class="stat-value" data-v-3bbba878>45<span class="stat-unit" data-v-3bbba878>мин</span></div><div class="stat-label" data-v-3bbba878>Среднее время отклика</div></div><div class="stat-block" data-v-3bbba878><div class="stat-value" data-v-3bbba878>3</div><div class="stat-label" data-v-3bbba878>Завершенных проектов за год</div></div><div class="stat-block" data-v-3bbba878><div class="stat-value" data-v-3bbba878>4<span class="stat-unit" data-v-3bbba878>мес.</span></div><div class="stat-label" data-v-3bbba878>Среднее время на проект</div></div><div class="stat-block" data-v-3bbba878><div class="stat-value" data-v-3bbba878>A</div><div class="stat-label" data-v-3bbba878>Максимальная сложность проекта</div></div><div class="stat-block" data-v-3bbba878><div class="stat-value" data-v-3bbba878>11</div><div class="stat-label" data-v-3bbba878>Всего завершенных проектов</div></div></div>',1)),(0,o.Lk)("div",qm,[t[16]||(t[16]=(0,o.Lk)("h3",null,"Активность",-1)),t[17]||(t[17]=(0,o.Lk)("div",{class:"period-switches"},[(0,o.Lk)("button",{class:"period-switch"},"за сутки"),(0,o.Lk)("button",{class:"period-switch active"},"за неделю"),(0,o.Lk)("button",{class:"period-switch"},"за месяц")],-1)),(0,o.Lk)("div",Jm,[(0,o.Lk)("div",Gm,[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(24,(e=>(0,o.Lk)("div",{key:e,class:"activity-bar",style:(0,l.Tr)({height:a.getRandomHeight()+"%"})},null,4))),64))]),t[15]||(t[15]=(0,o.Lk)("div",{class:"time-labels"},[(0,o.Lk)("span",null,"00"),(0,o.Lk)("span",null,"06"),(0,o.Lk)("span",null,"12"),(0,o.Lk)("span",null,"18"),(0,o.Lk)("span",null,"23")],-1))])])])}const Ym={class:"document-item"},Zm={class:"document-info"},ev={class:"document-label"},tv={class:"document-actions"},sv={key:1,class:"no-file"};function av(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",Ym,[(0,o.Lk)("div",Zm,[(0,o.Lk)("div",ev,(0,l.v_)(s.label),1)]),(0,o.Lk)("div",tv,[r.isDocumentAvailable?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"btn-download",onClick:t[0]||(t[0]=(...e)=>r.downloadDocument&&r.downloadDocument(...e))}," Скачать ")):((0,o.uX)(),(0,o.CE)("span",sv,"Нет файла"))])])}var ov={props:{label:String,fileName:String,baseDownloadUrl:String,downloadFile:Function,profileData:Object,profileType:String},computed:{isDocumentAvailable(){return this.profileData?.[`${this.profileType}_profile`]?.[this.fileName]},documentUrl(){return this.isDocumentAvailable?`${this.baseDownloadUrl}/${this.profileData[`${this.profileType}_profile`][this.fileName]}`:null}},methods:{downloadDocument(){this.isDocumentAvailable&&this.downloadFile(this.fileName)}}};const lv=(0,it.A)(ov,[["render",av],["__scopeId","data-v-7aa2a8a5"]]);var iv=lv,rv={components:{DocumentItem:iv},setup(){const e=zt(),t=(0,a.rd)();(0,o.sV)((async()=>{e.accessToken=localStorage.getItem("accessToken"),e.accessToken?(e.setupAxios(),await e.fetchUserProfile()):t.push("/landing")}));const s=(0,o.EW)((()=>{const{last_name:t,first_name:s,middle_name:a}=e.profileData.physical_profile||{};return[t,s,a].filter(Boolean).join(" ")||"Не указано"})),l=(0,o.EW)((()=>"physical"===e.profileType)),i=(0,o.EW)((()=>"legal"===e.profileType)),r=[{label:"Скан удостоверения личности",fileName:"scan_of_ID"},{label:"Фото с удостоверением личности",fileName:"person_with_ID"}],n=[{label:"Лицензия",fileName:"license"},{label:"Аккредитация",fileName:"accreditation"},{label:"Проект",fileName:"project"},{label:"Портфолио",fileName:"portfolio"},{label:"Акты завершения",fileName:"completion_acts"},{label:"Подтверждение экспертизы",fileName:"expertise_confirmation"}],c=()=>Math.floor(80*Math.random())+5;return{profileStore:e,fullName:s,isPhysicalProfile:l,isLegalProfile:i,physicalDocuments:r,legalDocuments:n,getRandomHeight:c}}};const nv=(0,it.A)(rv,[["render",Hm],["__scopeId","data-v-3bbba878"]]);var cv=nv;const dv={class:"mobile-profile"},uv={class:"profile-header"},pv={class:"photo-container"},hv={class:"photo-circle"},mv=["src"],vv={key:1},kv={class:"user-info"},gv={class:"specialty"},fv={class:"info-section"},yv={class:"info-list"},Lv={class:"info-item"},bv={class:"value"},Cv={class:"info-item"},_v={class:"value"},wv={class:"info-item"},Ev={class:"value"},Dv={class:"info-item"},jv={class:"value"},Sv={class:"info-item"},Fv={class:"value"},Xv={key:0,class:"documents-section"},Iv={class:"documents-list"},Pv={class:"logout-section"};function Mv(e,t,s,a,i,r){const n=(0,o.g2)("DocumentItem");return(0,o.uX)(),(0,o.CE)("div",dv,[(0,o.Lk)("div",uv,[(0,o.Lk)("div",pv,[(0,o.Lk)("div",hv,[a.profileStore.profileData.physical_profile?.photo?((0,o.uX)(),(0,o.CE)("img",{key:0,src:a.profileStore.profileData.physical_profile.photo,alt:"Фото пользователя"},null,8,mv)):((0,o.uX)(),(0,o.CE)("span",vv,"Нет фото"))]),(0,o.Lk)("div",kv,[(0,o.Lk)("h2",null,(0,l.v_)(a.fullName),1),(0,o.Lk)("p",gv,(0,l.v_)(a.profileStore.getSpecialtyName||"Специальность не указана"),1)])])]),t[9]||(t[9]=(0,o.Fv)('<div class="stats-container" data-v-63d88a6e><div class="stat-item" data-v-63d88a6e><div class="stat-value" data-v-63d88a6e>45<span data-v-63d88a6e>мин</span></div><div class="stat-label" data-v-63d88a6e>Время отклика</div></div><div class="stat-item" data-v-63d88a6e><div class="stat-value" data-v-63d88a6e>3</div><div class="stat-label" data-v-63d88a6e>Проектов за год</div></div><div class="stat-item" data-v-63d88a6e><div class="stat-value" data-v-63d88a6e>11</div><div class="stat-label" data-v-63d88a6e>Всего проектов</div></div></div>',1)),(0,o.Lk)("div",fv,[t[6]||(t[6]=(0,o.Lk)("h3",null,"Персональная информация",-1)),(0,o.Lk)("div",yv,[(0,o.Lk)("div",Lv,[t[1]||(t[1]=(0,o.Lk)("span",{class:"label"},"Email",-1)),(0,o.Lk)("span",bv,(0,l.v_)(a.profileStore.profileData.email||"Не указано"),1)]),(0,o.Lk)("div",Cv,[t[2]||(t[2]=(0,o.Lk)("span",{class:"label"},"Телефон",-1)),(0,o.Lk)("span",_v,(0,l.v_)(a.profileStore.profileData.physical_profile?.phone||"Не указано"),1)]),(0,o.Lk)("div",wv,[t[3]||(t[3]=(0,o.Lk)("span",{class:"label"},"ИИН",-1)),(0,o.Lk)("span",Ev,(0,l.v_)(a.profileStore.profileData.physical_profile?.iin||"Не указано"),1)]),(0,o.Lk)("div",Dv,[t[4]||(t[4]=(0,o.Lk)("span",{class:"label"},"Опыт работы",-1)),(0,o.Lk)("span",jv,(0,l.v_)(a.profileStore.getExperienceName),1)]),(0,o.Lk)("div",Sv,[t[5]||(t[5]=(0,o.Lk)("span",{class:"label"},"Образование",-1)),(0,o.Lk)("span",Fv,(0,l.v_)(a.profileStore.getEducationName),1)])])]),a.profileStore.profileData.physical_profile?((0,o.uX)(),(0,o.CE)("div",Xv,[t[7]||(t[7]=(0,o.Lk)("h3",null,"Документы",-1)),(0,o.Lk)("div",Iv,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.documents,(e=>((0,o.uX)(),(0,o.Wv)(n,{key:e.fileName,label:e.label,fileName:e.fileName,baseDownloadUrl:a.profileStore.baseDownloadUrl,downloadFile:a.profileStore.downloadFile,profileData:a.profileStore.profileData,profileType:a.profileStore.profileType},null,8,["label","fileName","baseDownloadUrl","downloadFile","profileData","profileType"])))),128))])])):(0,o.Q3)("",!0),(0,o.Lk)("div",Pv,[(0,o.Lk)("button",{class:"logout-button",onClick:t[0]||(t[0]=(...e)=>a.handleLogout&&a.handleLogout(...e))},t[8]||(t[8]=[(0,o.Lk)("img",{src:ts,alt:"Выйти"},null,-1),(0,o.Lk)("span",null,"Выйти",-1)]))])])}var Tv={components:{DocumentItem:iv},setup(){const e=zt(),t=(0,a.rd)();(0,o.sV)((async()=>{e.accessToken=localStorage.getItem("accessToken"),e.accessToken?(e.setupAxios(),await e.fetchUserProfile()):t.push("/landing")}));const s=(0,o.EW)((()=>{const{last_name:t,first_name:s,middle_name:a}=e.profileData.physical_profile||{};return[t,s,a].filter(Boolean).join(" ")||"Не указано"})),l=[{label:"Скан удостоверения личности",fileName:"scan_of_ID"},{label:"Фото с удостоверением личности",fileName:"person_with_ID"}],i=()=>{localStorage.removeItem("accessToken"),t.push("/landing")};return{profileStore:e,fullName:s,documents:l,handleLogout:i}}};const Av=(0,it.A)(Tv,[["render",Mv],["__scopeId","data-v-63d88a6e"]]);var Nv=Av,xv={components:{Profile:cv,MobileProfile:Nv},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}}};const Uv=(0,it.A)(xv,[["render",Em],["__scopeId","data-v-2a7e6ca4"]]);var $v=Uv;const Kv={class:"main-page"};function Rv(e,t,s,a,l,i){const r=(0,o.g2)("MobileProjects"),n=(0,o.g2)("Projects");return(0,o.uX)(),(0,o.CE)("div",Kv,[a.isMobile?((0,o.uX)(),(0,o.Wv)(r,{key:0})):((0,o.uX)(),(0,o.Wv)(n,{key:1}))])}const Wv=(0,Vt.nY)("responses",{state:()=>({responses:[],isLoading:!1,error:null,showNotification:!1,notificationMessage:""}),getters:{pendingResponses:e=>e.responses.filter((e=>"pending"===e.status)),acceptedResponses:e=>e.responses.filter((e=>"accepted"===e.status)),rejectedResponses:e=>e.responses.filter((e=>"rejected"===e.status))},actions:{async fetchResponses(){this.isLoading=!0,this.error=null;try{const e=await ge.A.get("api/projects/responses/",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});this.responses=e.data}catch(e){console.error("Ошибка при загрузке откликов:",e),this.error="Произошла ошибка при загрузке данных"}finally{this.isLoading=!1}},async acceptResponse(e){try{await ge.A.post(`api/projects/responses/${e}/accept/`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),await this.fetchResponses(),this.showSuccessNotification("Отклик успешно принят")}catch(t){console.error("Ошибка при принятии отклика:",t),this.error=t.message||"Произошла ошибка при принятии отклика"}},async rejectResponse(e){try{await ge.A.post(`api/projects/${e}/reject/`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),await this.fetchResponses(),this.showSuccessNotification("Отклик успешно отклонен")}catch(t){console.error("Ошибка при отклонении отклика:",t),this.error=t.message||"Произошла ошибка при отклонении отклика"}},async moveToAuction(e){this.isLoading=!0;try{await ge.A.post(`api/projects/${e}/send_to_auction/`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),this.showSuccessNotification("Проект успешно опубликован на аукционе")}catch(t){throw console.error("Ошибка при публикации проекта:",t),t}finally{this.isLoading=!1}},async moveToWork(e){this.isLoading=!0;try{await ge.A.post(`api/projects/${e}/start_project/`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),this.showSuccessNotification("Проект успешно переведен в работу")}catch(t){throw console.error("Ошибка при переводе проекта в работу:",t),t}finally{this.isLoading=!1}},showSuccessNotification(e){this.notificationMessage=e,this.showNotification=!0,setTimeout((()=>{this.showNotification=!1}),3e3)}}}),Qv={class:"projects-container"},Bv={class:"respondents-list pending"},Ov={key:0,class:"loading"},Vv={key:1,class:"error"},zv={key:2},qv={class:"respondent-item"},Jv={class:"respondent-name"},Gv={class:"specialty"},Hv={class:"application-date"},Yv={class:"project-name"},Zv={class:"button-group"},ek={class:"approval-buttons"},tk=["onClick","disabled"],sk=["onClick","disabled"],ak={key:3,class:"no-responses"},ok={class:"respondents-list accepted"},lk={class:"header-with-toggle"},ik={class:"toggle-buttons"},rk={key:0},nk={class:"respondent-item accepted"},ck={class:"specialist-info"},dk={class:"respondent-name"},uk={class:"specialty"},pk={class:"project-name"},hk={class:"acceptance-date"},mk={key:1,class:"no-responses"},vk={key:2},kk={class:"respondent-item rejected"},gk={class:"specialist-info"},fk={class:"respondent-name"},yk={class:"specialty"},Lk={class:"project-name"},bk={class:"rejection-date"},Ck={key:3,class:"no-responses"},_k={class:"auction-projects"},wk={key:0,class:"project-category"},Ek={class:"auction-item"},Dk={class:"auction-title"},jk={class:"auction-subtitle"},Sk={class:"auction-description"},Fk={class:"auction-date"},Xk={class:"auction-complexity"},Ik={class:"auction-duration"},Pk=["onClick"],Mk={key:1,class:"project-category"},Tk={class:"auction-item"},Ak={class:"auction-title"},Nk={class:"auction-subtitle"},xk={class:"auction-description"},Uk={class:"auction-date"},$k={class:"auction-complexity"},Kk={class:"auction-duration"},Rk=["onClick"],Wk={key:2,class:"project-category"},Qk={class:"auction-item"},Bk={class:"auction-title"},Ok={class:"auction-subtitle"},Vk={class:"auction-description"},zk={class:"auction-date"},qk={class:"auction-complexity"},Jk={class:"auction-duration"},Gk={class:"create-project-container"},Hk={key:0,class:"notification"};var Yk={__name:"Projects",setup(e){const t=(0,a.rd)(),s=Ol(),i=Wv(),r=(0,fe.KR)(!1),n=(0,fe.KR)(!0),c=(0,o.EW)((()=>i.pendingResponses)),d=(0,o.EW)((()=>i.acceptedResponses)),u=(0,o.EW)((()=>i.rejectedResponses)),p=(0,o.EW)((()=>i.isLoading)),h=(0,o.EW)((()=>i.error)),m=(0,o.EW)((()=>i.showNotification)),v=(0,o.EW)((()=>i.notificationMessage)),k=(0,o.EW)((()=>({draft:s.projects.filter((e=>"draft"===e.status)),auction:s.projects.filter((e=>"auction"===e.status)),in_progress:s.projects.filter((e=>"in_progress"===e.status))}))),g=()=>{t.push("/create-project"),r.value=!0},f=e=>i.acceptResponse(e),y=e=>i.rejectResponse(e),L=e=>new Date(e).toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),b=async e=>{try{await i.moveToAuction(e),await s.fetchProjects()}catch(h){console.error("Ошибка при публикации проекта:",h),h.value="Произошла ошибка при публикации проекта"}},C=async e=>{try{await i.moveToWork(e),await s.fetchProjects()}catch(h){console.error("Ошибка при переводе проекта в работу:",h),h.value="Произошла ошибка при переводе проекта в работу"}};return(0,o.sV)((async()=>{await s.fetchProjects(),await i.fetchResponses()})),(e,t)=>((0,o.uX)(),(0,o.CE)("div",Qv,[(0,o.Lk)("div",Bv,[t[7]||(t[7]=(0,o.Lk)("h3",null,"Новые отклики",-1)),p.value?((0,o.uX)(),(0,o.CE)("div",Ov,"Загрузка...")):h.value?((0,o.uX)(),(0,o.CE)("div",Vv,(0,l.v_)(h.value),1)):c.value.length?((0,o.uX)(),(0,o.CE)("ul",zv,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(c.value,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id},[(0,o.Lk)("div",qv,[(0,o.Lk)("span",Jv,(0,l.v_)([e.specialist?.first_name,e.specialist?.last_name].filter(Boolean).join(" ")),1),(0,o.Lk)("span",Gv,[t[2]||(t[2]=(0,o.eW)(" Специальность: ")),(0,o.Lk)("strong",null,(0,l.v_)(e.specialty_name||"Не указана"),1)]),(0,o.Lk)("span",Hv,[t[3]||(t[3]=(0,o.eW)(" Дата подачи: ")),(0,o.Lk)("strong",null,(0,l.v_)(L(e.created_at)),1)]),(0,o.Lk)("span",Yv,[t[4]||(t[4]=(0,o.eW)(" Проект: ")),(0,o.Lk)("strong",null,(0,l.v_)(e.project_name),1)]),(0,o.Lk)("div",Zv,[t[5]||(t[5]=(0,o.Lk)("button",{class:"action-button chat-button"},"Перейти в чат",-1)),(0,o.Lk)("div",ek,[(0,o.Lk)("button",{class:"action-button approve-button",onClick:t=>f(e.uuid),disabled:p.value},(0,l.v_)(p.value?"Обработка...":"Одобрить"),9,tk),(0,o.Lk)("button",{class:"action-button reject-button",onClick:t=>y(e.uuid),disabled:p.value},(0,l.v_)(p.value?"Обработка...":"Отказать"),9,sk)])])]),t[6]||(t[6]=(0,o.Lk)("hr",{class:"divider"},null,-1))])))),128))])):((0,o.uX)(),(0,o.CE)("div",ak,"Нет новых откликов"))]),(0,o.Lk)("div",ok,[(0,o.Lk)("div",lk,[(0,o.Lk)("h3",null,(0,l.v_)(n.value?"Одобренные специалисты":"Отклоненные специалисты"),1),(0,o.Lk)("div",ik,[(0,o.Lk)("button",{class:(0,l.C4)(["toggle-button",{active:n.value}]),onClick:t[0]||(t[0]=e=>n.value=!0)}," Одобренные ",2),(0,o.Lk)("button",{class:(0,l.C4)(["toggle-button",{active:!n.value}]),onClick:t[1]||(t[1]=e=>n.value=!1)}," Отклоненные ",2)])]),n.value&&d.value.length?((0,o.uX)(),(0,o.CE)("ul",rk,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(d.value,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id},[(0,o.Lk)("div",nk,[(0,o.Lk)("div",ck,[(0,o.Lk)("span",dk,(0,l.v_)([e.specialist?.first_name,e.specialist?.last_name].filter(Boolean).join(" ")),1),(0,o.Lk)("span",uk,[t[8]||(t[8]=(0,o.eW)(" Специальность: ")),(0,o.Lk)("strong",null,(0,l.v_)(e.specialty_name||"Не указана"),1)]),(0,o.Lk)("span",pk,[t[9]||(t[9]=(0,o.eW)(" Проект: ")),(0,o.Lk)("strong",null,(0,l.v_)(e.project_name),1)]),(0,o.Lk)("span",hk,[t[10]||(t[10]=(0,o.eW)(" Дата создания: ")),(0,o.Lk)("strong",null,(0,l.v_)(L(e.created_at)),1)])]),t[11]||(t[11]=(0,o.Lk)("div",{class:"button-group"},[(0,o.Lk)("button",{class:"action-button chat-button"},"Перейти в чат")],-1))]),t[12]||(t[12]=(0,o.Lk)("hr",{class:"divider"},null,-1))])))),128))])):(0,o.Q3)("",!0),n.value&&!d.value.length?((0,o.uX)(),(0,o.CE)("div",mk," Нет одобренных специалистов ")):(0,o.Q3)("",!0),!n.value&&u.value.length?((0,o.uX)(),(0,o.CE)("div",vk,[(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(u.value,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id},[(0,o.Lk)("div",kk,[(0,o.Lk)("div",gk,[(0,o.Lk)("span",fk,(0,l.v_)([e.specialist?.first_name,e.specialist?.last_name].filter(Boolean).join(" ")),1),(0,o.Lk)("span",yk,[t[13]||(t[13]=(0,o.eW)(" Специальность: ")),(0,o.Lk)("strong",null,(0,l.v_)(e.specialty_name||"Не указана"),1)]),(0,o.Lk)("span",Lk,[t[14]||(t[14]=(0,o.eW)(" Проект: ")),(0,o.Lk)("strong",null,(0,l.v_)(e.project_name),1)]),(0,o.Lk)("span",bk,[t[15]||(t[15]=(0,o.eW)(" Дата создания: ")),(0,o.Lk)("strong",null,(0,l.v_)(L(e.created_at)),1)])])]),t[16]||(t[16]=(0,o.Lk)("hr",{class:"divider"},null,-1))])))),128))])])):(0,o.Q3)("",!0),n.value||u.value.length?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Ck," Нет отклоненных специалистов "))]),(0,o.Lk)("div",_k,[t[26]||(t[26]=(0,o.Lk)("h3",null,"Проекты на аукционе",-1)),k.value.draft.length?((0,o.uX)(),(0,o.CE)("div",wk,[t[19]||(t[19]=(0,o.Lk)("h4",null,"Черновики",-1)),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(k.value.draft,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.uuid},[(0,o.Lk)("div",Ek,[(0,o.Lk)("span",Dk,"Проект: "+(0,l.v_)(e.name),1),(0,o.Lk)("span",jk,(0,l.v_)(e.subtitle),1),(0,o.Lk)("span",Sk,(0,l.v_)(e.description),1),(0,o.Lk)("span",Fk,"Дата создания: "+(0,l.v_)(L(e.created_at)),1),(0,o.Lk)("span",Xk,"Сложность: "+(0,l.v_)(e.complexity?.name),1),(0,o.Lk)("span",Ik,"Длительность: "+(0,l.v_)(e.estimated_duration)+" месяцев",1),t[17]||(t[17]=(0,o.Lk)("span",{class:"project-status"},"Статус проекта: Черновик",-1)),(0,o.Lk)("button",{class:"action-button work-button",onClick:t=>b(e.uuid)}," Опубликовать на аукцион ",8,Pk)]),t[18]||(t[18]=(0,o.Lk)("hr",{class:"divider"},null,-1))])))),128))])])):(0,o.Q3)("",!0),k.value.auction.length?((0,o.uX)(),(0,o.CE)("div",Mk,[t[22]||(t[22]=(0,o.Lk)("h4",null,"На аукционе",-1)),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(k.value.auction,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.uuid},[(0,o.Lk)("div",Tk,[(0,o.Lk)("span",Ak,"Проект: "+(0,l.v_)(e.name),1),(0,o.Lk)("span",Nk,(0,l.v_)(e.subtitle),1),(0,o.Lk)("span",xk,(0,l.v_)(e.description),1),(0,o.Lk)("span",Uk,"Дата создания: "+(0,l.v_)(L(e.created_at)),1),(0,o.Lk)("span",$k,"Сложность: "+(0,l.v_)(e.complexity?.name),1),(0,o.Lk)("span",Kk,"Длительность: "+(0,l.v_)(e.estimated_duration)+" месяцев",1),t[20]||(t[20]=(0,o.Lk)("span",{class:"project-status"},"Статус проекта: На аукционе",-1)),(0,o.Lk)("button",{class:"action-button work-button",onClick:t=>C(e.uuid)}," Перевести в работу ",8,Rk)]),t[21]||(t[21]=(0,o.Lk)("hr",{class:"divider"},null,-1))])))),128))])])):(0,o.Q3)("",!0),k.value.in_progress.length?((0,o.uX)(),(0,o.CE)("div",Wk,[t[25]||(t[25]=(0,o.Lk)("h4",null,"В работе",-1)),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(k.value.in_progress,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.uuid},[(0,o.Lk)("div",Qk,[(0,o.Lk)("span",Bk,"Проект: "+(0,l.v_)(e.name),1),(0,o.Lk)("span",Ok,(0,l.v_)(e.subtitle),1),(0,o.Lk)("span",Vk,(0,l.v_)(e.description),1),(0,o.Lk)("span",zk,"Дата создания: "+(0,l.v_)(L(e.created_at)),1),(0,o.Lk)("span",qk,"Сложность: "+(0,l.v_)(e.complexity?.name),1),(0,o.Lk)("span",Jk,"Длительность: "+(0,l.v_)(e.estimated_duration)+" месяцев",1),t[23]||(t[23]=(0,o.Lk)("span",{class:"project-status"},"Статус проекта: В работе",-1))]),t[24]||(t[24]=(0,o.Lk)("hr",{class:"divider"},null,-1))])))),128))])])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",Gk,[r.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:g,class:"create-project-button"}," Создать новый проект "))]),m.value?((0,o.uX)(),(0,o.CE)("div",Hk,(0,l.v_)(v.value),1)):(0,o.Q3)("",!0)]))}};const Zk=(0,it.A)(Yk,[["__scopeId","data-v-5deb284c"]]);var eg=Zk;const tg={class:"mobile-projects"},sg={class:"tabs"},ag=["onClick"],og={class:"tab-content"},lg={key:0,class:"responses-section"},ig={class:"section-tabs"},rg=["onClick"],ng={class:"responses-list"},cg={key:0,class:"loading"},dg={key:1,class:"error"},ug={key:2},pg={key:0,class:"response-items"},hg={class:"response-header"},mg={class:"date"},vg={class:"response-details"},kg={class:"specialty"},gg={class:"project"},fg={class:"response-actions"},yg={class:"action-buttons"},Lg=["onClick","disabled"],bg=["onClick","disabled"],Cg={key:0,class:"empty-state"},_g={key:1,class:"response-items"},wg={class:"response-header"},Eg={class:"date"},Dg={class:"response-details"},jg={class:"specialty"},Sg={class:"project"},Fg={key:0,class:"empty-state"},Xg={key:2,class:"response-items"},Ig={class:"response-header"},Pg={class:"date"},Mg={class:"response-details"},Tg={class:"specialty"},Ag={class:"project"},Ng={key:0,class:"empty-state"},xg={key:1,class:"projects-section"},Ug={class:"section-tabs"},$g=["onClick"],Kg={class:"projects-list"},Rg={class:"project-header"},Wg={class:"date"},Qg={class:"subtitle"},Bg={class:"project-details"},Og={class:"complexity"},Vg={class:"duration"},zg={class:"project-actions"},qg=["onClick"],Jg=["onClick"],Gg={key:0,class:"empty-state"},Hg={key:0,class:"notification"};var Yg={__name:"MobileProjects",setup(e){const t=(0,a.rd)(),s=Ol(),i=Wv(),r=(0,fe.KR)("responses"),n=(0,fe.KR)("pending"),c=(0,fe.KR)("draft"),d=[{id:"responses",name:"Отклики"},{id:"projects",name:"Проекты"}],u=[{id:"pending",name:"Новые"},{id:"accepted",name:"Принятые"},{id:"rejected",name:"Отклоненные"}],p=[{id:"draft",name:"Черновики"},{id:"auction",name:"На аукционе"},{id:"in_progress",name:"В работе"}],h=(0,o.EW)((()=>i.pendingResponses)),m=(0,o.EW)((()=>i.acceptedResponses)),v=(0,o.EW)((()=>i.rejectedResponses)),k=(0,o.EW)((()=>i.isLoading)),g=(0,o.EW)((()=>i.error)),f=(0,o.EW)((()=>i.showNotification)),y=(0,o.EW)((()=>i.notificationMessage)),L=(0,o.EW)((()=>s.projects.filter((e=>e.status===c.value)))),b=()=>{t.push("/create-project")},C=e=>new Date(e).toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),_=e=>i.acceptResponse(e),w=e=>i.rejectResponse(e),E=async e=>{try{await i.moveToAuction(e),await s.fetchProjects()}catch(g){console.error("Ошибка при публикации проекта:",g)}},D=async e=>{try{await i.moveToWork(e),await s.fetchProjects()}catch(g){console.error("Ошибка при переводе проекта в работу:",g)}};return(0,o.sV)((async()=>{await s.fetchProjects(),await i.fetchResponses()})),(e,t)=>((0,o.uX)(),(0,o.CE)("div",tg,[(0,o.Lk)("div",{class:"top-bar"},[t[1]||(t[1]=(0,o.Lk)("h2",null,"Проекты",-1)),(0,o.Lk)("button",{onClick:b,class:"create-button"},t[0]||(t[0]=[(0,o.Lk)("img",{src:gt,alt:"Создать",class:"create-icon"},null,-1),(0,o.eW)(" Создать ")]))]),(0,o.Lk)("div",sg,[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(d,(e=>(0,o.Lk)("button",{key:e.id,onClick:t=>r.value=e.id,class:(0,l.C4)(["tab-button",{active:r.value===e.id}])},(0,l.v_)(e.name),11,ag))),64))]),(0,o.Lk)("div",og,["responses"===r.value?((0,o.uX)(),(0,o.CE)("div",lg,[(0,o.Lk)("div",ig,[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(u,(e=>(0,o.Lk)("button",{key:e.id,onClick:t=>n.value=e.id,class:(0,l.C4)(["status-button",{active:n.value===e.id}])},(0,l.v_)(e.name),11,rg))),64))]),(0,o.Lk)("div",ng,[k.value?((0,o.uX)(),(0,o.CE)("div",cg,"Загрузка...")):g.value?((0,o.uX)(),(0,o.CE)("div",dg,(0,l.v_)(g.value),1)):((0,o.uX)(),(0,o.CE)("div",ug,["pending"===n.value?((0,o.uX)(),(0,o.CE)("div",pg,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(h.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"response-card"},[(0,o.Lk)("div",hg,[(0,o.Lk)("h3",null,(0,l.v_)(e.specialist?.first_name)+" "+(0,l.v_)(e.specialist?.last_name),1),(0,o.Lk)("span",mg,(0,l.v_)(C(e.created_at)),1)]),(0,o.Lk)("div",vg,[(0,o.Lk)("p",kg,(0,l.v_)(e.specialty_name||"Специальность не указана"),1),(0,o.Lk)("p",gg,(0,l.v_)(e.project_name),1)]),(0,o.Lk)("div",fg,[t[2]||(t[2]=(0,o.Lk)("button",{class:"chat-btn"},"Чат",-1)),(0,o.Lk)("div",yg,[(0,o.Lk)("button",{onClick:t=>_(e.uuid),class:"accept-btn",disabled:k.value}," Принять ",8,Lg),(0,o.Lk)("button",{onClick:t=>w(e.uuid),class:"reject-btn",disabled:k.value}," Отклонить ",8,bg)])])])))),128)),h.value.length?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Cg," Нет новых откликов "))])):"accepted"===n.value?((0,o.uX)(),(0,o.CE)("div",_g,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(m.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"response-card accepted"},[(0,o.Lk)("div",wg,[(0,o.Lk)("h3",null,(0,l.v_)(e.specialist?.first_name)+" "+(0,l.v_)(e.specialist?.last_name),1),(0,o.Lk)("span",Eg,(0,l.v_)(C(e.created_at)),1)]),(0,o.Lk)("div",Dg,[(0,o.Lk)("p",jg,(0,l.v_)(e.specialty_name||"Специальность не указана"),1),(0,o.Lk)("p",Sg,(0,l.v_)(e.project_name),1)]),t[3]||(t[3]=(0,o.Lk)("button",{class:"chat-btn"},"Чат",-1))])))),128)),m.value.length?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Fg," Нет принятых откликов "))])):((0,o.uX)(),(0,o.CE)("div",Xg,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(v.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"response-card rejected"},[(0,o.Lk)("div",Ig,[(0,o.Lk)("h3",null,(0,l.v_)(e.specialist?.first_name)+" "+(0,l.v_)(e.specialist?.last_name),1),(0,o.Lk)("span",Pg,(0,l.v_)(C(e.created_at)),1)]),(0,o.Lk)("div",Mg,[(0,o.Lk)("p",Tg,(0,l.v_)(e.specialty_name||"Специальность не указана"),1),(0,o.Lk)("p",Ag,(0,l.v_)(e.project_name),1)])])))),128)),v.value.length?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Ng," Нет отклоненных откликов "))]))]))])])):((0,o.uX)(),(0,o.CE)("div",xg,[(0,o.Lk)("div",Ug,[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(p,(e=>(0,o.Lk)("button",{key:e.id,onClick:t=>c.value=e.id,class:(0,l.C4)(["status-button",{active:c.value===e.id}])},(0,l.v_)(e.name),11,$g))),64))]),(0,o.Lk)("div",Kg,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(L.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.uuid,class:"project-card"},[(0,o.Lk)("div",Rg,[(0,o.Lk)("h3",null,(0,l.v_)(e.name),1),(0,o.Lk)("span",Wg,(0,l.v_)(C(e.created_at)),1)]),(0,o.Lk)("p",Qg,(0,l.v_)(e.subtitle),1),(0,o.Lk)("div",Bg,[(0,o.Lk)("span",Og,(0,l.v_)(e.complexity?.name),1),(0,o.Lk)("span",Vg,(0,l.v_)(e.estimated_duration)+" мес.",1)]),(0,o.Lk)("div",zg,["draft"===e.status?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t=>E(e.uuid),class:"action-btn publish"}," Опубликовать ",8,qg)):(0,o.Q3)("",!0),"auction"===e.status?((0,o.uX)(),(0,o.CE)("button",{key:1,onClick:t=>D(e.uuid),class:"action-btn start"}," Начать работу ",8,Jg)):(0,o.Q3)("",!0)])])))),128)),L.value.length?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Gg," Нет проектов "))])]))]),f.value?((0,o.uX)(),(0,o.CE)("div",Hg,(0,l.v_)(y.value),1)):(0,o.Q3)("",!0)]))}};const Zg=(0,it.A)(Yg,[["__scopeId","data-v-57713d45"]]);var ef=Zg,tf={components:{Projects:eg,MobileProjects:ef},setup(){const e=(0,fe.KR)(window.innerWidth<=768),t=()=>{e.value=window.innerWidth<=768};return(0,o.sV)((()=>{window.addEventListener("resize",t)})),(0,o.xo)((()=>{window.removeEventListener("resize",t)})),{isMobile:e}}};const sf=(0,it.A)(tf,[["render",Rv],["__scopeId","data-v-02b5eca3"]]);var af=sf;const of={class:"create-project-page"},lf={class:"page-header"},rf={class:"header-controls"},nf={class:"description-section"},cf={class:"description-section"},df={class:"details-section"},uf={class:"detail"},pf=["value"],hf={class:"detail"},mf={class:"detail"},vf={class:"specialties-section"},kf={class:"specialties-grid"},gf={class:"specialty-checkbox"},ff=["value","onChange"],yf={key:0,class:"budget-input-container"},Lf=["onUpdate:modelValue"],bf={class:"template-block"},Cf={class:"template-controls"},_f={key:0,class:"tasks-list"},wf={class:"task-order"},Ef={class:"task-name"},Df={class:"task-duration-container"},jf=["onUpdate:modelValue"],Sf={key:1},Ff=["disabled"],Xf={key:0,class:"error-message"};var If={__name:"CreateProjects",emits:["close"],setup(e,{emit:t}){const s=t,a=zt(),r=(0,fe.KR)([]),n=(0,fe.KR)(""),c=(0,fe.KR)({}),d=(0,fe.KR)(!1),u=(0,fe.KR)(null),p=(0,fe.KR)([]),h=(0,fe.KR)({name:"",subtitle:"",description:"",complexity_id:"",estimated_duration:6,client:"",template_id:null,required_specialties:[],specialty_budgets:[]}),m=(0,fe.KR)([]),v=(0,fe.KR)({}),k=(0,o.EW)((()=>a.specialties.map((e=>({id:e.id,name:e.name}))))),g=e=>m.value.includes(e),f=e=>{g(e)||delete v.value[e]},y=e=>Number.isInteger(Number(e.order)),L=(0,o.EW)((()=>n.value&&r.value?.[0]?.default_tasks?r.value[0].default_tasks.filter((e=>e.sub_work_name===n.value)).sort(((e,t)=>e.order.localeCompare(t.order,void 0,{numeric:!0}))):[])),b=()=>{L.value.length>0&&L.value.forEach((e=>{y(e)||c.value[e.id]||(c.value[e.id]=1)}))},C=async()=>{try{const e=localStorage.getItem("accessToken"),t=await ge.A.get("api/projects/templates/",{headers:{Authorization:`Bearer ${e}`}});r.value=t.data,console.log("Загруженные шаблоны:",t.data)}catch(e){console.error("Ошибка при загрузке шаблонов:",e),u.value="Не удалось загрузить шаблоны проектов"}},_=async()=>{try{const e=localStorage.getItem("accessToken"),t=await ge.A.get("api/projects/complexities/",{headers:{Authorization:`Bearer ${e}`}});p.value=t.data,t.data.length>0&&(h.value.complexity_id=t.data[0].id)}catch(e){console.error("Ошибка при загрузке сложностей:",e),u.value="Не удалось загрузить список сложностей"}},w=async()=>{d.value=!0,u.value=null;try{const e=m.value.map((e=>({specialty:e,budget:parseFloat(v.value[e]||"0").toFixed(2)}))),t=Object.entries(c.value).filter((([e])=>{const t=r.value[0].default_tasks.find((t=>t.id===Number(e)));return t&&!y(t)})).map((([e,t])=>({task_id:Number(e),duration:Number(t)}))),a={...h.value,required_specialties:m.value,specialty_budgets:e,template_id:r.value[0].id,tasks:t};console.log("Отправляемые данные:",a);const o=localStorage.getItem("accessToken"),l=await ge.A.post("api/projects/",a,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});console.log("Проект успешно создан:",l.data),s("close")}catch(e){console.error("Ошибка при создании проекта:",e),u.value="Не удалось создать проект. Пожалуйста, проверьте введенные данные."}finally{d.value=!1}},E=(0,fe.KR)(null),D=()=>{const e=E.value;e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px")};return(0,o.sV)((async()=>{C(),await _(),0===a.specialties.length&&await a.loadDropdownData(),D()})),(e,t)=>((0,o.uX)(),(0,o.CE)("div",of,[(0,o.Lk)("div",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"back-button"},t[9]||(t[9]=[(0,o.Lk)("img",{src:ye,alt:"Назад",class:"back-icon"},null,-1)])),(0,o.Lk)("header",lf,[(0,o.Lk)("div",rf,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>h.value.name=e),type:"text",placeholder:"Название проекта",class:"project-name",required:""},null,512),[[i.Jo,h.value.name]])])]),(0,o.Lk)("div",nf,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>h.value.subtitle=e),type:"text",placeholder:"Краткое описание проекта",class:"project-subtitle"},null,512),[[i.Jo,h.value.subtitle]])]),(0,o.Lk)("div",cf,[(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>h.value.description=e),placeholder:"Полное описание проекта",class:"project-description",onInput:D,ref_key:"descriptionTextarea",ref:E},null,544),[[i.Jo,h.value.description]])]),(0,o.Lk)("div",df,[(0,o.Lk)("div",uf,[t[10]||(t[10]=(0,o.Lk)("label",null,"Сложность проекта",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>h.value.complexity_id=e),class:"complexity-select"},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(p.value,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.name),9,pf)))),128))],512),[[i.u1,h.value.complexity_id]])]),(0,o.Lk)("div",hf,[t[11]||(t[11]=(0,o.Lk)("label",null,"Срок (в месяцах)",-1)),(0,o.bo)((0,o.Lk)("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=e=>h.value.estimated_duration=e),min:"1",class:"duration-input"},null,512),[[i.Jo,h.value.estimated_duration]])]),(0,o.Lk)("div",mf,[t[12]||(t[12]=(0,o.Lk)("label",null,"ID Заказчика",-1)),(0,o.bo)((0,o.Lk)("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=e=>h.value.client=e),class:"client-input",placeholder:"Введите ID заказчика"},null,512),[[i.Jo,h.value.client]])])]),(0,o.Lk)("div",vf,[t[14]||(t[14]=(0,o.Lk)("h3",null,"Специальности и бюджеты",-1)),(0,o.Lk)("div",kf,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(k.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"specialty-item"},[(0,o.Lk)("label",gf,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[7]||(t[7]=e=>m.value=e),onChange:t=>f(e.id)},null,40,ff),[[i.lH,m.value]]),(0,o.eW)(" "+(0,l.v_)(e.name),1)]),g(e.id)?((0,o.uX)(),(0,o.CE)("div",yf,[(0,o.bo)((0,o.Lk)("input",{type:"number","onUpdate:modelValue":t=>v.value[e.id]=t,placeholder:"Бюджет",class:"specialty-budget",step:"0.01",min:"0"},null,8,Lf),[[i.Jo,v.value[e.id]]]),t[13]||(t[13]=(0,o.Lk)("span",{class:"currency"},"₸",-1))])):(0,o.Q3)("",!0)])))),128))])]),(0,o.Lk)("div",bf,[t[17]||(t[17]=(0,o.Lk)("h3",null,"График производства работ",-1)),(0,o.Lk)("div",Cf,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>n.value=e),class:"template-select work-type-select",onChange:b},t[15]||(t[15]=[(0,o.Lk)("option",{value:""},"Выберите раздел работ",-1),(0,o.Lk)("option",{value:"Разработка Эскизного Проекта"}," Разработка Эскизного Проекта ",-1),(0,o.Lk)("option",{value:"Разработка рабочего проекта"}," Разработка рабочего проекта ",-1)]),544),[[i.u1,n.value]]),n.value?((0,o.uX)(),(0,o.CE)("div",_f,[t[16]||(t[16]=(0,o.Lk)("div",{class:"tasks-header"},[(0,o.Lk)("span",null,"№"),(0,o.Lk)("span",null,"Наименование работ"),(0,o.Lk)("span",null,"Длительность (дней)")],-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(L.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,l.C4)(["task-item",{"main-task":y(e)}])},[(0,o.Lk)("span",wf,(0,l.v_)(e.order),1),(0,o.Lk)("span",Ef,(0,l.v_)(e.work_name),1),(0,o.Lk)("div",Df,[y(e)?((0,o.uX)(),(0,o.CE)("span",Sf,"-")):(0,o.bo)(((0,o.uX)(),(0,o.CE)("input",{key:0,type:"number","onUpdate:modelValue":t=>c.value[e.id]=t,class:"task-duration",min:"1",placeholder:"Дней"},null,8,jf)),[[i.Jo,c.value[e.id]]])])],2)))),128))])):(0,o.Q3)("",!0)])]),(0,o.Lk)("button",{class:"create-project",onClick:w,disabled:d.value},(0,l.v_)(d.value?"Создание...":"Создать проект"),9,Ff),u.value?((0,o.uX)(),(0,o.CE)("div",Xf,(0,l.v_)(u.value),1)):(0,o.Q3)("",!0)]))}};const Pf=(0,it.A)(If,[["__scopeId","data-v-efb4b762"]]);var Mf=Pf;const Tf={class:"mobile-create-project"},Af={class:"top-bar"},Nf={class:"form-content"},xf={class:"form-section"},Uf={class:"form-section"},$f={class:"form-section"},Kf={class:"form-section parameters"},Rf={class:"parameter-item"},Wf=["value"],Qf={class:"parameter-item"},Bf={class:"parameter-item"},Of={class:"form-section"},Vf={class:"specialties-list"},zf={class:"specialty-checkbox"},qf=["value","onChange"],Jf={key:0,class:"budget-input-container"},Gf=["onUpdate:modelValue"],Hf={class:"form-section"},Yf={key:0,class:"tasks-list"},Zf={class:"task-header"},ey={class:"task-order"},ty={class:"task-name"},sy={class:"task-duration"},ay=["onUpdate:modelValue"],oy={key:1},ly={class:"bottom-bar"},iy=["disabled"],ry={key:0,class:"error-message"};var ny={__name:"MobileCreateProjects",emits:["close"],setup(e,{emit:t}){const s=t,a=zt(),r=(0,fe.KR)([]),n=(0,fe.KR)(""),c=(0,fe.KR)({}),d=(0,fe.KR)(!1),u=(0,fe.KR)(null),p=(0,fe.KR)([]),h=(0,fe.KR)({name:"",subtitle:"",description:"",complexity_id:"",estimated_duration:6,client:"",template_id:null,required_specialties:[],specialty_budgets:[]}),m=(0,fe.KR)([]),v=(0,fe.KR)({}),k=(0,o.EW)((()=>a.specialties.map((e=>({id:e.id,name:e.name}))))),g=e=>m.value.includes(e),f=e=>{g(e)||delete v.value[e]},y=e=>Number.isInteger(Number(e.order)),L=(0,o.EW)((()=>n.value&&r.value?.[0]?.default_tasks?r.value[0].default_tasks.filter((e=>e.sub_work_name===n.value)).sort(((e,t)=>e.order.localeCompare(t.order,void 0,{numeric:!0}))):[])),b=()=>{L.value.length>0&&L.value.forEach((e=>{y(e)||c.value[e.id]||(c.value[e.id]=1)}))},C=async()=>{try{const e=localStorage.getItem("accessToken"),t=await ge.A.get("api/projects/templates/",{headers:{Authorization:`Bearer ${e}`}});r.value=t.data}catch(e){console.error("Ошибка при загрузке шаблонов:",e),u.value="Не удалось загрузить шаблоны проектов"}},_=async()=>{try{const e=localStorage.getItem("accessToken"),t=await ge.A.get("api/projects/complexities/",{headers:{Authorization:`Bearer ${e}`}});p.value=t.data,t.data.length>0&&(h.value.complexity_id=t.data[0].id)}catch(e){console.error("Ошибка при загрузке сложностей:",e),u.value="Не удалось загрузить список сложностей"}},w=async()=>{d.value=!0,u.value=null;try{const e=m.value.map((e=>({specialty:e,budget:parseFloat(v.value[e]||"0").toFixed(2)}))),t=Object.entries(c.value).filter((([e])=>{const t=r.value[0].default_tasks.find((t=>t.id===Number(e)));return t&&!y(t)})).map((([e,t])=>({task_id:Number(e),duration:Number(t)}))),a={...h.value,required_specialties:m.value,specialty_budgets:e,template_id:r.value[0].id,tasks:t},o=localStorage.getItem("accessToken"),l=await ge.A.post("api/projects/",a,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});console.log("Проект успешно создан:",l.data),s("close")}catch(e){console.error("Ошибка при создании проекта:",e),u.value="Не удалось создать проект. Пожалуйста, проверьте введенные данные."}finally{d.value=!1}},E=(0,fe.KR)(null),D=()=>{const e=E.value;e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px")};return(0,o.sV)((async()=>{C(),await _(),0===a.specialties.length&&await a.loadDropdownData(),D()})),(e,t)=>((0,o.uX)(),(0,o.CE)("div",Tf,[(0,o.Lk)("div",Af,[(0,o.Lk)("div",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"back-button"},t[9]||(t[9]=[(0,o.Lk)("img",{src:ye,alt:"Назад"},null,-1)])),t[10]||(t[10]=(0,o.Lk)("h2",null,"Создание проекта",-1))]),(0,o.Lk)("div",Nf,[(0,o.Lk)("div",xf,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>h.value.name=e),type:"text",placeholder:"Название проекта",class:"project-name",required:""},null,512),[[i.Jo,h.value.name]])]),(0,o.Lk)("div",Uf,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>h.value.subtitle=e),type:"text",placeholder:"Краткое описание проекта",class:"project-subtitle"},null,512),[[i.Jo,h.value.subtitle]])]),(0,o.Lk)("div",$f,[(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>h.value.description=e),placeholder:"Полное описание проекта",class:"project-description",onInput:D,ref_key:"descriptionTextarea",ref:E},null,544),[[i.Jo,h.value.description]])]),(0,o.Lk)("div",Kf,[(0,o.Lk)("div",Rf,[t[11]||(t[11]=(0,o.Lk)("label",null,"Сложность проекта",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>h.value.complexity_id=e),class:"parameter-input"},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(p.value,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.name),9,Wf)))),128))],512),[[i.u1,h.value.complexity_id]])]),(0,o.Lk)("div",Qf,[t[12]||(t[12]=(0,o.Lk)("label",null,"Срок (в месяцах)",-1)),(0,o.bo)((0,o.Lk)("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=e=>h.value.estimated_duration=e),min:"1",class:"parameter-input"},null,512),[[i.Jo,h.value.estimated_duration]])]),(0,o.Lk)("div",Bf,[t[13]||(t[13]=(0,o.Lk)("label",null,"ID Заказчика",-1)),(0,o.bo)((0,o.Lk)("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=e=>h.value.client=e),class:"parameter-input",placeholder:"Введите ID заказчика"},null,512),[[i.Jo,h.value.client]])])]),(0,o.Lk)("div",Of,[t[15]||(t[15]=(0,o.Lk)("h3",null,"Специальности и бюджеты",-1)),(0,o.Lk)("div",Vf,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(k.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"specialty-item"},[(0,o.Lk)("label",zf,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[7]||(t[7]=e=>m.value=e),onChange:t=>f(e.id)},null,40,qf),[[i.lH,m.value]]),(0,o.eW)(" "+(0,l.v_)(e.name),1)]),g(e.id)?((0,o.uX)(),(0,o.CE)("div",Jf,[(0,o.bo)((0,o.Lk)("input",{type:"number","onUpdate:modelValue":t=>v.value[e.id]=t,placeholder:"Бюджет",class:"specialty-budget",step:"0.01",min:"0"},null,8,Gf),[[i.Jo,v.value[e.id]]]),t[14]||(t[14]=(0,o.Lk)("span",{class:"currency"},"₸",-1))])):(0,o.Q3)("",!0)])))),128))])]),(0,o.Lk)("div",Hf,[t[17]||(t[17]=(0,o.Lk)("h3",null,"График производства работ",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>n.value=e),class:"work-type-select",onChange:b},t[16]||(t[16]=[(0,o.Lk)("option",{value:""},"Выберите раздел работ",-1),(0,o.Lk)("option",{value:"Разработка Эскизного Проекта"},"Разработка Эскизного Проекта",-1),(0,o.Lk)("option",{value:"Разработка рабочего проекта"},"Разработка рабочего проекта",-1)]),544),[[i.u1,n.value]]),n.value?((0,o.uX)(),(0,o.CE)("div",Yf,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(L.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,l.C4)(["task-item",{"main-task":y(e)}])},[(0,o.Lk)("div",Zf,[(0,o.Lk)("span",ey,(0,l.v_)(e.order),1),(0,o.Lk)("span",ty,(0,l.v_)(e.work_name),1)]),(0,o.Lk)("div",sy,[y(e)?((0,o.uX)(),(0,o.CE)("span",oy,"-")):(0,o.bo)(((0,o.uX)(),(0,o.CE)("input",{key:0,type:"number","onUpdate:modelValue":t=>c.value[e.id]=t,min:"1",placeholder:"Дней"},null,8,ay)),[[i.Jo,c.value[e.id]]])])],2)))),128))])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",ly,[(0,o.Lk)("button",{class:"create-button",onClick:w,disabled:d.value},(0,l.v_)(d.value?"Создание...":"Создать проект"),9,iy)]),u.value?((0,o.uX)(),(0,o.CE)("div",ry,(0,l.v_)(u.value),1)):(0,o.Q3)("",!0)]))}};const cy=(0,it.A)(ny,[["__scopeId","data-v-75e16e7a"]]);var dy=cy;const uy={class:"create-project-page"};var py={__name:"CreateProject",setup(e){const t=(0,a.rd)(),s=(0,fe.KR)(window.innerWidth<=768),l=()=>{s.value=window.innerWidth<=768};(0,o.sV)((()=>{window.addEventListener("resize",l)})),(0,o.xo)((()=>{window.removeEventListener("resize",l)}));const i=()=>{t.push("/projects")};return(e,t)=>((0,o.uX)(),(0,o.CE)("div",uy,[s.value?((0,o.uX)(),(0,o.Wv)(dy,{key:0,onClose:i})):((0,o.uX)(),(0,o.Wv)(Mf,{key:1,onClose:i}))]))}};const hy=(0,it.A)(py,[["__scopeId","data-v-04881a02"]]);var my=hy;const vy=(0,o.pM)({name:"DynamicWrapper",data(){return{windowWidth:window.innerWidth}},computed:{currentWrapper(){return this.windowWidth<=768?la:Ts}},created(){window.addEventListener("resize",this.onResize)},beforeUnmount(){window.removeEventListener("resize",this.onResize)},methods:{onResize(){this.windowWidth=window.innerWidth}},render(){return(0,o.h)(this.currentWrapper)}}),ky=[{path:"",component:vy,children:[{path:"",redirect:"landing"},{path:"dashboard",name:"Dashboard",component:Ku,meta:{requiresAuth:!0}},{path:"chats",name:"Chats",component:rl,meta:{requiresAuth:!0}},{path:"projects",name:"Projects",component:af,meta:{requiresAuth:!0}},{path:"auction",name:"Auction",component:yi,meta:{requiresAuth:!0}},{path:"news",name:"News",component:yr,meta:{requiresAuth:!0}},{path:"documents",name:"Documents",component:Yr,meta:{requiresAuth:!0}},{path:"calendar",name:"Calendar",component:Fd,meta:{requiresAuth:!0}},{path:"finance",name:"Finance",component:Rp,meta:{requiresAuth:!0}},{path:"investments",name:"Investments",component:fm,meta:{requiresAuth:!0}},{path:"shop",name:"Shop",component:_m,meta:{requiresAuth:!0}},{path:"/profile",name:"Profile",component:$v,meta:{requiresAuth:!0}}]},{path:"/landing",name:"landing",component:()=>s.e(226).then(s.bind(s,8226)),beforeEnter:()=>(localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),!0)},{path:"/authentication",name:"Authentication",component:pt},{path:"/create-project",name:"CreateProject",component:my}],gy=(0,a.aE)({history:(0,a.LA)(),routes:ky});gy.beforeEach((async(e,t,s)=>{const a=hs(),o=localStorage.getItem("accessToken"),l="true"===localStorage.getItem("profileComplete");if(e.meta.requiresAuth){if(!o)return void s("/landing");const e=await a.initialize();if(!e)return void s("/landing")}l&&"/authentication"===e.path?s("/dashboard"):!o||l||["/landing","/authentication"].includes(e.path)?s():s("/authentication")}));var fy=gy},7798:function(e,t,s){"use strict";s.d(t,{A:function(){return j}});var a=s(6768),o=s(4232),l=s(5130);const i={key:0,class:"modal"},r={class:"modal-content"},n={key:0},c={class:"user-type-selection"},d={class:"email-input-group"},u={class:"email-domain-select"},p={key:0,class:"domain-list"},h=["onClick"],m={class:"custom-checkbox"},v={key:0,class:"error-message"},k={key:1},g={class:"email-input-group"},f={class:"email-domain-select"},y={key:0,class:"domain-list"},L=["onClick"],b={key:0,class:"error-message"};function C(e,t,s,C,_,w){return s.isVisible?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",r,[(0,a.Lk)("span",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>w.closeModal&&w.closeModal(...e))},"×"),"register"===s.type?((0,a.uX)(),(0,a.CE)("div",n,[t[18]||(t[18]=(0,a.Lk)("h2",{class:"modal-title"},"Зарегистрироваться",-1)),(0,a.Lk)("div",c,[(0,a.Lk)("label",{class:(0,o.C4)(["user-type-label",{active:"physical"===_.registerFormData.userType}])},[(0,a.bo)((0,a.Lk)("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=e=>_.registerFormData.userType=e),value:"physical",required:""},null,512),[[l.XL,_.registerFormData.userType]]),t[13]||(t[13]=(0,a.Lk)("span",{class:"radio-text"},"Физическое лицо",-1))],2),(0,a.Lk)("label",{class:(0,o.C4)(["user-type-label",{active:"legal"===_.registerFormData.userType}])},[(0,a.bo)((0,a.Lk)("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=e=>_.registerFormData.userType=e),value:"legal",required:""},null,512),[[l.XL,_.registerFormData.userType]]),t[14]||(t[14]=(0,a.Lk)("span",{class:"radio-text"},"Юридическое лицо",-1))],2)]),(0,a.Lk)("form",{onSubmit:t[8]||(t[8]=(0,l.D$)(((...e)=>w.submitRegisterForm&&w.submitRegisterForm(...e)),["prevent"])),class:"register-form"},[(0,a.Lk)("div",d,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Введите email","onUpdate:modelValue":t[3]||(t[3]=e=>_.registerFormData.emailPrefix=e),required:"",class:"email-prefix"},null,512),[[l.Jo,_.registerFormData.emailPrefix]]),(0,a.Lk)("div",u,[(0,a.Lk)("div",{class:"selected-domain",onClick:t[4]||(t[4]=(...e)=>w.toggleDomainList&&w.toggleDomainList(...e))},[(0,a.eW)((0,o.v_)(_.registerFormData.selectedDomain)+" ",1),t[15]||(t[15]=(0,a.Lk)("span",{class:"arrow-down"},"▼",-1))]),_.showDomainList?((0,a.uX)(),(0,a.CE)("div",p,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_.emailDomains,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e,class:"domain-option",onClick:t=>w.selectDomain(e)},(0,o.v_)(e),9,h)))),128))])):(0,a.Q3)("",!0)])]),(0,a.bo)((0,a.Lk)("input",{type:"password",placeholder:"Пароль","onUpdate:modelValue":t[5]||(t[5]=e=>_.registerFormData.password=e),required:"",class:"form-input"},null,512),[[l.Jo,_.registerFormData.password]]),(0,a.bo)((0,a.Lk)("input",{type:"password",placeholder:"Подтверждение пароля","onUpdate:modelValue":t[6]||(t[6]=e=>_.registerFormData.password_confirmation=e),required:"",class:"form-input"},null,512),[[l.Jo,_.registerFormData.password_confirmation]]),(0,a.Lk)("div",m,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>_.registerFormData.agree=e),required:""},null,512),[[l.lH,_.registerFormData.agree]]),t[16]||(t[16]=(0,a.Lk)("span",{class:"checkbox-text"},[(0,a.eW)(" Я соглашаюсь на "),(0,a.Lk)("a",{href:"#",class:"terms-link"},"обработку персональных данных"),(0,a.eW)(" и присоединяюсь к регламенту ")],-1))]),_.errors.length?((0,a.uX)(),(0,a.CE)("div",v,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_.errors,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e},(0,o.v_)(e),1)))),128))])])):(0,a.Q3)("",!0),t[17]||(t[17]=(0,a.Lk)("button",{type:"submit",class:"submit-btn"},"Зарегистрироваться",-1))],32)])):(0,a.Q3)("",!0),"login"===s.type?((0,a.uX)(),(0,a.CE)("div",k,[t[21]||(t[21]=(0,a.Lk)("h2",{class:"modal-title"},"Войти",-1)),(0,a.Lk)("form",{onSubmit:t[12]||(t[12]=(0,l.D$)(((...e)=>w.submitLoginForm&&w.submitLoginForm(...e)),["prevent"])),class:"login-form"},[(0,a.Lk)("div",g,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Введите email","onUpdate:modelValue":t[9]||(t[9]=e=>_.loginFormData.emailPrefix=e),required:"",class:"email-prefix"},null,512),[[l.Jo,_.loginFormData.emailPrefix]]),(0,a.Lk)("div",f,[(0,a.Lk)("div",{class:"selected-domain",onClick:t[10]||(t[10]=(...e)=>w.toggleLoginDomainList&&w.toggleLoginDomainList(...e))},[(0,a.eW)((0,o.v_)(_.loginFormData.selectedDomain)+" ",1),t[19]||(t[19]=(0,a.Lk)("span",{class:"arrow-down"},"▼",-1))]),_.showLoginDomainList?((0,a.uX)(),(0,a.CE)("div",y,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_.emailDomains,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e,class:"domain-option",onClick:t=>w.selectLoginDomain(e)},(0,o.v_)(e),9,L)))),128))])):(0,a.Q3)("",!0)])]),(0,a.bo)((0,a.Lk)("input",{type:"password",placeholder:"Пароль","onUpdate:modelValue":t[11]||(t[11]=e=>_.loginFormData.password=e),required:"",class:"form-input"},null,512),[[l.Jo,_.loginFormData.password]]),_.errors.length?((0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_.errors,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e},(0,o.v_)(e),1)))),128))])])):(0,a.Q3)("",!0),t[20]||(t[20]=(0,a.Lk)("button",{type:"submit",class:"submit-btn"},"Войти",-1))],32)])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)}s(4114),s(8992),s(3949);var _=s(4373),w={props:{isVisible:{type:Boolean,default:!1},type:{type:String,default:"login"}},data(){return{registerFormData:{emailPrefix:"",selectedDomain:"@gmail.com",password:"",password_confirmation:"",agree:!1,userType:"physical"},showDomainList:!1,showLoginDomainList:!1,emailDomains:["@gmail.com","@mail.ru","@yandex.ru","@outlook.com","@yahoo.com","@icloud.com"],loginFormData:{emailPrefix:"",selectedDomain:"@gmail.com",password:""},errors:[]}},computed:{email(){return this.registerFormData.emailPrefix+this.registerFormData.selectedDomain}},methods:{closeModal(){this.$emit("close")},toggleDomainList(){this.showDomainList=!this.showDomainList},selectDomain(e){this.registerFormData.selectedDomain=e,this.showDomainList=!1},toggleLoginDomainList(){this.showLoginDomainList=!this.showLoginDomainList},selectLoginDomain(e){this.loginFormData.selectedDomain=e,this.showLoginDomainList=!1},async submitRegisterForm(){this.errors=[];const e=this.registerFormData.emailPrefix+this.registerFormData.selectedDomain;if(this.registerFormData.emailPrefix)if(this.registerFormData.password===this.registerFormData.password_confirmation)if(this.registerFormData.agree)try{const t=await _.A.post("api/accounts/register/",{email:e,password:this.registerFormData.password,password_confirmation:this.registerFormData.password_confirmation,agree:this.registerFormData.agree,profile_type:this.registerFormData.userType});console.log("Регистрация успешна:",t.data);const s=await _.A.post("api/accounts/login/",{email:e,password:this.registerFormData.password});console.log("Вход после регистрации:",s.data);const{access:a,refresh:o,profile_type:l}=s.data;a&&o&&(localStorage.setItem("accessToken",a),localStorage.setItem("refreshToken",o),localStorage.setItem("profileType",l),localStorage.setItem("profileComplete","false"),this.$router.push("/authentication"),this.closeModal(),this.resetRegisterForm())}catch(t){console.error("Ошибка при регистрации:",t),t.response?.data?(t.response.data.email&&this.errors.push("Этот email уже зарегистрирован"),t.response.data.password&&(Array.isArray(t.response.data.password)?t.response.data.password.forEach((e=>{this.errors.push(e)})):this.errors.push(t.response.data.password)),t.response.data.detail&&this.errors.push(t.response.data.detail)):this.errors.push("Произошла ошибка при регистрации")}else this.errors.push("Пожалуйста, примите условия соглашения.");else this.errors.push("Пароли не совпадают.");else this.errors.push("Введите email.")},async submitLoginForm(){this.errors=[];const e=this.loginFormData.emailPrefix+this.loginFormData.selectedDomain;if(this.loginFormData.emailPrefix)try{console.log("Отправка запроса на вход:",{email:e,password:this.loginFormData.password});const t=await _.A.post("api/accounts/login/",{email:e,password:this.loginFormData.password});console.log("Ответ от сервера:",t.data);const{access:s,refresh:a,profile_type:o,profile_complete:l}=t.data;s&&a&&(localStorage.setItem("accessToken",s),localStorage.setItem("refreshToken",a),localStorage.setItem("profileType",o),localStorage.setItem("profileComplete",l),!0===l?this.$router.push("/dashboard"):this.$router.push("/authentication"),this.closeModal(),this.resetLoginForm())}catch(t){console.error("Подробности ошибки:",{error:t,response:t.response,data:t.response?.data,status:t.response?.status,message:t.message}),t.response?401===t.response.status&&this.errors.push("Этот аккаунт не авторизован"):t.request?this.errors.push("Сервер недоступен. Попробуйте позже."):this.errors.push(`Ошибка: ${t.message}`)}else this.errors.push("Введите email.")},async refreshAccessToken(){try{const e=localStorage.getItem("refreshToken"),t=await _.A.post("api/token/refresh/",{refresh:e}),s=t.data.access;if(s)return localStorage.setItem("accessToken",s),console.log("Токен доступа успешно обновлён."),s;this.logout()}catch(e){console.error("Ошибка при обновлении токена доступа:",e),this.logout()}},logout(){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("firstTimeSetup"),this.$router.push("/")},resetRegisterForm(){this.registerFormData={emailPrefix:"",selectedDomain:"@gmail.com",password:"",password_confirmation:"",agree:!1,userType:"physical"}},resetLoginForm(){this.loginFormData={emailPrefix:"",selectedDomain:"@gmail.com",password:""},this.errors=[]}},created(){_.A.interceptors.request.use((e=>{const t=localStorage.getItem("accessToken");return!t||e.url.includes("/login")||e.url.includes("/register")||(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e))),_.A.interceptors.response.use((e=>e),(async e=>{const t=e.config;if(e.response&&401===e.response.status&&!t._retry){t._retry=!0;const e=await this.refreshAccessToken();if(e)return t.headers.Authorization=`Bearer ${e}`,(0,_.A)(t)}return Promise.reject(e)}))}},E=s(1241);const D=(0,E.A)(w,[["render",C],["__scopeId","data-v-6da15cf2"]]);var j=D},4233:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var a=s(6768),o=s(4232);const l={class:"header"},i={class:"container"},r={class:"auth-buttons"},n={class:"features"},c={class:"card-container"},d=["src"],u={class:"approach-features"},p={class:"approach-grid"},h={class:"approach-icon"},m=["src"],v={class:"approach-content"};function k(e,t,s,k,g,f){const y=(0,a.g2)("CustomModal");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("header",l,[(0,a.Lk)("div",i,[t[4]||(t[4]=(0,a.Lk)("h1",null,"Project Manager",-1)),(0,a.Lk)("div",r,[(0,a.Lk)("button",{class:"login-btn",onClick:t[0]||(t[0]=e=>f.toggleModal("login"))},"Войти"),(0,a.Lk)("button",{class:"register-btn",onClick:t[1]||(t[1]=e=>f.toggleModal("register"))}," Зарегистрироваться ")])])]),(0,a.bF)(y,{isVisible:g.showRegisterModal,onClose:t[2]||(t[2]=e=>g.showRegisterModal=!1),type:"register"},null,8,["isVisible"]),(0,a.bF)(y,{isVisible:g.showLoginModal,onClose:t[3]||(t[3]=e=>g.showLoginModal=!1),type:"login"},null,8,["isVisible"]),(0,a.Lk)("main",null,[t[7]||(t[7]=(0,a.Lk)("section",{class:"hero"},[(0,a.Lk)("div",{class:"hero-content"},[(0,a.Lk)("h1",null,"Проектируйте. Совещайтесь. Планируйте"),(0,a.Lk)("p",null,[(0,a.Lk)("strong",null,"ProjectManager"),(0,a.eW)(" поможет Вам в этом")]),(0,a.Lk)("button",{class:"start-btn"},"Начать бесплатно")])],-1)),(0,a.Lk)("section",n,[t[5]||(t[5]=(0,a.Lk)("h2",null,"Наши возможности",-1)),(0,a.Lk)("div",c,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(g.features,(e=>((0,a.uX)(),(0,a.CE)("div",{class:"card",key:e.title},[(0,a.Lk)("img",{src:e.icon,alt:"Feature icon"},null,8,d),(0,a.Lk)("h3",null,(0,o.v_)(e.title),1),(0,a.Lk)("p",null,(0,o.v_)(e.description),1)])))),128))])]),(0,a.Lk)("section",u,[t[6]||(t[6]=(0,a.Lk)("h2",null,"Наш подход включает",-1)),(0,a.Lk)("div",p,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(g.approachFeatures,(e=>((0,a.uX)(),(0,a.CE)("div",{class:"approach-item",key:e.title},[(0,a.Lk)("div",h,[(0,a.Lk)("img",{src:e.icon,alt:"Feature icon"},null,8,m)]),(0,a.Lk)("div",v,[(0,a.Lk)("h3",null,(0,o.v_)(e.title),1),(0,a.Lk)("p",null,(0,o.v_)(e.description),1)])])))),128))])]),t[8]||(t[8]=(0,a.Fv)('<section class="partners" data-v-2092fbeb><div class="partners-container" data-v-2092fbeb><h2 data-v-2092fbeb>Наши партнёры</h2><p class="partners-subtitle" data-v-2092fbeb>Место для будущих партнёров</p><div class="partner-grid" data-v-2092fbeb><div class="partner-placeholder" data-v-2092fbeb><div class="placeholder-content" data-v-2092fbeb><div class="placeholder-logo" data-v-2092fbeb></div><div class="placeholder-text" data-v-2092fbeb><div class="line" data-v-2092fbeb></div><div class="line short" data-v-2092fbeb></div></div></div></div><div class="partner-placeholder" data-v-2092fbeb><div class="placeholder-content" data-v-2092fbeb><div class="placeholder-logo" data-v-2092fbeb></div><div class="placeholder-text" data-v-2092fbeb><div class="line" data-v-2092fbeb></div><div class="line short" data-v-2092fbeb></div></div></div></div><div class="partner-placeholder" data-v-2092fbeb><div class="placeholder-content" data-v-2092fbeb><div class="placeholder-logo" data-v-2092fbeb></div><div class="placeholder-text" data-v-2092fbeb><div class="line" data-v-2092fbeb></div><div class="line short" data-v-2092fbeb></div></div></div></div><div class="partner-placeholder" data-v-2092fbeb><div class="placeholder-content" data-v-2092fbeb><div class="placeholder-logo" data-v-2092fbeb></div><div class="placeholder-text" data-v-2092fbeb><div class="line" data-v-2092fbeb></div><div class="line short" data-v-2092fbeb></div></div></div></div></div><div class="partners-cta" data-v-2092fbeb><p data-v-2092fbeb>Хотите стать нашим партнёром?</p><button class="contact-btn" data-v-2092fbeb>Свяжитесь с нами</button></div></div></section>',1))]),t[9]||(t[9]=(0,a.Fv)('<footer class="footer" data-v-2092fbeb><div class="container" data-v-2092fbeb><div class="footer-left" data-v-2092fbeb><h1 data-v-2092fbeb>PM</h1><p data-v-2092fbeb>Copyright © 2024 Project Manager. Все права защищены.</p></div><div class="footer-right" data-v-2092fbeb><div class="footer-section" data-v-2092fbeb><h4 data-v-2092fbeb>Продукт</h4><a href="#" data-v-2092fbeb>Документы</a><a href="#" data-v-2092fbeb>Релизы</a></div><div class="footer-section" data-v-2092fbeb><h4 data-v-2092fbeb>Ресурсы</h4><a href="#" data-v-2092fbeb>Поддержка</a><a href="#" data-v-2092fbeb>Новости</a></div><div class="footer-section" data-v-2092fbeb><h4 data-v-2092fbeb>Компания</h4><a href="#" data-v-2092fbeb>О нас</a><a href="#" data-v-2092fbeb>Контакты</a></div><div class="footer-section" data-v-2092fbeb><h4 data-v-2092fbeb>Документы</h4><a href="#" data-v-2092fbeb>Конфиденциальность</a><a href="#" data-v-2092fbeb>Гражданские данные</a></div></div></div></footer>',1))])}var g=s(7798),f={components:{CustomModal:g.A},data(){return{activePage:"main",showRegisterModal:!1,showLoginModal:!1,features:[{title:"Проекты",description:"Контролируйте процесс разработки проекта",icon:s(3967)},{title:"Чаты",description:"Коммуникация в реальном времени",icon:s(3967)},{title:"Аукцион",description:"Ищите заказы на проекты и заранее назначьте условия",icon:s(3967)},{title:"Новости",description:"Будьте в курсе актуальных событий в строительном рынке",icon:s(3967)},{title:"Нормативы",description:"Получите доступ ко всем нормативным документам",icon:s(3967)},{title:"Прочее",description:"И многое другое",icon:s(3967)}],approachFeatures:[{title:"Удобство",description:"Наш продукт ориентирован на комфортное использование",icon:s(9737)},{title:"Качество",description:"Мы используем только проверенные технологии",icon:s(4940)},{title:"Доступность",description:"Использование продукта лишь требует минимальных требований",icon:s(9201)},{title:"Конфиденциальность",description:"Ваша личная информация будет в безопасности",icon:s(4218)},{title:"Стабильность",description:"Актуальность приложения не будет забыта",icon:s(7075)},{title:"Простота",description:"Здесь все интуитивно понятно даже младенцу",icon:s(5345)}]}},methods:{setActive(e){this.activePage=e},toggleModal(e){"login"===e?this.showLoginModal=!this.showLoginModal:"register"===e&&(this.showRegisterModal=!this.showRegisterModal)}}},y=s(1241);const L=(0,y.A)(f,[["render",k],["__scopeId","data-v-2092fbeb"]]);var b=L},8988:function(e,t,s){"use strict";e.exports=s.p+"img/arrowdown.d39a2104.svg"},6519:function(e,t,s){"use strict";e.exports=s.p+"img/arrowup.9bf645a3.svg"},1131:function(e,t,s){"use strict";e.exports=s.p+"img/close.dbbc632d.svg"},9201:function(e,t,s){"use strict";e.exports=s.p+"img/devices.9fc28a2a.svg"},5345:function(e,t,s){"use strict";e.exports=s.p+"img/lightbulb.d3544baf.svg"},4218:function(e,t,s){"use strict";e.exports=s.p+"img/security.a5b5fc01.svg"},9737:function(e,t,s){"use strict";e.exports=s.p+"img/touch_app.efc18e73.svg"},7075:function(e,t,s){"use strict";e.exports=s.p+"img/update.31ae1beb.svg"},4940:function(e,t,s){"use strict";e.exports=s.p+"img/verified.cb71284f.svg"},5537:function(e,t,s){"use strict";e.exports=s.p+"img/search.8cc74325.svg"},3863:function(e,t,s){"use strict";e.exports=s.p+"img/send.47182912.svg"},5325:function(e,t,s){"use strict";e.exports=s.p+"img/voice.03eb8b55.svg"},4211:function(e,t,s){"use strict";e.exports=s.p+"img/avatar.432f9719.png"},9771:function(e,t,s){"use strict";e.exports=s.p+"img/dzen.ddc7c506.png"},3967:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAYAAACMRWrdAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAI1SURBVHgB7ZrbUfMwEIWP/DP/K+kAMRMub6QDRAeUEDqgA0qgBKCDUEGUCghvXIelgzzDxGal2MYheUBDYnsz+mY8sSV54pO1V8fKKixBHxqDDEe8ddBmFCZIMaJnO17sqpALuuDNQBaED5wQWSoaSmF6z/T56AqSmaJPr/bG7XphHCnNIX2rDJlw1AbcS2g3Pd5O51pSjtyLtVv5wbDStRDWNpMHxV2/9g2KHyXAKr4Fe3xwV478wK4UUQW5OKdhluw4agkSHFfGDKSJctCDv+ZB2aBwlPxI6WPIhco9hU6CDSUKk8ZW4PiZOylSa30QJwgbckKQMC9qfs6rDd01fuL97fiwWzHDNpriX9h3B0WMHu0tT+hnvHuMehnTk70NOSH4GeNXhGv+uEbLieleGlGYNKIwaURh0ojuviBfpttBvRBbqpuQE8Lc/b5xS12NrD2yu39fn7tPeb2xKdbq7vkX8+6+iVvxsR5333piupdGFCaNKEwaUZg0orsv0Afm3JdK/B0b6thDCHf3GS6xGvrsO++X1Wisgmbd/ef63hbC3X33xCDJNP5KqohoSFgT4e7+ZTjijxFaTkz30thgYaqSmbLa/1teJb1yL8MkwRT3lc5TrY2GMHzJ0Xyx2CjxS1oZrD9U6OA/hpLEVYrECshN+rOyvq7huWmhGsDVJrW9BEljFqnvsqm8yG1jCzHLrOiX1RLsAq0vvlzEPUqpMoUoh1o2ztcwunI/CcXOUzXO3dAcX13Ayj0g7gRBAAAAAElFTkSuQmCC"}},t={};function s(a){var o=t[a];if(void 0!==o)return o.exports;var l=t[a]={exports:{}};return e[a].call(l.exports,l,l.exports,s),l.exports}s.m=e,function(){var e=[];s.O=function(t,a,o,l){if(!a){var i=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],l=e[d][2];for(var r=!0,n=0;n<a.length;n++)(!1&l||i>=l)&&Object.keys(s.O).every((function(e){return s.O[e](a[n])}))?a.splice(n--,1):(r=!1,l<i&&(i=l));if(r){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[a,o,l]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce((function(t,a){return s.f[a](e,t),t}),[]))}}(),function(){s.u=function(e){return"js/"+e+"."+{226:"741afeeb",371:"038c5e09"}[e]+".js"}}(),function(){s.miniCssF=function(e){return"css/"+e+".491e5c9e.css"}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="web_pm:";s.l=function(a,o,l,i){if(e[a])e[a].push(o);else{var r,n;if(void 0!==l)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+l){r=u;break}}r||(n=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,s.nc&&r.setAttribute("nonce",s.nc),r.setAttribute("data-webpack",t+l),r.src=a),e[a]=[o];var p=function(t,s){r.onerror=r.onload=null,clearTimeout(h);var o=e[a];if(delete e[a],r.parentNode&&r.parentNode.removeChild(r),o&&o.forEach((function(e){return e(s)})),t)return t(s)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=p.bind(null,r.onerror),r.onload=p.bind(null,r.onload),n&&document.head.appendChild(r)}}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,a,o,l){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",s.nc&&(i.nonce=s.nc);var r=function(s){if(i.onerror=i.onload=null,"load"===s.type)o();else{var a=s&&s.type,r=s&&s.target&&s.target.href||t,n=new Error("Loading CSS chunk "+e+" failed.\n("+a+": "+r+")");n.name="ChunkLoadError",n.code="CSS_CHUNK_LOAD_FAILED",n.type=a,n.request=r,i.parentNode&&i.parentNode.removeChild(i),l(n)}};return i.onerror=i.onload=r,i.href=t,a?a.parentNode.insertBefore(i,a.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var s=document.getElementsByTagName("link"),a=0;a<s.length;a++){var o=s[a],l=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(l===e||l===t))return o}var i=document.getElementsByTagName("style");for(a=0;a<i.length;a++){o=i[a],l=o.getAttribute("data-href");if(l===e||l===t)return o}},a=function(a){return new Promise((function(o,l){var i=s.miniCssF(a),r=s.p+i;if(t(i,r))return o();e(a,r,null,o,l)}))},o={524:0};s.f.miniCss=function(e,t){var s={371:1};o[e]?t.push(o[e]):0!==o[e]&&s[e]&&t.push(o[e]=a(e).then((function(){o[e]=0}),(function(t){throw delete o[e],t})))}}}(),function(){var e={524:0};s.f.j=function(t,a){var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)a.push(o[2]);else{var l=new Promise((function(s,a){o=e[t]=[s,a]}));a.push(o[2]=l);var i=s.p+s.u(t),r=new Error,n=function(a){if(s.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var l=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;r.message="Loading chunk "+t+" failed.\n("+l+": "+i+")",r.name="ChunkLoadError",r.type=l,r.request=i,o[1](r)}};s.l(i,n,"chunk-"+t,t)}},s.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,l,i=a[0],r=a[1],n=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(n)var d=n(s)}for(t&&t(a);c<i.length;c++)l=i[c],s.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return s.O(d)},a=self["webpackChunkweb_pm"]=self["webpackChunkweb_pm"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(16)}));a=s.O(a)})();
//# sourceMappingURL=app.04a009fc.js.map